2024-08-20 09:48:26.311695 - rocketbot - INFO - request: P-SourcingPlan : line 1 - rpascripts : module  id: 8dfbcfd9-495e-7c66-5d18-49f451346c0d -  - {"module_name":"System++","module":"cleanVars","vars":"inidecript,client,secret,tenant,ruta_log,notificados,inicript,fecha_crea_log,fecha_log"}
2024-08-20 09:48:26.690555 - rocketbot - INFO - request: P-SourcingPlan : line 2 - rpascripts : module  id: 57fcc22c-a6ea-ee6a-c04b-182e13ed9f2d -  - {"module_name":"Encriptador","module":"desencriptarArchivo","content":"C:/SourcingPlan/Recursos/sourcingplank.key","fileEnc":"C:/SourcingPlan/config.ini","file":"C:/SourcingPlan","res":"inidecript","filename":"config"}
2024-08-20 09:48:26.953491 - rocketbot - INFO - request: P-SourcingPlan : line 3 - rpalogic : evaluateIf  id: 44fc765c-5af8-3e46-9865-aec95decd501 -  - {inidecript} == True
2024-08-20 09:48:27.020476 - rocketbot - INFO - request: P-SourcingPlan : line 3.1 - rpascripts : module  id: c204139c-03c9-52fa-a42f-8ba55961a0fb -  - {"module_name":"ControlIni","module":"leerIni","content":"C:/SourcingPlan/config.ini"}
2024-08-20 09:48:27.268800 - rocketbot - INFO - request: P-SourcingPlan : line 3.2 - rpascripts : module  id: 73ba0511-70e1-831a-2775-7056d7c5ec48 -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"COMUN","iddato":"ruta_log","idvar":"ruta_log"}
2024-08-20 09:48:27.364129 - rocketbot - INFO - request: P-SourcingPlan : line 3.3 - rpascripts : module  id: 48ef4e78-92cf-b54f-cf41-b4487f82fcbd -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"COMUN","iddato":"api_key","idvar":"api_key"}
2024-08-20 09:48:27.582203 - rocketbot - INFO - request: P-SourcingPlan : line 3.4 - rpascripts : module  id: 34e4b918-d345-bd79-1be5-ae9c34ce2072 -  - {"module_name":"Encriptador","module":"encriptarArchivo","content":"C:/SourcingPlan/Recursos/sourcingplank.key","file":"C:/SourcingPlan/config.ini","res":"inicript"}
2024-08-20 09:48:27.707257 - rocketbot - INFO - request: P-SourcingPlan : line 3.5 - rpalogic : evaluateIf  id: 7609d855-2c53-0c34-4821-d0b608458357 -  - {inicript} == True
2024-08-20 09:48:27.902246 - rocketbot - INFO - request: P-SourcingPlan : line 3.5.1 - rpasystem : setVar  id: 1e5b7eec-006f-d4a3-0e88-c690cf5e343d -  - datetime.now().strftime("%Y%m%d_%H%M%S")
2024-08-20 09:48:28.017188 - rocketbot - INFO - request: P-SourcingPlan : line 3.5.2 - rpasystem : setVar  id: 9fca0ae3-67c5-5452-65d7-3077b3d94db5 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-20 09:48:28.220221 - rocketbot - INFO - request: P-SourcingPlan : line 3.5.3 - rpafile : savedatafile  id: bfdfc534-78d2-a512-7cf1-a3473d3995bf -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":"","file_data":"{fecha_log} | Inicio del proceso principal de obtención de datos para Sourcing Plan"}
2024-08-20 09:48:28.329513 - rocketbot - INFO - request: P-SourcingPlan : line 3.5.4 - rpasystem : wait  id: 5b2945b4-3d86-3a24-aa19-8072bafcd3d4 -  - 6
2024-08-20 09:48:34.329884 - rocketbot - INFO - request: scripts : execRocketBotDB : line 3.5.5 - - N-InicioEllipse
2024-08-20 09:48:34.329884 - rocketbot - INFO - request: N-InicioEllipse : line 1 - rpascripts : module  id: 8dfbcfd9-495e-7c66-5d18-49f451346c0d -  - {"module_name":"System++","module":"cleanVars","vars":"inidecript_ellipse,url_ellipse,user_ellipse,descarga_ellipse,historico_ellipse,procesado_ellipse,api_ellipse,inicript_ellipse,sesion_ini"}
2024-08-20 09:48:34.345590 - rocketbot - INFO - request: N-InicioEllipse : line 2 - rpascripts : module  id: 57fcc22c-a6ea-ee6a-c04b-182e13ed9f2d -  - {"module_name":"Encriptador","module":"desencriptarArchivo","content":"C:/SourcingPlan/Recursos/sourcingplank.key","fileEnc":"C:/SourcingPlan/config.ini","file":"C:/SourcingPlan","res":"inidecript_ellipse","filename":"config"}
2024-08-20 09:48:34.345590 - rocketbot - INFO - request: N-InicioEllipse : line 3 - rpalogic : evaluateIf  id: 44fc765c-5af8-3e46-9865-aec95decd501 -  - {inidecript_ellipse} == True
2024-08-20 09:48:34.345590 - rocketbot - INFO - request: N-InicioEllipse : line 3.1 - rpasystem : setVar  id: 3e6a0900-86ad-5d22-f8e2-63ad23dd24dc -  - rocketbot.log("Desencriptación del archivo de configuración correcta", "info")
2024-08-20 09:48:34.345590 - rocketbot - INFO - Desencriptación del archivo de configuración correcta
2024-08-20 09:48:34.345590 - rocketbot - INFO - request: N-InicioEllipse : line 3.2 - rpascripts : module  id: c204139c-03c9-52fa-a42f-8ba55961a0fb -  - {"module_name":"ControlIni","module":"leerIni","content":"C:/SourcingPlan/config.ini"}
2024-08-20 09:48:34.361109 - rocketbot - INFO - request: N-InicioEllipse : line 3.3 - rpascripts : module  id: 59f60bc7-0ba0-37ae-b951-a99543b61334 -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"ELLIPSE","iddato":"url_ellipse","idvar":"url_ellipse"}
2024-08-20 09:48:34.361109 - rocketbot - INFO - request: N-InicioEllipse : line 3.4 - rpascripts : module  id: e5e6c163-ccb4-d653-5c3f-d8d050360989 -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"ELLIPSE","iddato":"user_ellipse","idvar":"user_ellipse"}
2024-08-20 09:48:34.361109 - rocketbot - INFO - request: N-InicioEllipse : line 3.5 - rpascripts : module  id: 8fb09fbc-08a6-d6e4-081f-382b3c3c9103 -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"ELLIPSE","iddato":"pass_elliipse","idvar":"pass_elliipse"}
2024-08-20 09:48:34.361109 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_74 ""): KeyError: 'pass_elliipse'
2024-08-20 09:48:34.376750 - script - ERROR - EXCEPTION IN (<string> script, L_133 ""): KeyError: 'pass_elliipse'
2024-08-20 09:48:34.376750 - rocketbot - INFO - request: N-InicioEllipse : line 3.6 - rpascripts : module  id: 73ba0511-70e1-831a-2775-7056d7c5ec48 -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"ELLIPSE","iddato":"descarga_ellipse","idvar":"descarga_ellipse"}
2024-08-20 09:48:34.376750 - rocketbot - INFO - request: N-InicioEllipse : line 3.7 - rpascripts : module  id: dcd344ac-5db0-1384-1c35-a4af8ce0bf1d -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"ELLIPSE","iddato":"historico_ellipse","idvar":"historico_ellipse"}
2024-08-20 09:48:34.376750 - rocketbot - INFO - request: N-InicioEllipse : line 3.8 - rpascripts : module  id: fbc0d596-b7db-2814-1f6f-4b34e1c25b4c -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"ELLIPSE","iddato":"procesado_ellipse","idvar":"procesado_ellipse"}
2024-08-20 09:48:34.392263 - rocketbot - INFO - request: N-InicioEllipse : line 3.9 - rpascripts : module  id: 969a5f7c-eb29-92ca-122c-882f27740051 -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"ELLIPSE","iddato":"api_ellipse","idvar":"api_ellipse"}
2024-08-20 09:48:34.392263 - rocketbot - INFO - request: N-InicioEllipse : line 3.10 - rpascripts : module  id: 34e4b918-d345-bd79-1be5-ae9c34ce2072 -  - {"module_name":"Encriptador","module":"encriptarArchivo","content":"C:/SourcingPlan/Recursos/sourcingplank.key","file":"C:/SourcingPlan/config.ini","res":"inicript_ellipse"}
2024-08-20 09:48:34.392263 - rocketbot - INFO - request: N-InicioEllipse : line 3.11 - rpalogic : evaluateIf  id: 7609d855-2c53-0c34-4821-d0b608458357 -  - {inicript_ellipse} == True
2024-08-20 09:48:34.392263 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.1 - rpasystem : setVar  id: efa0a8f0-ce56-7267-dce2-86111d9cda1d -  - rocketbot.log("Encriptación del archivo de configuración correcta", "info")
2024-08-20 09:48:34.392263 - rocketbot - INFO - Encriptación del archivo de configuración correcta
2024-08-20 09:48:34.407907 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.2 - rpasystem : setVar  id: 9fca0ae3-67c5-5452-65d7-3077b3d94db5 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-20 09:48:34.407907 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.3 - rpafile : savedatafile  id: bfdfc534-78d2-a512-7cf1-a3473d3995bf -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Inicio del proceso para la obtencion de datos de la plataforma Ellipse"}
2024-08-20 09:48:34.407907 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.4 - rpascripts : module  id: 20042ce3-c08b-4fd1-ed5d-888a7765f6d8 -  - {"module_name":"webpro","module":"open_browser","url_":"{url_ellipse}","download_path":"{descarga_ellipse}"}
2024-08-20 09:48:43.430260 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.6 - rpaweb : waitforobject  id: b1b136d5-e2e9-2a04-4594-25ab9d616be7 - xpath - {"object":"//*[@id=\"loginHeader\"]/div","wait_for":"present","wait_time":"10","before":"1","after":"1"}
2024-08-20 09:48:45.470900 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.7 - rpalogic : evaluateIf  id: e20d36f7-e002-876f-810e-972760d59f3e -  - {sesion_ini} == True
2024-08-20 09:48:45.470900 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.7.1 - rpaweb : clickWeb  id: bb57b073-0c4e-2ed9-114f-1653edaf093d - xpath - //*[@id="otherTileText"]
2024-08-20 09:48:45.486413 - rpaweb - ERROR - EXCEPTION IN (<string> rpaweb, L_1058 ""): NoSuchElementException: Message: no such element: Unable to locate element: {"method":"xpath","selector":"//*[@id="otherTileText"]"}\n  (Session info: chrome=127.0.6533.120)\nStacktrace:\n	GetHandleVerifier [0x00B18923+23283]\n	(No symbol) [0x00ADE934]\n	(No symbol) [0x00A10733]\n	(No symbol) [0x00A5326F]\n	(No symbol) [0x00A534AB]\n	(No symbol) [0x00A8EE42]\n	(No symbol) [0x00A74464]\n	(No symbol) [0x00A8CB8D]\n	(No symbol) [0x00A741B6]\n	(No symbol) [0x00A48017]\n	(No symbol) [0x00A4890D]\n	GetHandleVerifier [0x00C0A5F3+1013699]\n	GetHandleVerifier [0x00C13E4C+1052700]\n	GetHandleVerifier [0x00C0D4B4+1025668]\n	GetHandleVerifier [0x00B3EA2B+179195]\n	(No symbol) [0x00AE6833]\n	(No symbol) [0x00AE3198]\n	(No symbol) [0x00AE3337]\n	(No symbol) [0x00ADB4BE]\n	BaseThreadInitThunk [0x75E2FCC9+25]\n	RtlGetAppContainerNamedObjectPath [0x772280CE+286]\n	RtlGetAppContainerNamedObjectPath [0x7722809E+238]\n
2024-08-20 09:48:45.486413 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.8 - rpaweb : waitforobject  id: 214814ba-796d-67eb-8e41-e56c481598b6 - xpath - {"object":"//*[@id=\"i0116\"]","wait_for":"present","wait_time":"40","before":"1","after":"1"}
2024-08-20 09:48:47.548586 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.9 - rpaweb : clickWeb  id: 0a757e02-85f5-14fb-72cc-d67b73b32fe5 - xpath - //*[@id="i0116"]
2024-08-20 09:48:47.634172 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.10 - rpaweb : sendKeyWeb  id: 640dba71-aa33-9fcb-474a-9d76bb59614f -  - {user_ellipse}
2024-08-20 09:48:47.773436 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.11 - rpaweb : waitforobject  id: fbe068fb-9cc6-9207-9d7d-8043c6499470 - xpath - {"object":"//*[@id=\"idSIButton9\"]","wait_for":"present","wait_time":"40","before":"1","after":"1"}
2024-08-20 09:48:49.814326 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.12 - rpaweb : clickWeb  id: b20e3cf8-c618-003d-c8d2-443425de361b - xpath - //*[@id="idSIButton9"]
2024-08-20 09:48:49.898274 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.13 - rpaweb : waitforobject  id: a240429e-e5af-20a5-1ec9-03fe86620b40 - xpath - {"object":"//*[@id=\"i0118\"]","wait_for":"present","wait_time":"20","before":"1","after":"1"}
2024-08-20 09:48:51.939315 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.14 - rpaweb : clickWeb  id: 01ec1cd7-427c-e7bf-12e2-ad04dd73a00b - xpath - //*[@id="i0118"]
2024-08-20 09:48:52.018326 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.15 - rpaweb : sendKeyWeb  id: e46583a8-ce66-4d8c-44ec-92dbdb641c54 -  - {contrasena}
2024-08-20 09:48:52.085245 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.16 - rpaweb : waitforobject  id: 20e6118a-d4f4-f3d4-58d4-4a2c9c93d402 - xpath - {"object":"//*[@id=\"idSIButton9\"]","wait_for":"present","wait_time":"40","before":"1","after":"1"}
2024-08-20 09:48:54.111173 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.17 - rpaweb : clickWeb  id: 1ca8655a-0836-a981-8467-0a6f0662030d - xpath - //*[@id="idSIButton9"]
2024-08-20 09:48:55.694573 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.18 - rpasystem : setVar  id: f494ad13-b2a5-1f7b-6e24-1f7fa684b7d8 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-20 09:48:55.699533 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.19 - rpafile : savedatafile  id: 333252b0-cf8a-daa0-aa51-fa14027ee386 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Se inicio correctamente sesión en la plataforma Ellipse"}
2024-08-20 09:48:55.703530 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.20 - rpasystem : wait  id: 64c7d7be-de50-1b83-9957-40e2578d880d -  - 6
2024-08-20 09:49:01.720671 - rocketbot - INFO - request: scripts : execRocketBotDB : line 3.11.21 - - N-DescargaEllipse
2024-08-20 09:49:01.720671 - rocketbot - INFO - request: N-DescargaEllipse : line 1 - rpascripts : module  id: 880b5342-e1a3-f401-5bf8-6cfdfbd25117 -  - {"module_name":"System++","module":"cleanVars","vars":"pagina_principal,job_submitted,cierre_sesion"}
2024-08-20 09:49:01.720671 - rocketbot - INFO - request: N-DescargaEllipse : line 2 - rpaweb : waitforobject  id: 3db21567-62c9-2f4f-c890-d1030dfce379 - xpath - {"object":"//*[@id=\"homeTabWrapper\"]/div/div/div/div/div/div/div[1]/div/div[2]/div/div/div/div/div/div[2]/div/div/div/div/div/div/div[2]/div/div/div[1]/div/div/div[2]/div/div/div[1]/div","wait_for":"present","wait_time":"40","before":"1","after":"1"}
2024-08-20 09:49:03.783251 - rocketbot - INFO - request: N-DescargaEllipse : line 3 - rpalogic : evaluateIf  id: 125025ac-77ba-84fb-b767-251d1478cd8a -  - {pagina_principal} == True
2024-08-20 09:49:03.783251 - rocketbot - INFO - request: N-DescargaEllipse : line 3.1 - rpasystem : setVar  id: 1f05941a-147b-b697-b324-25567cc9321f -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-20 09:49:03.783251 - rocketbot - INFO - request: N-DescargaEllipse : line 3.2 - rpafile : savedatafile  id: 65bc69c7-5ab6-1dea-8752-901e2f9bb768 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Se cargo correctamente la página principal de la plataforma Ellipse"}
2024-08-20 09:49:03.783251 - rocketbot - INFO - request: N-DescargaEllipse : line 3.3 - rpaweb : clickWeb  id: dd78d339-2da8-bb50-c991-5c2c74edbc3a - xpath - //*[@id="quicklaunch"]
2024-08-20 09:49:03.883518 - rocketbot - INFO - request: N-DescargaEllipse : line 3.4 - rpascripts : module  id: 5629dfa9-ee84-086b-1e57-dbf2dd5c1e0c -  - {"module_name":"webpro","module":"CleanInputs","texto":"COJ38KA","search_data":"//*[@id=\"quicklaunch\"]","tipo":"xpath"}
2024-08-20 09:49:04.020064 - rocketbot - INFO - request: N-DescargaEllipse : line 3.5 - rpaweb : clickWeb  id: 29d696e0-5780-9c56-08d7-b3f89a09165d - xpath - //*[@id="quicklaunch"]
2024-08-20 09:49:04.087819 - rocketbot - INFO - request: N-DescargaEllipse : line 3.6 - rpaweb : sendKeyWeb  id: e5b8fe59-474a-0ea5-b4e4-57a3297f8f09 - ENTER - 
2024-08-20 09:49:04.165761 - rocketbot - INFO - request: N-DescargaEllipse : line 3.7 - rpaweb : waitforobject  id: a14849de-79fb-99a2-a0b8-b2ef884e41d2 - xpath - {"object":"//*[@id=\"MEDIUM2I_10\"]/div/div[1]/div/input","wait_for":"present","wait_time":"40","before":"1","after":"1"}
2024-08-20 09:49:06.330099 - rocketbot - INFO - request: N-DescargaEllipse : line 3.8 - rpasystem : wait  id: d71e8e72-bf7e-9c45-28df-9a1878b3bdcf -  - 2
2024-08-20 09:49:08.330488 - rocketbot - INFO - request: N-DescargaEllipse : line 3.9 - rpascripts : module  id: cf310e92-35fa-e647-74c2-b2ddf78ebdf7 -  - {"module_name":"webpro","module":"CleanInputs","texto":"R","tipo":"xpath","search_data":"//*[@id=\"MEDIUM2I_10\"]/div/div[1]/div/input","sleep_":true}
2024-08-20 09:49:09.515390 - rocketbot - INFO - request: N-DescargaEllipse : line 3.10 - rpasystem : wait  id: a4098eba-acf7-06ca-4775-792a41ec0a1d -  - 1
2024-08-20 09:49:10.534075 - rocketbot - INFO - request: N-DescargaEllipse : line 3.11 - rpaweb : sendKeyWeb  id: fc976a4a-53c5-1c37-5cab-0d6c59ac3d4f - TAB - 
2024-08-20 09:49:10.678015 - rocketbot - INFO - request: N-DescargaEllipse : line 3.13 - rpascripts : module  id: e93f5fbd-5ad5-703c-b63a-f8c2b882a371 -  - {"module_name":"webpro","module":"CleanInputs","texto":"XLSX","tipo":"xpath","search_data":"//*[@id=\"PUB_TYPE2I_20\"]/div/div/div/input","sleep_":true}
2024-08-20 09:49:11.840838 - rocketbot - INFO - request: N-DescargaEllipse : line 3.14 - rpasystem : wait  id: db6fc047-6a08-4029-599c-498b8e70f3ff -  - 1
2024-08-20 09:49:12.847149 - rocketbot - INFO - request: N-DescargaEllipse : line 3.15 - rpascripts : module  id: 6da6f22a-ddb3-824d-f631-723ddf30ac0e -  - {"module_name":"webpro","module":"CleanInputs","texto":"Y","tipo":"xpath","search_data":"//*[@id=\"SUBMIT_FLG2I_16\"]/div/div[1]/div/input","sleep_":true}
2024-08-20 09:49:14.013361 - rocketbot - INFO - request: N-DescargaEllipse : line 3.16 - rpasystem : wait  id: 8db6c9ee-d715-a865-634a-8945319ba33f -  - 1
2024-08-20 09:49:15.020390 - rocketbot - INFO - request: N-DescargaEllipse : line 3.17 - rpascripts : module  id: b8534163-c492-6ff3-db44-20abe3caf7d9 -  - {"module_name":"webpro","module":"sendkeys","special":"ENTER"}
2024-08-20 09:49:15.055489 - rocketbot - INFO - request: N-DescargaEllipse : line 3.18 - rpasystem : wait  id: e3acc446-a14e-646c-f795-16b297250f51 -  - 4
2024-08-20 09:49:19.064802 - rocketbot - INFO - request: N-DescargaEllipse : line 3.19 - rpaweb : waitforobject  id: 94db4b46-dae0-1780-f1b4-3fcd762cb4f7 - xpath - {"object":"//*[@id=\"applications\"]/div[2]/div/div/div/div[2]/div/div[2]/div/div[1]/input","wait_for":"present","wait_time":"40","before":"1","after":"1"}
2024-08-20 09:49:21.097227 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20 - rpalogic : evaluateIf  id: 5a946294-18b2-a416-ef15-69f53a024964 -  - {job_submitted} == True
2024-08-20 09:49:21.097227 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.1 - rpasystem : setVar  id: cf5dd07b-6339-4732-0466-5b6c308b70ed -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-20 09:49:21.097227 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.2 - rpafile : savedatafile  id: 9cc2c7cb-7272-f565-093d-c36db850114c -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Se genero la solicitud del Maestro de Contratos de manera exitosa"}
2024-08-20 09:49:21.097227 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.3 - rpascripts : module  id: 98720551-0932-952b-d4ad-ec53c1fb58ec -  - {"module_name":"webpro","module":"CleanInputs","texto":"MSE083","tipo":"xpath","search_data":"//*[@id=\"quicklaunch\"]","sleep_":true}
2024-08-20 09:49:22.263660 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.4 - rpasystem : wait  id: 38952641-18eb-0eb7-0407-169408274cc4 -  - 1
2024-08-20 09:49:23.275835 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.5 - rpascripts : module  id: 180be5af-502a-4a38-f4c9-48e59c45d383 -  - {"module_name":"webpro","module":"sendkeys","special":"ENTER"}
2024-08-20 09:49:23.304726 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.6 - rpasystem : wait  id: 26b1b816-62f2-3f09-587d-b7df27717b54 -  - 1
2024-08-20 09:49:24.309109 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.7 - rpaweb : switchToWindow  id: 856f6c5a-a562-d096-775b-df7951ed44aa - last - 
2024-08-20 09:49:24.497931 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.8 - rpaweb : waitforobject  id: 054fa71e-8bad-bdd6-f800-3bbde2c6b47b - xpath - {"object":"//*[@id=\"progName\"]/div/div[1]/div/input","wait_for":"present","wait_time":"40","before":"1","after":"1"}
2024-08-20 09:49:26.564880 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.9 - rpasystem : setVar  id: ac2f6005-1abb-6856-46ec-4fcb670943d5 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-20 09:49:26.564880 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.10 - rpafile : savedatafile  id: 36498109-9993-b6ad-7cf5-336d6a4cc85c -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Inicio consulta solicitud del Maestro de Contratos con transacción MSE083"}
2024-08-20 09:49:26.564880 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.11 - rpascripts : module  id: 2e32023d-49b9-2c4f-3f50-028521e9ba2f -  - {"module_name":"webpro","module":"CleanInputs","texto":"COJ38K","tipo":"xpath","search_data":"//*[@id=\"progName\"]/div/div[1]/div/input","sleep_":true}
2024-08-20 09:49:27.698720 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.12 - rpasystem : wait  id: 5930597e-7f19-b4a1-fd5b-10c61c4280eb -  - 1
2024-08-20 09:49:28.707142 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.13 - rpascripts : module  id: 480bb5ec-1688-ec2e-c869-f7b1fad3a8cf -  - {"module_name":"webpro","module":"sendkeys","special":"ENTER"}
2024-08-20 09:49:28.744856 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.14 - rpasystem : setVar  id: 214ac19b-c5d5-72fd-0170-3073ddf4a72d -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-20 09:49:28.749627 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.15 - rpafile : savedatafile  id: 28322aaf-0381-133e-d515-237f187dd807 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Se realizo correctamente la consulta la con transacción MSE083"}
2024-08-20 09:49:28.754503 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.16 - rpasystem : setVar  id: 59d42f92-9361-e28b-bb4b-daa9b0622939 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-20 09:49:28.758516 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.17 - rpafile : savedatafile  id: cf2002ec-3c9f-fc72-dc08-497891176fc5 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Se realiza espera de 7 minutos para que el Maestro de Contratos esté disponible para su descarga"}
2024-08-20 09:56:28.774605 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.19 - rpascripts : module  id: 71ad385b-283e-1d52-1b3c-cf3b4520904b -  - {"module_name":"webpro","module":"CleanInputs","texto":"MSE086","tipo":"xpath","search_data":"//*[@id=\"quicklaunch\"]","sleep_":true}
2024-08-20 10:00:04.743424 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.20 - rpasystem : wait  id: 6549e48a-3e27-565f-0430-80e818f53e3d -  - 1
2024-08-20 10:00:05.749761 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.21 - rpascripts : module  id: 62b16822-22f0-9b14-02a9-11c45c59cbf4 -  - {"module_name":"webpro","module":"sendkeys","special":"ENTER"}
2024-08-20 10:00:05.874406 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.22 - rpasystem : wait  id: 071a5a38-ff94-3dea-37cd-72bfae5afee2 -  - 3
2024-08-20 10:00:08.887616 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.23 - rpaweb : switchToWindow  id: b066920c-112c-abc9-5362-bc4abbce76a5 - last - 
2024-08-20 10:00:08.903240 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.24 - rpaweb : waitforobject  id: 4e803765-0aa1-70d0-5cff-381f8a7daec0 - xpath - {"object":"//*[@id=\"reportId\"]/div/div[1]/div/input","wait_for":"present","wait_time":"40","before":"1","after":"1"}
2024-08-20 10:00:10.934517 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.25 - rpasystem : setVar  id: 2ca25a60-f8b7-4cc2-955c-4efd59c09d51 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-20 10:00:10.934517 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.26 - rpafile : savedatafile  id: 2cca3f6a-1fce-d6b3-95a1-16c836523cbe -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Inicio consulta estado para descarga del Maestro de Contratos con transacción MSE086"}
2024-08-20 10:00:10.934517 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.27 - rpascripts : module  id: a956c9c0-b4b2-1748-64b9-5fabf5aa526c -  - {"module_name":"webpro","module":"CleanInputs","texto":"COJ38K","tipo":"xpath","search_data":"//*[@id=\"reportId\"]/div/div[1]/div/input","sleep_":true}
2024-08-20 10:00:12.075697 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.28 - rpasystem : wait  id: dc05b90f-38d2-fae4-b011-84b86e706576 -  - 1
2024-08-20 10:00:13.093089 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.29 - rpascripts : module  id: 82e9d455-d496-b264-1075-370ab325e589 -  - {"module_name":"webpro","module":"sendkeys","special":"ENTER"}
2024-08-20 10:00:13.145028 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.30 - rpasystem : setVar  id: 01ef030a-ad2f-df42-87a0-66a60f5d85ed -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-20 10:00:13.150027 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.31 - rpafile : savedatafile  id: fb70cc9f-7127-535e-db85-78a55b13ad09 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Se realizo correctamenet consulta estado para descarga del Maestro de Contratos con transacción MSE086"}
2024-08-20 10:00:13.155549 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.32 - rpasystem : wait  id: 50aad0b0-683d-4a70-f94c-b7f4db5b5836 -  - 6
2024-08-20 10:00:19.169411 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.33 - rpasystem : setVar  id: af363a72-1936-b53f-f176-6071de553a44 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-20 10:00:19.169411 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.34 - rpafile : savedatafile  id: 5536546c-d3e2-185f-4fc3-a5a0ec606711 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Iniciando descarga del Maestro de Contratos"}
2024-08-20 10:00:19.169411 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.35 - rpaweb : clickWeb  id: d387c5dd-b5db-981e-147f-43a737f67266 - xpath - //*[@id="groupResults"]/div[3]/table/tbody/tr[1]/td[3]/div
2024-08-20 10:00:19.272407 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.36 - rpasystem : wait  id: bdf2c7a0-0844-d609-9621-db85e58d5d92 -  - 6
2024-08-20 10:00:25.294601 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.37 - rpasystem : setVar  id: e0b32b2e-6845-9fb3-bc42-99d8e46183c9 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-20 10:00:25.294601 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.38 - rpafile : savedatafile  id: 70986ecf-3839-fb26-1709-2ab970adb555 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Descarga realizada correctamente en la carpeta  {descarga_ellipse}"}
2024-08-20 10:00:25.294601 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.39 - rpaweb : closewindow  id: c5fae063-bc81-ae36-b193-3eb70739d0be - last - 
2024-08-20 10:00:26.387901 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.40 - rpasystem : wait  id: 9b8c0a6b-77d0-05d3-4a9b-78dc3f5bcbb2 -  - 2
2024-08-20 10:00:28.388254 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.41 - rpaweb : closewindow  id: 4f112b2c-bd8c-a039-9c78-4677cc113294 - last - 
2024-08-20 10:00:29.481839 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.42 - rpasystem : wait  id: d8597c42-1d4b-7b50-22e4-b1f08067d860 -  - 2
2024-08-20 10:00:31.497373 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.43 - rpaweb : clickWeb  id: 94b51f05-2d1c-8e35-67f3-74dd954140f4 - xpath - //*[@id="userOption"]/span
2024-08-20 10:00:31.578914 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.44 - rpasystem : wait  id: 531eda85-95bb-2ba3-11d2-168e0debc1e2 -  - 1
2024-08-20 10:00:32.591349 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.45 - rpaweb : clickWeb  id: f6caf989-344c-790f-6909-3686ab89ac4f - xpath - //*[@id="htmlui-1207052417-overlays"]/div[2]/div/div/span[2]
2024-08-20 10:00:32.679951 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.46 - rpasystem : wait  id: ff3b7143-7ab5-be68-56f6-ab3a01f01ec3 -  - 1
2024-08-20 10:00:33.688068 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.47 - rpascripts : module  id: 84f5a49f-0c64-e9ba-4837-28eede20c244 -  - {"module_name":"webpro","module":"clickPro","data":"/html/body/div[2]/div[3]/div/div/div[3]/div/div/div[1]/div/span[1]/span","data_type":"xpath"}
2024-08-20 10:00:34.036199 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.48 - rpaweb : waitforobject  id: 47fbfbb0-e00e-59ee-d320-e8406ddd7cd7 - xpath - {"object":"//*[@id=\"login_workload_logo_text\"]","wait_for":"present","wait_time":"40","before":"1","after":"1"}
2024-08-20 10:00:36.406083 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.49 - rpasystem : setVar  id: fa39ac6d-0f84-651d-9efd-9aa2a96cf57b -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-20 10:00:36.413090 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.50 - rpafile : savedatafile  id: 533693b2-f81d-d2dc-c8eb-d0a81a12e3d0 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Se cerro sesión correctamente en la plataforma Ellipse"}
2024-08-20 10:00:36.420083 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.51 - rpaweb : killdriver  id: dbcd61f0-65b1-63bc-d227-2dd756839108 -  - 
2024-08-20 10:00:39.060036 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.52 - rpasystem : setVar  id: 26232f67-c8f1-3dd5-cef9-c4f4281060c2 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-20 10:00:39.060036 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.53 - rpafile : savedatafile  id: 78f6b061-305c-82d7-f9ed-7a1a94cce4d2 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Se cerro el navegador correctamente"}
2024-08-20 10:00:39.075681 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.22 - rpasystem : setVar  id: d22521b8-90ba-dc8d-8d9c-1f69b1a562fc -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-20 10:00:39.075681 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.23 - rpafile : savedatafile  id: 067c5723-5eff-9745-f1e1-347c45189afa -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Inicio del proceso de tratamiento de la Data obtenida del Maestro de Contratos"}
2024-08-20 10:00:39.075681 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.24 - rpasystem : wait  id: 5b93fa3b-e069-3449-4946-d90485d56533 -  - 6
2024-08-20 10:00:45.091349 - rocketbot - INFO - request: scripts : execRocketBotDB : line 3.11.25 - - N-DataEllipse
2024-08-20 10:00:45.091349 - rocketbot - INFO - request: N-DataEllipse : line 1 - rpascripts : module  id: fcabc871-7f87-bd22-4c1d-35837a88eccf -  - {"module_name":"System++","module":"cleanVars","vars":"ult_descarga_ellipse,arch_histo_generado_ellipse,ultimo_archivo_historico_ellipse,arch_fil_proceso_ellipse,ultimo_archivo_procesado_ellipse,numero_filas,contenido_excel,registro,contador"}
2024-08-20 10:00:45.106988 - rocketbot - INFO - request: N-DataEllipse : line 2 - rpascripts : execscriptpython  id: 10ac3b98-605e-8c89-8e2c-fd97833693d5 -  - ########################################################################\n#  Script para obtener el ultimo archivo descargado del Maestro de     #\n#  contratos                                                           # \n########################################################################\n\nimport os\n\ncarpeta = GetVar('descarga_ellipse')\n\nlista_archivos = []\nfor archivo in os.listdir(carpeta):\n    ruta_absoluta = os.path.join(carpeta, archivo)\n    if os.path.isfile(ruta_absoluta):\n        lista_archivos.append(archivo)\n\nif not lista_archivos:\n    print("La carpeta no contiene archivos.")\nelse:\n    archivos_modificados = []\n    for archivo in lista_archivos:\n        ruta_absoluta = os.path.join(carpeta, archivo)\n        fecha_modificacion = os.path.getmtime(ruta_absoluta)\n        archivos_modificados.append((archivo, fecha_modificacion))\n\n    ultimo_archivo_modificado = max(archivos_modificados, key=lambda x: x[1])[0]\n    print("El último archivo modificado en la carpeta es:", ultimo_archivo_modificado)\n    SetVar('ult_descarga_ellipse', ultimo_archivo_modificado) 
2024-08-20 10:00:45.106988 - rocketbot - INFO - request: N-DataEllipse : line 3 - rpasystem : wait  id: 3cbec6dc-83b9-bd37-d9c4-7771397639c9 -  - 2
2024-08-20 10:00:47.122651 - rocketbot - INFO - request: N-DataEllipse : line 4 - rpasystem : setVar  id: 9cb9783f-2110-f617-6fdf-b83342281565 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-20 10:00:47.122651 - rocketbot - INFO - request: N-DataEllipse : line 5 - rpafile : savedatafile  id: ee982905-aa98-6a50-b3cb-5053fb1aace5 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Inicio del proceso de preparación de la Data obtenida del Maestro de Contratos"}
2024-08-20 10:00:47.122651 - rocketbot - INFO - request: N-DataEllipse : line 6 - rpascripts : execscriptpython  id: a193e97a-a323-09fa-4b5f-bb6cbd81c64f -  - ########################################################################\n#  Script que realiza el ordenado de la Data obtenida del Maestro de   #\n#  Contratos en una nueva hoja llamada "Data RPA" para posterior       # \n#  procesamiento con la API y guarda el archivo con fecha de ejecucion #\n#  como historico                                                      # \n########################################################################\n\nfrom openpyxl import load_workbook, Workbook\nfrom openpyxl.utils.cell import get_column_letter\nfrom openpyxl.styles import PatternFill\nfrom datetime import datetime\nimport os\n\nruta = GetVar('descarga_ellipse')\nnom_arch = GetVar('ult_descarga_ellipse')\nruta_fin = GetVar('historico_ellipse')\n\nfile_path = ruta + '/' + nom_arch\nworkbook = load_workbook(file_path)\nsheet = workbook['COJ38K']\n\nstart_column_index = 1\nstart_row_index = 4\nend_column_index = 72\nend_row_index = sheet.max_row\n\nnew_sheet = workbook.create_sheet(title='Data RPA')\n\nfor row in sheet.iter_rows(min_row=start_row_index, max_row=end_row_index, min_col=start_column_index, max_col=end_column_index):\n    for cell in row:\n        new_sheet[get_column_letter(cell.column) + str(cell.row)].value = cell.value\n\nnew_sheet.delete_rows(1, 3)\n\n#new_sheet.delete_cols(1)\n\nsheet = workbook['Data RPA']\n\ncolumnas_a_eliminar = ['F', 'G' ,'H' ,'M','T','U','V','W','AH','AI','AJ','AK','AL','AM','AN','AO','AP','AQ','AT','AU','AW','AX','AY','AZ','BA','BB','BC','BD','BE','BF','BG','BH','BI','BJ','BK','BL','BM','BN','BO','BP','BQ','BR','BS','BT','BU']\n\nfor columna in reversed(columnas_a_eliminar):\n    columna_idx = sheet[columna]\n    columna_num = columna_idx[0].column\n    sheet.delete_cols(columna_num)\n\nstart_cell = 'A1'\nend_cell = 'AB1'\n\nfill = PatternFill(start_color='5DADE2', end_color='5DADE2', fill_type='solid')\n\n\nfor row in sheet[start_cell:end_cell]:\n    for cell in row:\n        cell.fill = fill\n\nfecha_actual = datetime.now()\n\nfecha = fecha_actual.strftime('%Y-%m-%d-%H-%M')\n\nnom_sin_ext = os.path.splitext(nom_arch)[0]\n\nworkbook.save(ruta_fin + '/' + nom_sin_ext + '_' + fecha + '.xlsx')\n\narch_histo_generado_ellipse = ruta_fin + '/' + nom_sin_ext + '_' + fecha + '.xlsx'\n\nSetVar('arch_histo_generado_ellipse', arch_histo_generado_ellipse)\n
2024-08-20 10:01:22.466822 - rocketbot - INFO - request: N-DataEllipse : line 7 - rpasystem : setVar  id: 4b8d9752-6d81-3017-38d5-230861f489c5 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-20 10:01:22.466822 - rocketbot - INFO - request: N-DataEllipse : line 8 - rpafile : savedatafile  id: e0812a93-7be7-acef-3753-39c75bb8be7e -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Data preparada en: {arch_histo_generado_ellipse}"}
2024-08-20 10:01:22.466822 - rocketbot - INFO - request: N-DataEllipse : line 9 - rpasystem : wait  id: 1b0a0fff-7194-27f5-e1fc-b8feeff51c41 -  - 2
2024-08-20 10:01:24.467276 - rocketbot - INFO - request: N-DataEllipse : line 10 - rpasystem : setVar  id: 6e02ef14-417b-04a6-5ef8-f772e2ff5e25 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-20 10:01:24.467276 - rocketbot - INFO - request: N-DataEllipse : line 11 - rpafile : savedatafile  id: 4a9c5bc2-f3c6-e474-e43f-ddc5496ef5a6 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Filtrando la Data del Maestro de Contratos con las reglas especificadas"}
2024-08-20 10:01:24.467276 - rocketbot - INFO - request: N-DataEllipse : line 12 - rpascripts : execscriptpython  id: 91e58709-40b4-f235-142a-196074ffd326 -  - ########################################################################\n#  Script para obtener el ultimo archivo historico generado del        #\n#  Maestro de Contratos                                                # \n########################################################################\n\nimport os\n\ncarpeta = GetVar('historico_ellipse')\n\nlista_archivos = []\nfor archivo in os.listdir(carpeta):\n    ruta_absoluta = os.path.join(carpeta, archivo)\n    if os.path.isfile(ruta_absoluta):\n        lista_archivos.append(archivo)\n\nif not lista_archivos:\n    print("La carpeta no contiene archivos.")\nelse:\n    archivos_modificados = []\n    for archivo in lista_archivos:\n        ruta_absoluta = os.path.join(carpeta, archivo)\n        fecha_modificacion = os.path.getmtime(ruta_absoluta)\n        archivos_modificados.append((archivo, fecha_modificacion))\n\n    ultimo_archivo_historico_ellipse = max(archivos_modificados, key=lambda x: x[1])[0]\n    print("El último archivo modificado en la carpeta es:", ultimo_archivo_historico_ellipse)\n    SetVar('ultimo_archivo_historico_ellipse', ultimo_archivo_historico_ellipse) 
2024-08-20 10:01:24.467276 - rocketbot - INFO - request: N-DataEllipse : line 13 - rpasystem : wait  id: 70912fce-b882-e80e-eb4c-c872354718d0 -  - 2
2024-08-20 10:01:26.482677 - rocketbot - INFO - request: N-DataEllipse : line 15 - rpasystem : log_message  id: 3ae761a8-392c-b18e-7ae3-63b5b97e2aa0 - warn - Antes del Error
2024-08-20 10:01:26.482677 - robot_message - WARN - Antes del Error
2024-08-20 10:01:26.482677 - rocketbot - INFO - request: N-DataEllipse : line 16 - rpascripts : execscriptpython  id: 1fb8235f-110f-e263-450f-7e9029a0b775 -  - ########################################################################\n#  Script que realiza el filtrado de la informacion obtenida           #\n#  utilizando como origen el ultimo archivo procesado de la carpeta    # \n#  Historico segun los criterios establecidos y una vez filtrada la    #\n#  informacion almacena el archivo en la carpeta Procesados            # \n########################################################################\n\nimport pandas as pd\n\nfrom openpyxl import load_workbook, Workbook\nfrom openpyxl.utils.cell import get_column_letter\nfrom openpyxl.styles import PatternFill\nfrom datetime import datetime\n\nruta_origen = GetVar('historico_ellipse')\nnombre_archivo = GetVar('ultimo_archivo_historico_ellipse')\nruta_fin = GetVar('procesado_ellipse')\n\nindice_ultimo_punto = nombre_archivo.rfind(".")\n\nif indice_ultimo_punto != -1 and indice_ultimo_punto != 0:\n    nombre_base = nombre_archivo[:indice_ultimo_punto]\nelse:\n    nombre_base = nombre_archivo\n\ndf = pd.read_excel(ruta_origen + '/' + nombre_archivo, sheet_name='Data RPA', engine='openpyxl')\n\ndf = df[df['Estado Contrato'].apply(lambda x: any(palabra in x for palabra in ['CTTO EN CONFECCION', 'CTTO EN FIRMA CMDIC', 'CTTO EN FIRMA ESED', 'CTTO EN VB ING CTTO', 'CTTO FIRMADO']))]\n\ndf = df[~df['Contrato'].apply(lambda x: any(x.startswith(letra) for letra in ['CW', 'C20', 'PRC', 'PRI']))]\n\npalabra_a_excluir = 'VP Proyectos'\n\ndf['Gerencia'] = df['Gerencia'].str.replace(r'VP Proyectos\s+', 'VP Proyectos', regex=True)\n\nfilas_seleccionadas = []\n\nfor index, row in df.iterrows():\n    gerencia = row['Gerencia']\n    #if pd.isna(gerencia) and gerencia != palabra_a_excluir:\n    if gerencia != palabra_a_excluir:  \n        filas_seleccionadas.append(row)\n\ndf = pd.DataFrame(filas_seleccionadas)\n\n#fecha_actual = datetime.now()\n\n#fecha = fecha_actual.strftime('%Y-%m-%d')\n\ndf.to_excel(ruta_fin + '/' + nombre_base + '_Filtrado.xlsx', sheet_name='Data RPA', index=False)\n                   \nworkbook = load_workbook(ruta_fin + '/' + nombre_base + '_Filtrado.xlsx')\n                   \nsheet = workbook['Data RPA']\n\nstart_cell = 'A1'\nend_cell = 'AB1'\n\nfill = PatternFill(start_color='5DADE2', end_color='5DADE2', fill_type='solid')\n\nfor row in sheet[start_cell:end_cell]:\n    for cell in row:\n        cell.fill = fill\n                   \nworkbook.save(ruta_fin + '/' + nombre_base + '_Filtrado.xlsx')\n\narch_fil_proceso_ellipse = ruta_fin + '/' + nombre_base + '_Filtrado.xlsx'\n\nSetVar('arch_fil_proceso_ellipse', 	arch_fil_proceso_ellipse)\n
2024-08-20 10:01:29.295045 - rocketbot - INFO - request: N-DataEllipse : line 17 - rpasystem : log_message  id: 7e9bdeab-2398-bc63-8b91-4f28bd088ec0 - warn - Despues del Error
2024-08-20 10:01:29.295045 - robot_message - WARN - Despues del Error
2024-08-20 10:01:29.295045 - rocketbot - INFO - request: N-DataEllipse : line 19 - rpasystem : setVar  id: 6808af79-a662-7374-d0ac-6be6e224c4fa -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-20 10:01:29.295045 - rocketbot - INFO - request: N-DataEllipse : line 20 - rpafile : savedatafile  id: b376d6df-95ff-782b-454c-49db439f3c5d -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Fin proceso de filtrado del Maestro de Contratos, Data filtrada almacenada en: {arch_fil_proceso_ellipse}"}
2024-08-20 10:01:29.310668 - rocketbot - INFO - request: N-DataEllipse : line 21 - rpasystem : wait  id: 08cf1957-a730-7021-0e81-cfacaa488ff4 -  - 2
2024-08-20 10:01:31.326289 - rocketbot - INFO - request: N-DataEllipse : line 22 - rpasystem : setVar  id: 8b06105d-2a64-ed2f-1fbb-28133e8568c1 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-20 10:01:31.326289 - rocketbot - INFO - request: N-DataEllipse : line 23 - rpafile : savedatafile  id: 3ac13a91-b3cf-cbf0-c4ed-27f821ad7fbd -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Inicio del proceso de insercion de Data filtrada del Maestro de Contratos en Atomox"}
2024-08-20 10:01:31.326289 - rocketbot - INFO - request: N-DataEllipse : line 24 - rpascripts : execscriptpython  id: bb511a6a-3707-5609-bd22-e489046dbf9d -  - ########################################################################\n#  Script para obtener el ultimo archivo historico generado del        #\n#  Maestro de Contratos                                                # \n########################################################################\n\nimport os\n\ncarpeta = GetVar('procesado_ellipse')\n\nlista_archivos = []\nfor archivo in os.listdir(carpeta):\n    ruta_absoluta = os.path.join(carpeta, archivo)\n    if os.path.isfile(ruta_absoluta):\n        lista_archivos.append(archivo)\n\nif not lista_archivos:\n    print("La carpeta no contiene archivos.")\nelse:\n    archivos_modificados = []\n    for archivo in lista_archivos:\n        ruta_absoluta = os.path.join(carpeta, archivo)\n        fecha_modificacion = os.path.getmtime(ruta_absoluta)\n        archivos_modificados.append((archivo, fecha_modificacion))\n\n    ultimo_archivo_procesado_ellipse = max(archivos_modificados, key=lambda x: x[1])[0]\n    print("El último archivo modificado en la carpeta es:", ultimo_archivo_procesado_ellipse)\n    SetVar('ultimo_archivo_procesado_ellipse', ultimo_archivo_procesado_ellipse) 
2024-08-20 10:01:31.326289 - rocketbot - INFO - request: N-DataEllipse : line 25 - rpaxls : readxlsx  id: 60df8e16-88cc-a5e4-f3d3-20d1e4275686 -  - {"file_path":"{procesado_ellipse}/{ultimo_archivo_procesado_ellipse}"}
2024-08-20 10:01:31.482655 - rocketbot - INFO - request: N-DataEllipse : line 26 - rpaxls : getrows  id: 9bbd0407-cac9-0356-7101-04cbda86436a -  - numero_filas
2024-08-20 10:01:31.482655 - rocketbot - INFO - request: N-DataEllipse : line 27 - rpaxls : getcell  id: 7fb0e04e-3e11-3121-8d1f-ee76edb2ba05 -  - A2:AB{numero_filas}
2024-08-20 10:01:31.498170 - rocketbot - INFO - request: N-DataEllipse : line 28 - rpaxls : setcell  id: e579353e-d6f5-dad4-1961-7cdeeaaffcf8 -  - AC:1=Estado Registro ATOMOX
2024-08-20 10:01:31.513816 - rocketbot - INFO - request: N-DataEllipse : line 29 - rpasystem : setVar  id: f8f9efe3-830b-2ba0-323b-7627d6d2617b -  - 2
2024-08-20 10:01:31.513816 - rocketbot - INFO - request: N-DataEllipse : line 30 - rpalogic : for  id: 5720dce3-a8ff-73b1-9406-3fb4b37b5c13 -  - {"iterable":"{contenido_excel}","count":0}
2024-08-20 10:01:31.545116 - rocketbot - INFO - For count: 0
2024-08-20 10:01:31.545116 - rocketbot - INFO - request: N-DataEllipse : line 30 - rpalogic : for  id: 5720dce3-a8ff-73b1-9406-3fb4b37b5c13 -  - {"iterable":"{contenido_excel}","count":0}
2024-08-20 10:01:31.576340 - rocketbot - INFO - For count: 1
2024-08-20 10:01:31.576340 - rocketbot - INFO - request: N-DataEllipse : line 30.1 - rpascripts : module  id: 1ea0031b-e3c7-c0f7-c8a9-f9f16739d951 -  - {"module_name":"System++","module":"cleanVars","vars":"gerencia,contrato,tipo_contrato,tipo_adjudicacion,descripcion,administrador,nombre_admiistrador,id_proveedor,nombre_proveedor,moneda,rut_ing_contratos,nombre_ing,fecha_inicio,fecha_fin,monto_original,modificaciones,monto_total,pagos_real,saldo_real,monto_retenido,pagos_directos,gasto_promedio,proyeccion_gasto,faltante,meses,meses_transcurridos,estado,conexion_api_ellipse,ingresado_pro"}
2024-08-20 10:01:31.576340 - rocketbot - INFO - request: N-DataEllipse : line 30.2 - rpascripts : execscriptpython  id: 7486e36a-d129-2902-dd42-57fd2ecd3c65 -  - ########################################################################\n#  Script que realiza la asignacion de valores del registro campo por  #\n#  campo a las variables que se utilizaran en el JSON de la API para   #\n#  enviar los datos a Atomox, de cada variable quita los espacios en   #\n#  blanco al principio y al final y si encuentra caracteres especiales #\n#  los sustituye por espacios en blanco                                #\n########################################################################\n\nimport re\n\npatron = re.compile(r'[^a-zA-Z0-9\s]')\n\ngerencia = {registro}[0]\nprint(gerencia)\nif gerencia is None:\n    SetVar ('gerencia', gerencia)\nelse:\n    gerencia = gerencia.strip()\n    SetVar ('gerencia', gerencia)\n\ncontrato = {registro}[1]\nprint(contrato)\nif contrato is None:\n    SetVar ('contrato', contrato)\nelse:\n    contrato = contrato.strip()\n    SetVar ('contrato', contrato)\n\ntipo_contrato = {registro}[2]\nprint(tipo_contrato)\nif tipo_contrato is None:\n    SetVar ('tipo_contrato', tipo_contrato)\nelse:\n    tipo_contrato = tipo_contrato.strip()\n    SetVar ('tipo_contrato', tipo_contrato)\n\ntipo_adjudicacion = {registro}[3]\nprint(tipo_adjudicacion)\nif tipo_adjudicacion is None:\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\nelse:\n    tipo_adjudicacion = tipo_adjudicacion.strip()\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\n\ndescripcion = {registro}[4]\nprint(descripcion)\nif descripcion is None:\n    SetVar ('descripcion', descripcion)\nelse:\n    descripcion_limpio = patron.sub(' ', descripcion)\n    descripcion = descripcion_limpio.strip()\n    SetVar ('descripcion', descripcion)\n\nadministrador = {registro}[5]\nprint(administrador)\nif administrador is None:\n    SetVar ('administrador', administrador)\nelse:  \n    administrador = administrador.strip()\n    SetVar ('administrador', administrador)\n\nnombre_admiistrador = {registro}[6]\nprint(nombre_admiistrador)\nif nombre_admiistrador is None:\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\nelse:    \n    nombre_admiistrador_limpio = patron.sub(' ', nombre_admiistrador)\n    nombre_admiistrador = nombre_admiistrador_limpio.strip()\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\n\nid_proveedor = {registro}[7]\nprint(id_proveedor)\nSetVar ('id_proveedor', id_proveedor)\n\nnombre_proveedor = {registro}[8]\nprint(nombre_proveedor)\nif nombre_proveedor is None:\n    SetVar ('nombre_proveedor', nombre_proveedor)\nelse:    \n    nombre_proveedor_limpio = patron.sub(' ', nombre_proveedor)\n    nombre_proveedor = nombre_proveedor_limpio.strip()\n    SetVar ('nombre_proveedor', nombre_proveedor)\n\nmoneda = {registro}[9]\nprint(moneda)\nif moneda is None:\n    SetVar ('moneda', moneda)\nelse:    \n    moneda_limpio = patron.sub(' ', moneda)\n    moneda = moneda_limpio.strip()\n    SetVar ('moneda', moneda)\n\nrut_ing_contratos = {registro}[10]\nprint(rut_ing_contratos)\nif rut_ing_contratos is None:\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\nelse:\n    rut_ing_contratos = rut_ing_contratos.strip()\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\n\nnombre_ing = {registro}[11]\nprint(nombre_ing)\nif nombre_ing is None:\n    SetVar ('nombre_ing', nombre_ing)\nelse:    \n    nombre_ing_limpio = patron.sub(' ', nombre_ing)\n    nombre_ing = nombre_ing_limpio.strip()\n    SetVar ('nombre_ing', nombre_ing)\n    \ningresado_por = {registro}[12]\nprint(ingresado_por)\ningresado_por = ingresado_por.strip()\nSetVar ('ingresado_por', ingresado_por)    \n\nfecha_inicio = {registro}[13]\nprint(fecha_inicio)\nfecha_inicio = fecha_inicio.strip()\nSetVar ('fecha_inicio', fecha_inicio)\n\nfecha_fin = {registro}[14]\nprint(fecha_fin)\nfecha_fin = fecha_fin.strip()\nSetVar ('fecha_fin', fecha_fin)\n\nmonto_original = {registro}[15]\nprint(monto_original)\nSetVar ('monto_original', monto_original)\n\nmodificaciones = {registro}[16]\nprint(modificaciones)\nSetVar ('modificaciones', modificaciones)\n\nmonto_total = {registro}[17]\nprint(monto_total)\nSetVar ('monto_total', monto_total)\n\npagos_real = {registro}[18]\nprint(pagos_real)\nSetVar ('pagos_real', pagos_real)\n\nsaldo_real = {registro}[19]\nprint(saldo_real)\nSetVar ('saldo_real', saldo_real)\n\nmonto_retenido = {registro}[20]\nprint(monto_retenido)\nSetVar ('monto_retenido', monto_retenido)\n\npagos_directos = {registro}[21]\nprint(pagos_directos)\nSetVar ('pagos_directos', pagos_directos)\n\ngasto_promedio = {registro}[22]\nprint(gasto_promedio)\nSetVar ('gasto_promedio', gasto_promedio)\n\nproyeccion_gasto = {registro}[23]\nprint(proyeccion_gasto)\nSetVar ('proyeccion_gasto', proyeccion_gasto)\n\nfaltante = {registro}[24]\nprint(faltante)\nSetVar ('faltante', faltante)\n\nmeses = {registro}[25]\nprint(meses)\nSetVar ('meses', meses)\n\nmeses_transcurridos = {registro}[26]\nprint(meses_transcurridos)\nSetVar ('meses_transcurridos', meses_transcurridos)\n\nestado = {registro}[27]\nprint(estado)\nestado = estado.strip()\nSetVar ('estado', estado)
2024-08-20 10:01:31.623165 - rocketbot - INFO - request: N-DataEllipse : line 30.3 - rpaconnect : request  id: 6b0e9df4-5f6f-3645-1d62-a8b260598cfe -  - {"method":"post","url":"{api_ellipse}","json":"{\n  \"gerencia\":\"{gerencia}\",\n  \"codigoCttoAnterior\":\"{contrato}\",\n  \"tipoContrato\":\"{tipo_contrato}\",\n  \"tipoAdjudicacion\":\"{tipo_adjudicacion}\",\n  \"descripcion\":\"{descripcion}\",\n  \"rutAdministrador\":\"{administrador}\",\n  \"nombreAdministrador\":\"{nombre_admiistrador}\",\n  \"codigoProvedor\":\"{id_proveedor}\",\n  \"nombreProveddor\":\"{nombre_proveedor}\",\n  \"moneda\":\"{moneda}\",\n  \"rutIngenieroContrato\":\"{rut_ing_contratos}\",\n  \"nombreIngenieroContrato\":\"{nombre_ing}\",\n  \"fechaInicioActualizada\":\"{fecha_inicio}\",\n  \"fechaTerminoActualizada\":\"{fecha_fin}\",\n  \"monto\":\"{monto_original}\",\n  \"modificacionesMonto\":\"{modificaciones}\",\n  \"montoTotal\":\"{monto_total}\",\n  \"pagosReal\":\"{pagos_real}\",\n  \"saldoReal\":\"{saldo_real}\",\n  \"montoRetenido\":\"{monto_retenido}\",\n  \"pagosDirectos\":\"{pagos_directos}\",\n  \"gastoPromedioActualReal\":\"{gasto_promedio}\",\n  \"proyeccionGastoActual\":\"{proyeccion_gasto}\",\n  \"faltante\":\"{faltante}\",\n  \"mesesCtto\":\"{meses}\",\n  \"mesesTranscurridos\":\"{meses_transcurridos}\",\n  \"estadoContrato\":\"{estado}\"\n}","params":"","form":"","proxy":"","file":"","header":"{\"X-Api-Key\":\"{api_key}\"}"}
2024-08-20 10:01:52.654909 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_108 ""): ConnectTimeout: HTTPConnectionPool(host='54.88.59.194', port=8081): Max retries exceeded with url: /api/v1.0/sourcings (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x0000020BF30D95A0>, 'Connection to 54.88.59.194 timed out. (connect timeout=None)'))
2024-08-20 10:01:52.654909 - rocketbot - INFO - request: N-DataEllipse : line 30.4 - rpaxls : setcell  id: 556e681f-94f9-2ea4-3e17-58ad6db10c28 -  - AC:{contador}={conexion_api_ellipse}
2024-08-20 10:01:52.654909 - rocketbot - INFO - request: N-DataEllipse : line 30.5 - rpasystem : setVar  id: b7f818c2-7f7d-03b6-397f-1cdd17ba8494 -  - {contador} + 1
2024-08-20 10:01:52.654909 - rocketbot - INFO - request: N-DataEllipse : line 30 - rpalogic : for  id: 5720dce3-a8ff-73b1-9406-3fb4b37b5c13 -  - {"iterable":"{contenido_excel}","count":0}
2024-08-20 10:01:52.686062 - rocketbot - INFO - For count: 2
2024-08-20 10:01:52.686062 - rocketbot - INFO - request: N-DataEllipse : line 30.1 - rpascripts : module  id: 1ea0031b-e3c7-c0f7-c8a9-f9f16739d951 -  - {"module_name":"System++","module":"cleanVars","vars":"gerencia,contrato,tipo_contrato,tipo_adjudicacion,descripcion,administrador,nombre_admiistrador,id_proveedor,nombre_proveedor,moneda,rut_ing_contratos,nombre_ing,fecha_inicio,fecha_fin,monto_original,modificaciones,monto_total,pagos_real,saldo_real,monto_retenido,pagos_directos,gasto_promedio,proyeccion_gasto,faltante,meses,meses_transcurridos,estado,conexion_api_ellipse,ingresado_pro"}
2024-08-20 10:01:52.701769 - rocketbot - INFO - request: N-DataEllipse : line 30.2 - rpascripts : execscriptpython  id: 7486e36a-d129-2902-dd42-57fd2ecd3c65 -  - ########################################################################\n#  Script que realiza la asignacion de valores del registro campo por  #\n#  campo a las variables que se utilizaran en el JSON de la API para   #\n#  enviar los datos a Atomox, de cada variable quita los espacios en   #\n#  blanco al principio y al final y si encuentra caracteres especiales #\n#  los sustituye por espacios en blanco                                #\n########################################################################\n\nimport re\n\npatron = re.compile(r'[^a-zA-Z0-9\s]')\n\ngerencia = {registro}[0]\nprint(gerencia)\nif gerencia is None:\n    SetVar ('gerencia', gerencia)\nelse:\n    gerencia = gerencia.strip()\n    SetVar ('gerencia', gerencia)\n\ncontrato = {registro}[1]\nprint(contrato)\nif contrato is None:\n    SetVar ('contrato', contrato)\nelse:\n    contrato = contrato.strip()\n    SetVar ('contrato', contrato)\n\ntipo_contrato = {registro}[2]\nprint(tipo_contrato)\nif tipo_contrato is None:\n    SetVar ('tipo_contrato', tipo_contrato)\nelse:\n    tipo_contrato = tipo_contrato.strip()\n    SetVar ('tipo_contrato', tipo_contrato)\n\ntipo_adjudicacion = {registro}[3]\nprint(tipo_adjudicacion)\nif tipo_adjudicacion is None:\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\nelse:\n    tipo_adjudicacion = tipo_adjudicacion.strip()\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\n\ndescripcion = {registro}[4]\nprint(descripcion)\nif descripcion is None:\n    SetVar ('descripcion', descripcion)\nelse:\n    descripcion_limpio = patron.sub(' ', descripcion)\n    descripcion = descripcion_limpio.strip()\n    SetVar ('descripcion', descripcion)\n\nadministrador = {registro}[5]\nprint(administrador)\nif administrador is None:\n    SetVar ('administrador', administrador)\nelse:  \n    administrador = administrador.strip()\n    SetVar ('administrador', administrador)\n\nnombre_admiistrador = {registro}[6]\nprint(nombre_admiistrador)\nif nombre_admiistrador is None:\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\nelse:    \n    nombre_admiistrador_limpio = patron.sub(' ', nombre_admiistrador)\n    nombre_admiistrador = nombre_admiistrador_limpio.strip()\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\n\nid_proveedor = {registro}[7]\nprint(id_proveedor)\nSetVar ('id_proveedor', id_proveedor)\n\nnombre_proveedor = {registro}[8]\nprint(nombre_proveedor)\nif nombre_proveedor is None:\n    SetVar ('nombre_proveedor', nombre_proveedor)\nelse:    \n    nombre_proveedor_limpio = patron.sub(' ', nombre_proveedor)\n    nombre_proveedor = nombre_proveedor_limpio.strip()\n    SetVar ('nombre_proveedor', nombre_proveedor)\n\nmoneda = {registro}[9]\nprint(moneda)\nif moneda is None:\n    SetVar ('moneda', moneda)\nelse:    \n    moneda_limpio = patron.sub(' ', moneda)\n    moneda = moneda_limpio.strip()\n    SetVar ('moneda', moneda)\n\nrut_ing_contratos = {registro}[10]\nprint(rut_ing_contratos)\nif rut_ing_contratos is None:\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\nelse:\n    rut_ing_contratos = rut_ing_contratos.strip()\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\n\nnombre_ing = {registro}[11]\nprint(nombre_ing)\nif nombre_ing is None:\n    SetVar ('nombre_ing', nombre_ing)\nelse:    \n    nombre_ing_limpio = patron.sub(' ', nombre_ing)\n    nombre_ing = nombre_ing_limpio.strip()\n    SetVar ('nombre_ing', nombre_ing)\n    \ningresado_por = {registro}[12]\nprint(ingresado_por)\ningresado_por = ingresado_por.strip()\nSetVar ('ingresado_por', ingresado_por)    \n\nfecha_inicio = {registro}[13]\nprint(fecha_inicio)\nfecha_inicio = fecha_inicio.strip()\nSetVar ('fecha_inicio', fecha_inicio)\n\nfecha_fin = {registro}[14]\nprint(fecha_fin)\nfecha_fin = fecha_fin.strip()\nSetVar ('fecha_fin', fecha_fin)\n\nmonto_original = {registro}[15]\nprint(monto_original)\nSetVar ('monto_original', monto_original)\n\nmodificaciones = {registro}[16]\nprint(modificaciones)\nSetVar ('modificaciones', modificaciones)\n\nmonto_total = {registro}[17]\nprint(monto_total)\nSetVar ('monto_total', monto_total)\n\npagos_real = {registro}[18]\nprint(pagos_real)\nSetVar ('pagos_real', pagos_real)\n\nsaldo_real = {registro}[19]\nprint(saldo_real)\nSetVar ('saldo_real', saldo_real)\n\nmonto_retenido = {registro}[20]\nprint(monto_retenido)\nSetVar ('monto_retenido', monto_retenido)\n\npagos_directos = {registro}[21]\nprint(pagos_directos)\nSetVar ('pagos_directos', pagos_directos)\n\ngasto_promedio = {registro}[22]\nprint(gasto_promedio)\nSetVar ('gasto_promedio', gasto_promedio)\n\nproyeccion_gasto = {registro}[23]\nprint(proyeccion_gasto)\nSetVar ('proyeccion_gasto', proyeccion_gasto)\n\nfaltante = {registro}[24]\nprint(faltante)\nSetVar ('faltante', faltante)\n\nmeses = {registro}[25]\nprint(meses)\nSetVar ('meses', meses)\n\nmeses_transcurridos = {registro}[26]\nprint(meses_transcurridos)\nSetVar ('meses_transcurridos', meses_transcurridos)\n\nestado = {registro}[27]\nprint(estado)\nestado = estado.strip()\nSetVar ('estado', estado)
2024-08-20 10:01:52.732937 - rocketbot - INFO - request: N-DataEllipse : line 30.3 - rpaconnect : request  id: 6b0e9df4-5f6f-3645-1d62-a8b260598cfe -  - {"method":"post","url":"{api_ellipse}","json":"{\n  \"gerencia\":\"{gerencia}\",\n  \"codigoCttoAnterior\":\"{contrato}\",\n  \"tipoContrato\":\"{tipo_contrato}\",\n  \"tipoAdjudicacion\":\"{tipo_adjudicacion}\",\n  \"descripcion\":\"{descripcion}\",\n  \"rutAdministrador\":\"{administrador}\",\n  \"nombreAdministrador\":\"{nombre_admiistrador}\",\n  \"codigoProvedor\":\"{id_proveedor}\",\n  \"nombreProveddor\":\"{nombre_proveedor}\",\n  \"moneda\":\"{moneda}\",\n  \"rutIngenieroContrato\":\"{rut_ing_contratos}\",\n  \"nombreIngenieroContrato\":\"{nombre_ing}\",\n  \"fechaInicioActualizada\":\"{fecha_inicio}\",\n  \"fechaTerminoActualizada\":\"{fecha_fin}\",\n  \"monto\":\"{monto_original}\",\n  \"modificacionesMonto\":\"{modificaciones}\",\n  \"montoTotal\":\"{monto_total}\",\n  \"pagosReal\":\"{pagos_real}\",\n  \"saldoReal\":\"{saldo_real}\",\n  \"montoRetenido\":\"{monto_retenido}\",\n  \"pagosDirectos\":\"{pagos_directos}\",\n  \"gastoPromedioActualReal\":\"{gasto_promedio}\",\n  \"proyeccionGastoActual\":\"{proyeccion_gasto}\",\n  \"faltante\":\"{faltante}\",\n  \"mesesCtto\":\"{meses}\",\n  \"mesesTranscurridos\":\"{meses_transcurridos}\",\n  \"estadoContrato\":\"{estado}\"\n}","params":"","form":"","proxy":"","file":"","header":"{\"X-Api-Key\":\"{api_key}\"}"}
2024-08-20 10:02:13.780003 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_108 ""): ConnectTimeout: HTTPConnectionPool(host='54.88.59.194', port=8081): Max retries exceeded with url: /api/v1.0/sourcings (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x0000020BF1E89DB0>, 'Connection to 54.88.59.194 timed out. (connect timeout=None)'))
2024-08-20 10:02:13.780003 - rocketbot - INFO - request: N-DataEllipse : line 30.4 - rpaxls : setcell  id: 556e681f-94f9-2ea4-3e17-58ad6db10c28 -  - AC:{contador}={conexion_api_ellipse}
2024-08-20 10:02:13.780003 - rocketbot - INFO - request: N-DataEllipse : line 30.5 - rpasystem : setVar  id: b7f818c2-7f7d-03b6-397f-1cdd17ba8494 -  - {contador} + 1
2024-08-20 10:02:13.795570 - rocketbot - INFO - request: N-DataEllipse : line 30 - rpalogic : for  id: 5720dce3-a8ff-73b1-9406-3fb4b37b5c13 -  - {"iterable":"{contenido_excel}","count":0}
2024-08-20 10:02:13.826823 - rocketbot - INFO - For count: 3
2024-08-20 10:02:13.826823 - rocketbot - INFO - request: N-DataEllipse : line 30.1 - rpascripts : module  id: 1ea0031b-e3c7-c0f7-c8a9-f9f16739d951 -  - {"module_name":"System++","module":"cleanVars","vars":"gerencia,contrato,tipo_contrato,tipo_adjudicacion,descripcion,administrador,nombre_admiistrador,id_proveedor,nombre_proveedor,moneda,rut_ing_contratos,nombre_ing,fecha_inicio,fecha_fin,monto_original,modificaciones,monto_total,pagos_real,saldo_real,monto_retenido,pagos_directos,gasto_promedio,proyeccion_gasto,faltante,meses,meses_transcurridos,estado,conexion_api_ellipse,ingresado_pro"}
2024-08-20 10:02:13.826823 - rocketbot - INFO - request: N-DataEllipse : line 30.2 - rpascripts : execscriptpython  id: 7486e36a-d129-2902-dd42-57fd2ecd3c65 -  - ########################################################################\n#  Script que realiza la asignacion de valores del registro campo por  #\n#  campo a las variables que se utilizaran en el JSON de la API para   #\n#  enviar los datos a Atomox, de cada variable quita los espacios en   #\n#  blanco al principio y al final y si encuentra caracteres especiales #\n#  los sustituye por espacios en blanco                                #\n########################################################################\n\nimport re\n\npatron = re.compile(r'[^a-zA-Z0-9\s]')\n\ngerencia = {registro}[0]\nprint(gerencia)\nif gerencia is None:\n    SetVar ('gerencia', gerencia)\nelse:\n    gerencia = gerencia.strip()\n    SetVar ('gerencia', gerencia)\n\ncontrato = {registro}[1]\nprint(contrato)\nif contrato is None:\n    SetVar ('contrato', contrato)\nelse:\n    contrato = contrato.strip()\n    SetVar ('contrato', contrato)\n\ntipo_contrato = {registro}[2]\nprint(tipo_contrato)\nif tipo_contrato is None:\n    SetVar ('tipo_contrato', tipo_contrato)\nelse:\n    tipo_contrato = tipo_contrato.strip()\n    SetVar ('tipo_contrato', tipo_contrato)\n\ntipo_adjudicacion = {registro}[3]\nprint(tipo_adjudicacion)\nif tipo_adjudicacion is None:\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\nelse:\n    tipo_adjudicacion = tipo_adjudicacion.strip()\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\n\ndescripcion = {registro}[4]\nprint(descripcion)\nif descripcion is None:\n    SetVar ('descripcion', descripcion)\nelse:\n    descripcion_limpio = patron.sub(' ', descripcion)\n    descripcion = descripcion_limpio.strip()\n    SetVar ('descripcion', descripcion)\n\nadministrador = {registro}[5]\nprint(administrador)\nif administrador is None:\n    SetVar ('administrador', administrador)\nelse:  \n    administrador = administrador.strip()\n    SetVar ('administrador', administrador)\n\nnombre_admiistrador = {registro}[6]\nprint(nombre_admiistrador)\nif nombre_admiistrador is None:\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\nelse:    \n    nombre_admiistrador_limpio = patron.sub(' ', nombre_admiistrador)\n    nombre_admiistrador = nombre_admiistrador_limpio.strip()\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\n\nid_proveedor = {registro}[7]\nprint(id_proveedor)\nSetVar ('id_proveedor', id_proveedor)\n\nnombre_proveedor = {registro}[8]\nprint(nombre_proveedor)\nif nombre_proveedor is None:\n    SetVar ('nombre_proveedor', nombre_proveedor)\nelse:    \n    nombre_proveedor_limpio = patron.sub(' ', nombre_proveedor)\n    nombre_proveedor = nombre_proveedor_limpio.strip()\n    SetVar ('nombre_proveedor', nombre_proveedor)\n\nmoneda = {registro}[9]\nprint(moneda)\nif moneda is None:\n    SetVar ('moneda', moneda)\nelse:    \n    moneda_limpio = patron.sub(' ', moneda)\n    moneda = moneda_limpio.strip()\n    SetVar ('moneda', moneda)\n\nrut_ing_contratos = {registro}[10]\nprint(rut_ing_contratos)\nif rut_ing_contratos is None:\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\nelse:\n    rut_ing_contratos = rut_ing_contratos.strip()\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\n\nnombre_ing = {registro}[11]\nprint(nombre_ing)\nif nombre_ing is None:\n    SetVar ('nombre_ing', nombre_ing)\nelse:    \n    nombre_ing_limpio = patron.sub(' ', nombre_ing)\n    nombre_ing = nombre_ing_limpio.strip()\n    SetVar ('nombre_ing', nombre_ing)\n    \ningresado_por = {registro}[12]\nprint(ingresado_por)\ningresado_por = ingresado_por.strip()\nSetVar ('ingresado_por', ingresado_por)    \n\nfecha_inicio = {registro}[13]\nprint(fecha_inicio)\nfecha_inicio = fecha_inicio.strip()\nSetVar ('fecha_inicio', fecha_inicio)\n\nfecha_fin = {registro}[14]\nprint(fecha_fin)\nfecha_fin = fecha_fin.strip()\nSetVar ('fecha_fin', fecha_fin)\n\nmonto_original = {registro}[15]\nprint(monto_original)\nSetVar ('monto_original', monto_original)\n\nmodificaciones = {registro}[16]\nprint(modificaciones)\nSetVar ('modificaciones', modificaciones)\n\nmonto_total = {registro}[17]\nprint(monto_total)\nSetVar ('monto_total', monto_total)\n\npagos_real = {registro}[18]\nprint(pagos_real)\nSetVar ('pagos_real', pagos_real)\n\nsaldo_real = {registro}[19]\nprint(saldo_real)\nSetVar ('saldo_real', saldo_real)\n\nmonto_retenido = {registro}[20]\nprint(monto_retenido)\nSetVar ('monto_retenido', monto_retenido)\n\npagos_directos = {registro}[21]\nprint(pagos_directos)\nSetVar ('pagos_directos', pagos_directos)\n\ngasto_promedio = {registro}[22]\nprint(gasto_promedio)\nSetVar ('gasto_promedio', gasto_promedio)\n\nproyeccion_gasto = {registro}[23]\nprint(proyeccion_gasto)\nSetVar ('proyeccion_gasto', proyeccion_gasto)\n\nfaltante = {registro}[24]\nprint(faltante)\nSetVar ('faltante', faltante)\n\nmeses = {registro}[25]\nprint(meses)\nSetVar ('meses', meses)\n\nmeses_transcurridos = {registro}[26]\nprint(meses_transcurridos)\nSetVar ('meses_transcurridos', meses_transcurridos)\n\nestado = {registro}[27]\nprint(estado)\nestado = estado.strip()\nSetVar ('estado', estado)
2024-08-20 10:02:13.873692 - rocketbot - INFO - request: N-DataEllipse : line 30.3 - rpaconnect : request  id: 6b0e9df4-5f6f-3645-1d62-a8b260598cfe -  - {"method":"post","url":"{api_ellipse}","json":"{\n  \"gerencia\":\"{gerencia}\",\n  \"codigoCttoAnterior\":\"{contrato}\",\n  \"tipoContrato\":\"{tipo_contrato}\",\n  \"tipoAdjudicacion\":\"{tipo_adjudicacion}\",\n  \"descripcion\":\"{descripcion}\",\n  \"rutAdministrador\":\"{administrador}\",\n  \"nombreAdministrador\":\"{nombre_admiistrador}\",\n  \"codigoProvedor\":\"{id_proveedor}\",\n  \"nombreProveddor\":\"{nombre_proveedor}\",\n  \"moneda\":\"{moneda}\",\n  \"rutIngenieroContrato\":\"{rut_ing_contratos}\",\n  \"nombreIngenieroContrato\":\"{nombre_ing}\",\n  \"fechaInicioActualizada\":\"{fecha_inicio}\",\n  \"fechaTerminoActualizada\":\"{fecha_fin}\",\n  \"monto\":\"{monto_original}\",\n  \"modificacionesMonto\":\"{modificaciones}\",\n  \"montoTotal\":\"{monto_total}\",\n  \"pagosReal\":\"{pagos_real}\",\n  \"saldoReal\":\"{saldo_real}\",\n  \"montoRetenido\":\"{monto_retenido}\",\n  \"pagosDirectos\":\"{pagos_directos}\",\n  \"gastoPromedioActualReal\":\"{gasto_promedio}\",\n  \"proyeccionGastoActual\":\"{proyeccion_gasto}\",\n  \"faltante\":\"{faltante}\",\n  \"mesesCtto\":\"{meses}\",\n  \"mesesTranscurridos\":\"{meses_transcurridos}\",\n  \"estadoContrato\":\"{estado}\"\n}","params":"","form":"","proxy":"","file":"","header":"{\"X-Api-Key\":\"{api_key}\"}"}
2024-08-20 10:02:34.905383 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_108 ""): ConnectTimeout: HTTPConnectionPool(host='54.88.59.194', port=8081): Max retries exceeded with url: /api/v1.0/sourcings (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x0000020BF30DBD00>, 'Connection to 54.88.59.194 timed out. (connect timeout=None)'))
2024-08-20 10:03:17.515425 - rocketbot - INFO - request: N-DataEllipse : line 30.4 - rpaxls : setcell  id: 556e681f-94f9-2ea4-3e17-58ad6db10c28 -  - AC:{contador}={conexion_api_ellipse}
2024-08-20 10:03:17.515425 - rocketbot - INFO - request: N-DataEllipse : line 30.5 - rpasystem : setVar  id: b7f818c2-7f7d-03b6-397f-1cdd17ba8494 -  - {contador} + 1
2024-08-20 10:03:17.530936 - rocketbot - INFO - request: N-DataEllipse : line 30 - rpalogic : for  id: 5720dce3-a8ff-73b1-9406-3fb4b37b5c13 -  - {"iterable":"{contenido_excel}","count":0}
2024-08-20 10:03:17.546725 - rocketbot - INFO - For count: 4
2024-08-20 10:03:17.546725 - rocketbot - INFO - request: N-DataEllipse : line 30.1 - rpascripts : module  id: 1ea0031b-e3c7-c0f7-c8a9-f9f16739d951 -  - {"module_name":"System++","module":"cleanVars","vars":"gerencia,contrato,tipo_contrato,tipo_adjudicacion,descripcion,administrador,nombre_admiistrador,id_proveedor,nombre_proveedor,moneda,rut_ing_contratos,nombre_ing,fecha_inicio,fecha_fin,monto_original,modificaciones,monto_total,pagos_real,saldo_real,monto_retenido,pagos_directos,gasto_promedio,proyeccion_gasto,faltante,meses,meses_transcurridos,estado,conexion_api_ellipse,ingresado_pro"}
2024-08-20 10:03:17.562317 - rocketbot - INFO - request: N-DataEllipse : line 30.2 - rpascripts : execscriptpython  id: 7486e36a-d129-2902-dd42-57fd2ecd3c65 -  - ########################################################################\n#  Script que realiza la asignacion de valores del registro campo por  #\n#  campo a las variables que se utilizaran en el JSON de la API para   #\n#  enviar los datos a Atomox, de cada variable quita los espacios en   #\n#  blanco al principio y al final y si encuentra caracteres especiales #\n#  los sustituye por espacios en blanco                                #\n########################################################################\n\nimport re\n\npatron = re.compile(r'[^a-zA-Z0-9\s]')\n\ngerencia = {registro}[0]\nprint(gerencia)\nif gerencia is None:\n    SetVar ('gerencia', gerencia)\nelse:\n    gerencia = gerencia.strip()\n    SetVar ('gerencia', gerencia)\n\ncontrato = {registro}[1]\nprint(contrato)\nif contrato is None:\n    SetVar ('contrato', contrato)\nelse:\n    contrato = contrato.strip()\n    SetVar ('contrato', contrato)\n\ntipo_contrato = {registro}[2]\nprint(tipo_contrato)\nif tipo_contrato is None:\n    SetVar ('tipo_contrato', tipo_contrato)\nelse:\n    tipo_contrato = tipo_contrato.strip()\n    SetVar ('tipo_contrato', tipo_contrato)\n\ntipo_adjudicacion = {registro}[3]\nprint(tipo_adjudicacion)\nif tipo_adjudicacion is None:\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\nelse:\n    tipo_adjudicacion = tipo_adjudicacion.strip()\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\n\ndescripcion = {registro}[4]\nprint(descripcion)\nif descripcion is None:\n    SetVar ('descripcion', descripcion)\nelse:\n    descripcion_limpio = patron.sub(' ', descripcion)\n    descripcion = descripcion_limpio.strip()\n    SetVar ('descripcion', descripcion)\n\nadministrador = {registro}[5]\nprint(administrador)\nif administrador is None:\n    SetVar ('administrador', administrador)\nelse:  \n    administrador = administrador.strip()\n    SetVar ('administrador', administrador)\n\nnombre_admiistrador = {registro}[6]\nprint(nombre_admiistrador)\nif nombre_admiistrador is None:\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\nelse:    \n    nombre_admiistrador_limpio = patron.sub(' ', nombre_admiistrador)\n    nombre_admiistrador = nombre_admiistrador_limpio.strip()\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\n\nid_proveedor = {registro}[7]\nprint(id_proveedor)\nSetVar ('id_proveedor', id_proveedor)\n\nnombre_proveedor = {registro}[8]\nprint(nombre_proveedor)\nif nombre_proveedor is None:\n    SetVar ('nombre_proveedor', nombre_proveedor)\nelse:    \n    nombre_proveedor_limpio = patron.sub(' ', nombre_proveedor)\n    nombre_proveedor = nombre_proveedor_limpio.strip()\n    SetVar ('nombre_proveedor', nombre_proveedor)\n\nmoneda = {registro}[9]\nprint(moneda)\nif moneda is None:\n    SetVar ('moneda', moneda)\nelse:    \n    moneda_limpio = patron.sub(' ', moneda)\n    moneda = moneda_limpio.strip()\n    SetVar ('moneda', moneda)\n\nrut_ing_contratos = {registro}[10]\nprint(rut_ing_contratos)\nif rut_ing_contratos is None:\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\nelse:\n    rut_ing_contratos = rut_ing_contratos.strip()\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\n\nnombre_ing = {registro}[11]\nprint(nombre_ing)\nif nombre_ing is None:\n    SetVar ('nombre_ing', nombre_ing)\nelse:    \n    nombre_ing_limpio = patron.sub(' ', nombre_ing)\n    nombre_ing = nombre_ing_limpio.strip()\n    SetVar ('nombre_ing', nombre_ing)\n    \ningresado_por = {registro}[12]\nprint(ingresado_por)\ningresado_por = ingresado_por.strip()\nSetVar ('ingresado_por', ingresado_por)    \n\nfecha_inicio = {registro}[13]\nprint(fecha_inicio)\nfecha_inicio = fecha_inicio.strip()\nSetVar ('fecha_inicio', fecha_inicio)\n\nfecha_fin = {registro}[14]\nprint(fecha_fin)\nfecha_fin = fecha_fin.strip()\nSetVar ('fecha_fin', fecha_fin)\n\nmonto_original = {registro}[15]\nprint(monto_original)\nSetVar ('monto_original', monto_original)\n\nmodificaciones = {registro}[16]\nprint(modificaciones)\nSetVar ('modificaciones', modificaciones)\n\nmonto_total = {registro}[17]\nprint(monto_total)\nSetVar ('monto_total', monto_total)\n\npagos_real = {registro}[18]\nprint(pagos_real)\nSetVar ('pagos_real', pagos_real)\n\nsaldo_real = {registro}[19]\nprint(saldo_real)\nSetVar ('saldo_real', saldo_real)\n\nmonto_retenido = {registro}[20]\nprint(monto_retenido)\nSetVar ('monto_retenido', monto_retenido)\n\npagos_directos = {registro}[21]\nprint(pagos_directos)\nSetVar ('pagos_directos', pagos_directos)\n\ngasto_promedio = {registro}[22]\nprint(gasto_promedio)\nSetVar ('gasto_promedio', gasto_promedio)\n\nproyeccion_gasto = {registro}[23]\nprint(proyeccion_gasto)\nSetVar ('proyeccion_gasto', proyeccion_gasto)\n\nfaltante = {registro}[24]\nprint(faltante)\nSetVar ('faltante', faltante)\n\nmeses = {registro}[25]\nprint(meses)\nSetVar ('meses', meses)\n\nmeses_transcurridos = {registro}[26]\nprint(meses_transcurridos)\nSetVar ('meses_transcurridos', meses_transcurridos)\n\nestado = {registro}[27]\nprint(estado)\nestado = estado.strip()\nSetVar ('estado', estado)
2024-08-20 10:03:17.593656 - rocketbot - INFO - request: N-DataEllipse : line 30.3 - rpaconnect : request  id: 6b0e9df4-5f6f-3645-1d62-a8b260598cfe -  - {"method":"post","url":"{api_ellipse}","json":"{\n  \"gerencia\":\"{gerencia}\",\n  \"codigoCttoAnterior\":\"{contrato}\",\n  \"tipoContrato\":\"{tipo_contrato}\",\n  \"tipoAdjudicacion\":\"{tipo_adjudicacion}\",\n  \"descripcion\":\"{descripcion}\",\n  \"rutAdministrador\":\"{administrador}\",\n  \"nombreAdministrador\":\"{nombre_admiistrador}\",\n  \"codigoProvedor\":\"{id_proveedor}\",\n  \"nombreProveddor\":\"{nombre_proveedor}\",\n  \"moneda\":\"{moneda}\",\n  \"rutIngenieroContrato\":\"{rut_ing_contratos}\",\n  \"nombreIngenieroContrato\":\"{nombre_ing}\",\n  \"fechaInicioActualizada\":\"{fecha_inicio}\",\n  \"fechaTerminoActualizada\":\"{fecha_fin}\",\n  \"monto\":\"{monto_original}\",\n  \"modificacionesMonto\":\"{modificaciones}\",\n  \"montoTotal\":\"{monto_total}\",\n  \"pagosReal\":\"{pagos_real}\",\n  \"saldoReal\":\"{saldo_real}\",\n  \"montoRetenido\":\"{monto_retenido}\",\n  \"pagosDirectos\":\"{pagos_directos}\",\n  \"gastoPromedioActualReal\":\"{gasto_promedio}\",\n  \"proyeccionGastoActual\":\"{proyeccion_gasto}\",\n  \"faltante\":\"{faltante}\",\n  \"mesesCtto\":\"{meses}\",\n  \"mesesTranscurridos\":\"{meses_transcurridos}\",\n  \"estadoContrato\":\"{estado}\"\n}","params":"","form":"","proxy":"","file":"","header":"{\"X-Api-Key\":\"{api_key}\"}"}
2024-08-20 10:03:38.656419 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_108 ""): ConnectTimeout: HTTPConnectionPool(host='54.88.59.194', port=8081): Max retries exceeded with url: /api/v1.0/sourcings (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x0000020BF1E8BB80>, 'Connection to 54.88.59.194 timed out. (connect timeout=None)'))
2024-08-20 10:03:38.672059 - rocketbot - INFO - request: N-DataEllipse : line 30.4 - rpaxls : setcell  id: 556e681f-94f9-2ea4-3e17-58ad6db10c28 -  - AC:{contador}={conexion_api_ellipse}
2024-08-20 10:03:38.672059 - rocketbot - INFO - request: N-DataEllipse : line 30.5 - rpasystem : setVar  id: b7f818c2-7f7d-03b6-397f-1cdd17ba8494 -  - {contador} + 1
2024-08-20 10:03:38.672059 - rocketbot - INFO - request: N-DataEllipse : line 30 - rpalogic : for  id: 5720dce3-a8ff-73b1-9406-3fb4b37b5c13 -  - {"iterable":"{contenido_excel}","count":0}
2024-08-20 10:03:38.703229 - rocketbot - INFO - For count: 5
2024-08-20 10:03:38.703229 - rocketbot - INFO - request: N-DataEllipse : line 30.1 - rpascripts : module  id: 1ea0031b-e3c7-c0f7-c8a9-f9f16739d951 -  - {"module_name":"System++","module":"cleanVars","vars":"gerencia,contrato,tipo_contrato,tipo_adjudicacion,descripcion,administrador,nombre_admiistrador,id_proveedor,nombre_proveedor,moneda,rut_ing_contratos,nombre_ing,fecha_inicio,fecha_fin,monto_original,modificaciones,monto_total,pagos_real,saldo_real,monto_retenido,pagos_directos,gasto_promedio,proyeccion_gasto,faltante,meses,meses_transcurridos,estado,conexion_api_ellipse,ingresado_pro"}
2024-08-20 10:03:38.703229 - rocketbot - INFO - request: N-DataEllipse : line 30.2 - rpascripts : execscriptpython  id: 7486e36a-d129-2902-dd42-57fd2ecd3c65 -  - ########################################################################\n#  Script que realiza la asignacion de valores del registro campo por  #\n#  campo a las variables que se utilizaran en el JSON de la API para   #\n#  enviar los datos a Atomox, de cada variable quita los espacios en   #\n#  blanco al principio y al final y si encuentra caracteres especiales #\n#  los sustituye por espacios en blanco                                #\n########################################################################\n\nimport re\n\npatron = re.compile(r'[^a-zA-Z0-9\s]')\n\ngerencia = {registro}[0]\nprint(gerencia)\nif gerencia is None:\n    SetVar ('gerencia', gerencia)\nelse:\n    gerencia = gerencia.strip()\n    SetVar ('gerencia', gerencia)\n\ncontrato = {registro}[1]\nprint(contrato)\nif contrato is None:\n    SetVar ('contrato', contrato)\nelse:\n    contrato = contrato.strip()\n    SetVar ('contrato', contrato)\n\ntipo_contrato = {registro}[2]\nprint(tipo_contrato)\nif tipo_contrato is None:\n    SetVar ('tipo_contrato', tipo_contrato)\nelse:\n    tipo_contrato = tipo_contrato.strip()\n    SetVar ('tipo_contrato', tipo_contrato)\n\ntipo_adjudicacion = {registro}[3]\nprint(tipo_adjudicacion)\nif tipo_adjudicacion is None:\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\nelse:\n    tipo_adjudicacion = tipo_adjudicacion.strip()\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\n\ndescripcion = {registro}[4]\nprint(descripcion)\nif descripcion is None:\n    SetVar ('descripcion', descripcion)\nelse:\n    descripcion_limpio = patron.sub(' ', descripcion)\n    descripcion = descripcion_limpio.strip()\n    SetVar ('descripcion', descripcion)\n\nadministrador = {registro}[5]\nprint(administrador)\nif administrador is None:\n    SetVar ('administrador', administrador)\nelse:  \n    administrador = administrador.strip()\n    SetVar ('administrador', administrador)\n\nnombre_admiistrador = {registro}[6]\nprint(nombre_admiistrador)\nif nombre_admiistrador is None:\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\nelse:    \n    nombre_admiistrador_limpio = patron.sub(' ', nombre_admiistrador)\n    nombre_admiistrador = nombre_admiistrador_limpio.strip()\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\n\nid_proveedor = {registro}[7]\nprint(id_proveedor)\nSetVar ('id_proveedor', id_proveedor)\n\nnombre_proveedor = {registro}[8]\nprint(nombre_proveedor)\nif nombre_proveedor is None:\n    SetVar ('nombre_proveedor', nombre_proveedor)\nelse:    \n    nombre_proveedor_limpio = patron.sub(' ', nombre_proveedor)\n    nombre_proveedor = nombre_proveedor_limpio.strip()\n    SetVar ('nombre_proveedor', nombre_proveedor)\n\nmoneda = {registro}[9]\nprint(moneda)\nif moneda is None:\n    SetVar ('moneda', moneda)\nelse:    \n    moneda_limpio = patron.sub(' ', moneda)\n    moneda = moneda_limpio.strip()\n    SetVar ('moneda', moneda)\n\nrut_ing_contratos = {registro}[10]\nprint(rut_ing_contratos)\nif rut_ing_contratos is None:\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\nelse:\n    rut_ing_contratos = rut_ing_contratos.strip()\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\n\nnombre_ing = {registro}[11]\nprint(nombre_ing)\nif nombre_ing is None:\n    SetVar ('nombre_ing', nombre_ing)\nelse:    \n    nombre_ing_limpio = patron.sub(' ', nombre_ing)\n    nombre_ing = nombre_ing_limpio.strip()\n    SetVar ('nombre_ing', nombre_ing)\n    \ningresado_por = {registro}[12]\nprint(ingresado_por)\ningresado_por = ingresado_por.strip()\nSetVar ('ingresado_por', ingresado_por)    \n\nfecha_inicio = {registro}[13]\nprint(fecha_inicio)\nfecha_inicio = fecha_inicio.strip()\nSetVar ('fecha_inicio', fecha_inicio)\n\nfecha_fin = {registro}[14]\nprint(fecha_fin)\nfecha_fin = fecha_fin.strip()\nSetVar ('fecha_fin', fecha_fin)\n\nmonto_original = {registro}[15]\nprint(monto_original)\nSetVar ('monto_original', monto_original)\n\nmodificaciones = {registro}[16]\nprint(modificaciones)\nSetVar ('modificaciones', modificaciones)\n\nmonto_total = {registro}[17]\nprint(monto_total)\nSetVar ('monto_total', monto_total)\n\npagos_real = {registro}[18]\nprint(pagos_real)\nSetVar ('pagos_real', pagos_real)\n\nsaldo_real = {registro}[19]\nprint(saldo_real)\nSetVar ('saldo_real', saldo_real)\n\nmonto_retenido = {registro}[20]\nprint(monto_retenido)\nSetVar ('monto_retenido', monto_retenido)\n\npagos_directos = {registro}[21]\nprint(pagos_directos)\nSetVar ('pagos_directos', pagos_directos)\n\ngasto_promedio = {registro}[22]\nprint(gasto_promedio)\nSetVar ('gasto_promedio', gasto_promedio)\n\nproyeccion_gasto = {registro}[23]\nprint(proyeccion_gasto)\nSetVar ('proyeccion_gasto', proyeccion_gasto)\n\nfaltante = {registro}[24]\nprint(faltante)\nSetVar ('faltante', faltante)\n\nmeses = {registro}[25]\nprint(meses)\nSetVar ('meses', meses)\n\nmeses_transcurridos = {registro}[26]\nprint(meses_transcurridos)\nSetVar ('meses_transcurridos', meses_transcurridos)\n\nestado = {registro}[27]\nprint(estado)\nestado = estado.strip()\nSetVar ('estado', estado)
2024-08-20 10:03:38.734473 - rocketbot - INFO - request: N-DataEllipse : line 30.3 - rpaconnect : request  id: 6b0e9df4-5f6f-3645-1d62-a8b260598cfe -  - {"method":"post","url":"{api_ellipse}","json":"{\n  \"gerencia\":\"{gerencia}\",\n  \"codigoCttoAnterior\":\"{contrato}\",\n  \"tipoContrato\":\"{tipo_contrato}\",\n  \"tipoAdjudicacion\":\"{tipo_adjudicacion}\",\n  \"descripcion\":\"{descripcion}\",\n  \"rutAdministrador\":\"{administrador}\",\n  \"nombreAdministrador\":\"{nombre_admiistrador}\",\n  \"codigoProvedor\":\"{id_proveedor}\",\n  \"nombreProveddor\":\"{nombre_proveedor}\",\n  \"moneda\":\"{moneda}\",\n  \"rutIngenieroContrato\":\"{rut_ing_contratos}\",\n  \"nombreIngenieroContrato\":\"{nombre_ing}\",\n  \"fechaInicioActualizada\":\"{fecha_inicio}\",\n  \"fechaTerminoActualizada\":\"{fecha_fin}\",\n  \"monto\":\"{monto_original}\",\n  \"modificacionesMonto\":\"{modificaciones}\",\n  \"montoTotal\":\"{monto_total}\",\n  \"pagosReal\":\"{pagos_real}\",\n  \"saldoReal\":\"{saldo_real}\",\n  \"montoRetenido\":\"{monto_retenido}\",\n  \"pagosDirectos\":\"{pagos_directos}\",\n  \"gastoPromedioActualReal\":\"{gasto_promedio}\",\n  \"proyeccionGastoActual\":\"{proyeccion_gasto}\",\n  \"faltante\":\"{faltante}\",\n  \"mesesCtto\":\"{meses}\",\n  \"mesesTranscurridos\":\"{meses_transcurridos}\",\n  \"estadoContrato\":\"{estado}\"\n}","params":"","form":"","proxy":"","file":"","header":"{\"X-Api-Key\":\"{api_key}\"}"}
2024-08-20 10:03:59.797233 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_108 ""): ConnectTimeout: HTTPConnectionPool(host='54.88.59.194', port=8081): Max retries exceeded with url: /api/v1.0/sourcings (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x0000020BF30DACE0>, 'Connection to 54.88.59.194 timed out. (connect timeout=None)'))
2024-08-20 10:03:59.797233 - rocketbot - INFO - request: N-DataEllipse : line 30.4 - rpaxls : setcell  id: 556e681f-94f9-2ea4-3e17-58ad6db10c28 -  - AC:{contador}={conexion_api_ellipse}
2024-08-20 10:03:59.797233 - rocketbot - INFO - request: N-DataEllipse : line 30.5 - rpasystem : setVar  id: b7f818c2-7f7d-03b6-397f-1cdd17ba8494 -  - {contador} + 1
2024-08-20 10:03:59.797233 - rocketbot - INFO - request: N-DataEllipse : line 30 - rpalogic : for  id: 5720dce3-a8ff-73b1-9406-3fb4b37b5c13 -  - {"iterable":"{contenido_excel}","count":0}
2024-08-20 10:03:59.828458 - rocketbot - INFO - For count: 6
2024-08-20 10:03:59.828458 - rocketbot - INFO - request: N-DataEllipse : line 30.1 - rpascripts : module  id: 1ea0031b-e3c7-c0f7-c8a9-f9f16739d951 -  - {"module_name":"System++","module":"cleanVars","vars":"gerencia,contrato,tipo_contrato,tipo_adjudicacion,descripcion,administrador,nombre_admiistrador,id_proveedor,nombre_proveedor,moneda,rut_ing_contratos,nombre_ing,fecha_inicio,fecha_fin,monto_original,modificaciones,monto_total,pagos_real,saldo_real,monto_retenido,pagos_directos,gasto_promedio,proyeccion_gasto,faltante,meses,meses_transcurridos,estado,conexion_api_ellipse,ingresado_pro"}
2024-08-20 10:03:59.828458 - rocketbot - INFO - request: N-DataEllipse : line 30.2 - rpascripts : execscriptpython  id: 7486e36a-d129-2902-dd42-57fd2ecd3c65 -  - ########################################################################\n#  Script que realiza la asignacion de valores del registro campo por  #\n#  campo a las variables que se utilizaran en el JSON de la API para   #\n#  enviar los datos a Atomox, de cada variable quita los espacios en   #\n#  blanco al principio y al final y si encuentra caracteres especiales #\n#  los sustituye por espacios en blanco                                #\n########################################################################\n\nimport re\n\npatron = re.compile(r'[^a-zA-Z0-9\s]')\n\ngerencia = {registro}[0]\nprint(gerencia)\nif gerencia is None:\n    SetVar ('gerencia', gerencia)\nelse:\n    gerencia = gerencia.strip()\n    SetVar ('gerencia', gerencia)\n\ncontrato = {registro}[1]\nprint(contrato)\nif contrato is None:\n    SetVar ('contrato', contrato)\nelse:\n    contrato = contrato.strip()\n    SetVar ('contrato', contrato)\n\ntipo_contrato = {registro}[2]\nprint(tipo_contrato)\nif tipo_contrato is None:\n    SetVar ('tipo_contrato', tipo_contrato)\nelse:\n    tipo_contrato = tipo_contrato.strip()\n    SetVar ('tipo_contrato', tipo_contrato)\n\ntipo_adjudicacion = {registro}[3]\nprint(tipo_adjudicacion)\nif tipo_adjudicacion is None:\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\nelse:\n    tipo_adjudicacion = tipo_adjudicacion.strip()\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\n\ndescripcion = {registro}[4]\nprint(descripcion)\nif descripcion is None:\n    SetVar ('descripcion', descripcion)\nelse:\n    descripcion_limpio = patron.sub(' ', descripcion)\n    descripcion = descripcion_limpio.strip()\n    SetVar ('descripcion', descripcion)\n\nadministrador = {registro}[5]\nprint(administrador)\nif administrador is None:\n    SetVar ('administrador', administrador)\nelse:  \n    administrador = administrador.strip()\n    SetVar ('administrador', administrador)\n\nnombre_admiistrador = {registro}[6]\nprint(nombre_admiistrador)\nif nombre_admiistrador is None:\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\nelse:    \n    nombre_admiistrador_limpio = patron.sub(' ', nombre_admiistrador)\n    nombre_admiistrador = nombre_admiistrador_limpio.strip()\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\n\nid_proveedor = {registro}[7]\nprint(id_proveedor)\nSetVar ('id_proveedor', id_proveedor)\n\nnombre_proveedor = {registro}[8]\nprint(nombre_proveedor)\nif nombre_proveedor is None:\n    SetVar ('nombre_proveedor', nombre_proveedor)\nelse:    \n    nombre_proveedor_limpio = patron.sub(' ', nombre_proveedor)\n    nombre_proveedor = nombre_proveedor_limpio.strip()\n    SetVar ('nombre_proveedor', nombre_proveedor)\n\nmoneda = {registro}[9]\nprint(moneda)\nif moneda is None:\n    SetVar ('moneda', moneda)\nelse:    \n    moneda_limpio = patron.sub(' ', moneda)\n    moneda = moneda_limpio.strip()\n    SetVar ('moneda', moneda)\n\nrut_ing_contratos = {registro}[10]\nprint(rut_ing_contratos)\nif rut_ing_contratos is None:\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\nelse:\n    rut_ing_contratos = rut_ing_contratos.strip()\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\n\nnombre_ing = {registro}[11]\nprint(nombre_ing)\nif nombre_ing is None:\n    SetVar ('nombre_ing', nombre_ing)\nelse:    \n    nombre_ing_limpio = patron.sub(' ', nombre_ing)\n    nombre_ing = nombre_ing_limpio.strip()\n    SetVar ('nombre_ing', nombre_ing)\n    \ningresado_por = {registro}[12]\nprint(ingresado_por)\ningresado_por = ingresado_por.strip()\nSetVar ('ingresado_por', ingresado_por)    \n\nfecha_inicio = {registro}[13]\nprint(fecha_inicio)\nfecha_inicio = fecha_inicio.strip()\nSetVar ('fecha_inicio', fecha_inicio)\n\nfecha_fin = {registro}[14]\nprint(fecha_fin)\nfecha_fin = fecha_fin.strip()\nSetVar ('fecha_fin', fecha_fin)\n\nmonto_original = {registro}[15]\nprint(monto_original)\nSetVar ('monto_original', monto_original)\n\nmodificaciones = {registro}[16]\nprint(modificaciones)\nSetVar ('modificaciones', modificaciones)\n\nmonto_total = {registro}[17]\nprint(monto_total)\nSetVar ('monto_total', monto_total)\n\npagos_real = {registro}[18]\nprint(pagos_real)\nSetVar ('pagos_real', pagos_real)\n\nsaldo_real = {registro}[19]\nprint(saldo_real)\nSetVar ('saldo_real', saldo_real)\n\nmonto_retenido = {registro}[20]\nprint(monto_retenido)\nSetVar ('monto_retenido', monto_retenido)\n\npagos_directos = {registro}[21]\nprint(pagos_directos)\nSetVar ('pagos_directos', pagos_directos)\n\ngasto_promedio = {registro}[22]\nprint(gasto_promedio)\nSetVar ('gasto_promedio', gasto_promedio)\n\nproyeccion_gasto = {registro}[23]\nprint(proyeccion_gasto)\nSetVar ('proyeccion_gasto', proyeccion_gasto)\n\nfaltante = {registro}[24]\nprint(faltante)\nSetVar ('faltante', faltante)\n\nmeses = {registro}[25]\nprint(meses)\nSetVar ('meses', meses)\n\nmeses_transcurridos = {registro}[26]\nprint(meses_transcurridos)\nSetVar ('meses_transcurridos', meses_transcurridos)\n\nestado = {registro}[27]\nprint(estado)\nestado = estado.strip()\nSetVar ('estado', estado)
2024-08-20 10:03:59.875135 - rocketbot - INFO - request: N-DataEllipse : line 30.3 - rpaconnect : request  id: 6b0e9df4-5f6f-3645-1d62-a8b260598cfe -  - {"method":"post","url":"{api_ellipse}","json":"{\n  \"gerencia\":\"{gerencia}\",\n  \"codigoCttoAnterior\":\"{contrato}\",\n  \"tipoContrato\":\"{tipo_contrato}\",\n  \"tipoAdjudicacion\":\"{tipo_adjudicacion}\",\n  \"descripcion\":\"{descripcion}\",\n  \"rutAdministrador\":\"{administrador}\",\n  \"nombreAdministrador\":\"{nombre_admiistrador}\",\n  \"codigoProvedor\":\"{id_proveedor}\",\n  \"nombreProveddor\":\"{nombre_proveedor}\",\n  \"moneda\":\"{moneda}\",\n  \"rutIngenieroContrato\":\"{rut_ing_contratos}\",\n  \"nombreIngenieroContrato\":\"{nombre_ing}\",\n  \"fechaInicioActualizada\":\"{fecha_inicio}\",\n  \"fechaTerminoActualizada\":\"{fecha_fin}\",\n  \"monto\":\"{monto_original}\",\n  \"modificacionesMonto\":\"{modificaciones}\",\n  \"montoTotal\":\"{monto_total}\",\n  \"pagosReal\":\"{pagos_real}\",\n  \"saldoReal\":\"{saldo_real}\",\n  \"montoRetenido\":\"{monto_retenido}\",\n  \"pagosDirectos\":\"{pagos_directos}\",\n  \"gastoPromedioActualReal\":\"{gasto_promedio}\",\n  \"proyeccionGastoActual\":\"{proyeccion_gasto}\",\n  \"faltante\":\"{faltante}\",\n  \"mesesCtto\":\"{meses}\",\n  \"mesesTranscurridos\":\"{meses_transcurridos}\",\n  \"estadoContrato\":\"{estado}\"\n}","params":"","form":"","proxy":"","file":"","header":"{\"X-Api-Key\":\"{api_key}\"}"}
2024-08-20 10:04:20.953544 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_108 ""): ConnectTimeout: HTTPConnectionPool(host='54.88.59.194', port=8081): Max retries exceeded with url: /api/v1.0/sourcings (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x0000020BF1E89B10>, 'Connection to 54.88.59.194 timed out. (connect timeout=None)'))
2024-08-20 10:04:20.953544 - rocketbot - INFO - request: N-DataEllipse : line 30.4 - rpaxls : setcell  id: 556e681f-94f9-2ea4-3e17-58ad6db10c28 -  - AC:{contador}={conexion_api_ellipse}
2024-08-20 10:04:20.953544 - rocketbot - INFO - request: N-DataEllipse : line 30.5 - rpasystem : setVar  id: b7f818c2-7f7d-03b6-397f-1cdd17ba8494 -  - {contador} + 1
2024-08-20 10:04:20.953544 - rocketbot - INFO - request: N-DataEllipse : line 30 - rpalogic : for  id: 5720dce3-a8ff-73b1-9406-3fb4b37b5c13 -  - {"iterable":"{contenido_excel}","count":0}
2024-08-20 10:04:21.000690 - rocketbot - INFO - request: N-DataEllipse : line 30.2 - rpascripts : execscriptpython  id: 7486e36a-d129-2902-dd42-57fd2ecd3c65 -  - ########################################################################\n#  Script que realiza la asignacion de valores del registro campo por  #\n#  campo a las variables que se utilizaran en el JSON de la API para   #\n#  enviar los datos a Atomox, de cada variable quita los espacios en   #\n#  blanco al principio y al final y si encuentra caracteres especiales #\n#  los sustituye por espacios en blanco                                #\n########################################################################\n\nimport re\n\npatron = re.compile(r'[^a-zA-Z0-9\s]')\n\ngerencia = {registro}[0]\nprint(gerencia)\nif gerencia is None:\n    SetVar ('gerencia', gerencia)\nelse:\n    gerencia = gerencia.strip()\n    SetVar ('gerencia', gerencia)\n\ncontrato = {registro}[1]\nprint(contrato)\nif contrato is None:\n    SetVar ('contrato', contrato)\nelse:\n    contrato = contrato.strip()\n    SetVar ('contrato', contrato)\n\ntipo_contrato = {registro}[2]\nprint(tipo_contrato)\nif tipo_contrato is None:\n    SetVar ('tipo_contrato', tipo_contrato)\nelse:\n    tipo_contrato = tipo_contrato.strip()\n    SetVar ('tipo_contrato', tipo_contrato)\n\ntipo_adjudicacion = {registro}[3]\nprint(tipo_adjudicacion)\nif tipo_adjudicacion is None:\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\nelse:\n    tipo_adjudicacion = tipo_adjudicacion.strip()\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\n\ndescripcion = {registro}[4]\nprint(descripcion)\nif descripcion is None:\n    SetVar ('descripcion', descripcion)\nelse:\n    descripcion_limpio = patron.sub(' ', descripcion)\n    descripcion = descripcion_limpio.strip()\n    SetVar ('descripcion', descripcion)\n\nadministrador = {registro}[5]\nprint(administrador)\nif administrador is None:\n    SetVar ('administrador', administrador)\nelse:  \n    administrador = administrador.strip()\n    SetVar ('administrador', administrador)\n\nnombre_admiistrador = {registro}[6]\nprint(nombre_admiistrador)\nif nombre_admiistrador is None:\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\nelse:    \n    nombre_admiistrador_limpio = patron.sub(' ', nombre_admiistrador)\n    nombre_admiistrador = nombre_admiistrador_limpio.strip()\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\n\nid_proveedor = {registro}[7]\nprint(id_proveedor)\nSetVar ('id_proveedor', id_proveedor)\n\nnombre_proveedor = {registro}[8]\nprint(nombre_proveedor)\nif nombre_proveedor is None:\n    SetVar ('nombre_proveedor', nombre_proveedor)\nelse:    \n    nombre_proveedor_limpio = patron.sub(' ', nombre_proveedor)\n    nombre_proveedor = nombre_proveedor_limpio.strip()\n    SetVar ('nombre_proveedor', nombre_proveedor)\n\nmoneda = {registro}[9]\nprint(moneda)\nif moneda is None:\n    SetVar ('moneda', moneda)\nelse:    \n    moneda_limpio = patron.sub(' ', moneda)\n    moneda = moneda_limpio.strip()\n    SetVar ('moneda', moneda)\n\nrut_ing_contratos = {registro}[10]\nprint(rut_ing_contratos)\nif rut_ing_contratos is None:\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\nelse:\n    rut_ing_contratos = rut_ing_contratos.strip()\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\n\nnombre_ing = {registro}[11]\nprint(nombre_ing)\nif nombre_ing is None:\n    SetVar ('nombre_ing', nombre_ing)\nelse:    \n    nombre_ing_limpio = patron.sub(' ', nombre_ing)\n    nombre_ing = nombre_ing_limpio.strip()\n    SetVar ('nombre_ing', nombre_ing)\n    \ningresado_por = {registro}[12]\nprint(ingresado_por)\ningresado_por = ingresado_por.strip()\nSetVar ('ingresado_por', ingresado_por)    \n\nfecha_inicio = {registro}[13]\nprint(fecha_inicio)\nfecha_inicio = fecha_inicio.strip()\nSetVar ('fecha_inicio', fecha_inicio)\n\nfecha_fin = {registro}[14]\nprint(fecha_fin)\nfecha_fin = fecha_fin.strip()\nSetVar ('fecha_fin', fecha_fin)\n\nmonto_original = {registro}[15]\nprint(monto_original)\nSetVar ('monto_original', monto_original)\n\nmodificaciones = {registro}[16]\nprint(modificaciones)\nSetVar ('modificaciones', modificaciones)\n\nmonto_total = {registro}[17]\nprint(monto_total)\nSetVar ('monto_total', monto_total)\n\npagos_real = {registro}[18]\nprint(pagos_real)\nSetVar ('pagos_real', pagos_real)\n\nsaldo_real = {registro}[19]\nprint(saldo_real)\nSetVar ('saldo_real', saldo_real)\n\nmonto_retenido = {registro}[20]\nprint(monto_retenido)\nSetVar ('monto_retenido', monto_retenido)\n\npagos_directos = {registro}[21]\nprint(pagos_directos)\nSetVar ('pagos_directos', pagos_directos)\n\ngasto_promedio = {registro}[22]\nprint(gasto_promedio)\nSetVar ('gasto_promedio', gasto_promedio)\n\nproyeccion_gasto = {registro}[23]\nprint(proyeccion_gasto)\nSetVar ('proyeccion_gasto', proyeccion_gasto)\n\nfaltante = {registro}[24]\nprint(faltante)\nSetVar ('faltante', faltante)\n\nmeses = {registro}[25]\nprint(meses)\nSetVar ('meses', meses)\n\nmeses_transcurridos = {registro}[26]\nprint(meses_transcurridos)\nSetVar ('meses_transcurridos', meses_transcurridos)\n\nestado = {registro}[27]\nprint(estado)\nestado = estado.strip()\nSetVar ('estado', estado)
2024-08-20 10:04:21.031850 - rocketbot - INFO - request: N-DataEllipse : line 30.3 - rpaconnect : request  id: 6b0e9df4-5f6f-3645-1d62-a8b260598cfe -  - {"method":"post","url":"{api_ellipse}","json":"{\n  \"gerencia\":\"{gerencia}\",\n  \"codigoCttoAnterior\":\"{contrato}\",\n  \"tipoContrato\":\"{tipo_contrato}\",\n  \"tipoAdjudicacion\":\"{tipo_adjudicacion}\",\n  \"descripcion\":\"{descripcion}\",\n  \"rutAdministrador\":\"{administrador}\",\n  \"nombreAdministrador\":\"{nombre_admiistrador}\",\n  \"codigoProvedor\":\"{id_proveedor}\",\n  \"nombreProveddor\":\"{nombre_proveedor}\",\n  \"moneda\":\"{moneda}\",\n  \"rutIngenieroContrato\":\"{rut_ing_contratos}\",\n  \"nombreIngenieroContrato\":\"{nombre_ing}\",\n  \"fechaInicioActualizada\":\"{fecha_inicio}\",\n  \"fechaTerminoActualizada\":\"{fecha_fin}\",\n  \"monto\":\"{monto_original}\",\n  \"modificacionesMonto\":\"{modificaciones}\",\n  \"montoTotal\":\"{monto_total}\",\n  \"pagosReal\":\"{pagos_real}\",\n  \"saldoReal\":\"{saldo_real}\",\n  \"montoRetenido\":\"{monto_retenido}\",\n  \"pagosDirectos\":\"{pagos_directos}\",\n  \"gastoPromedioActualReal\":\"{gasto_promedio}\",\n  \"proyeccionGastoActual\":\"{proyeccion_gasto}\",\n  \"faltante\":\"{faltante}\",\n  \"mesesCtto\":\"{meses}\",\n  \"mesesTranscurridos\":\"{meses_transcurridos}\",\n  \"estadoContrato\":\"{estado}\"\n}","params":"","form":"","proxy":"","file":"","header":"{\"X-Api-Key\":\"{api_key}\"}"}
2024-08-20 10:04:42.094841 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_108 ""): ConnectTimeout: HTTPConnectionPool(host='54.88.59.194', port=8081): Max retries exceeded with url: /api/v1.0/sourcings (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x0000020BF30D9720>, 'Connection to 54.88.59.194 timed out. (connect timeout=None)'))
2024-08-20 10:07:16.003157 - rocketbot - INFO - request: N-DataEllipse : line 30.4 - rpaxls : setcell  id: 556e681f-94f9-2ea4-3e17-58ad6db10c28 -  - AC:{contador}={conexion_api_ellipse}
2024-08-20 10:07:16.018797 - rocketbot - INFO - request: N-DataEllipse : line 30.5 - rpasystem : setVar  id: b7f818c2-7f7d-03b6-397f-1cdd17ba8494 -  - {contador} + 1
2024-08-20 10:07:16.018797 - rocketbot - INFO - request: N-DataEllipse : line 30 - rpalogic : for  id: 5720dce3-a8ff-73b1-9406-3fb4b37b5c13 -  - {"iterable":"{contenido_excel}","count":0}
2024-08-20 10:07:16.049971 - rocketbot - INFO - For count: 8
2024-08-20 10:07:16.049971 - rocketbot - INFO - request: N-DataEllipse : line 30.1 - rpascripts : module  id: 1ea0031b-e3c7-c0f7-c8a9-f9f16739d951 -  - {"module_name":"System++","module":"cleanVars","vars":"gerencia,contrato,tipo_contrato,tipo_adjudicacion,descripcion,administrador,nombre_admiistrador,id_proveedor,nombre_proveedor,moneda,rut_ing_contratos,nombre_ing,fecha_inicio,fecha_fin,monto_original,modificaciones,monto_total,pagos_real,saldo_real,monto_retenido,pagos_directos,gasto_promedio,proyeccion_gasto,faltante,meses,meses_transcurridos,estado,conexion_api_ellipse,ingresado_pro"}
2024-08-20 10:07:16.065495 - rocketbot - INFO - request: N-DataEllipse : line 30.2 - rpascripts : execscriptpython  id: 7486e36a-d129-2902-dd42-57fd2ecd3c65 -  - ########################################################################\n#  Script que realiza la asignacion de valores del registro campo por  #\n#  campo a las variables que se utilizaran en el JSON de la API para   #\n#  enviar los datos a Atomox, de cada variable quita los espacios en   #\n#  blanco al principio y al final y si encuentra caracteres especiales #\n#  los sustituye por espacios en blanco                                #\n########################################################################\n\nimport re\n\npatron = re.compile(r'[^a-zA-Z0-9\s]')\n\ngerencia = {registro}[0]\nprint(gerencia)\nif gerencia is None:\n    SetVar ('gerencia', gerencia)\nelse:\n    gerencia = gerencia.strip()\n    SetVar ('gerencia', gerencia)\n\ncontrato = {registro}[1]\nprint(contrato)\nif contrato is None:\n    SetVar ('contrato', contrato)\nelse:\n    contrato = contrato.strip()\n    SetVar ('contrato', contrato)\n\ntipo_contrato = {registro}[2]\nprint(tipo_contrato)\nif tipo_contrato is None:\n    SetVar ('tipo_contrato', tipo_contrato)\nelse:\n    tipo_contrato = tipo_contrato.strip()\n    SetVar ('tipo_contrato', tipo_contrato)\n\ntipo_adjudicacion = {registro}[3]\nprint(tipo_adjudicacion)\nif tipo_adjudicacion is None:\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\nelse:\n    tipo_adjudicacion = tipo_adjudicacion.strip()\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\n\ndescripcion = {registro}[4]\nprint(descripcion)\nif descripcion is None:\n    SetVar ('descripcion', descripcion)\nelse:\n    descripcion_limpio = patron.sub(' ', descripcion)\n    descripcion = descripcion_limpio.strip()\n    SetVar ('descripcion', descripcion)\n\nadministrador = {registro}[5]\nprint(administrador)\nif administrador is None:\n    SetVar ('administrador', administrador)\nelse:  \n    administrador = administrador.strip()\n    SetVar ('administrador', administrador)\n\nnombre_admiistrador = {registro}[6]\nprint(nombre_admiistrador)\nif nombre_admiistrador is None:\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\nelse:    \n    nombre_admiistrador_limpio = patron.sub(' ', nombre_admiistrador)\n    nombre_admiistrador = nombre_admiistrador_limpio.strip()\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\n\nid_proveedor = {registro}[7]\nprint(id_proveedor)\nSetVar ('id_proveedor', id_proveedor)\n\nnombre_proveedor = {registro}[8]\nprint(nombre_proveedor)\nif nombre_proveedor is None:\n    SetVar ('nombre_proveedor', nombre_proveedor)\nelse:    \n    nombre_proveedor_limpio = patron.sub(' ', nombre_proveedor)\n    nombre_proveedor = nombre_proveedor_limpio.strip()\n    SetVar ('nombre_proveedor', nombre_proveedor)\n\nmoneda = {registro}[9]\nprint(moneda)\nif moneda is None:\n    SetVar ('moneda', moneda)\nelse:    \n    moneda_limpio = patron.sub(' ', moneda)\n    moneda = moneda_limpio.strip()\n    SetVar ('moneda', moneda)\n\nrut_ing_contratos = {registro}[10]\nprint(rut_ing_contratos)\nif rut_ing_contratos is None:\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\nelse:\n    rut_ing_contratos = rut_ing_contratos.strip()\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\n\nnombre_ing = {registro}[11]\nprint(nombre_ing)\nif nombre_ing is None:\n    SetVar ('nombre_ing', nombre_ing)\nelse:    \n    nombre_ing_limpio = patron.sub(' ', nombre_ing)\n    nombre_ing = nombre_ing_limpio.strip()\n    SetVar ('nombre_ing', nombre_ing)\n    \ningresado_por = {registro}[12]\nprint(ingresado_por)\ningresado_por = ingresado_por.strip()\nSetVar ('ingresado_por', ingresado_por)    \n\nfecha_inicio = {registro}[13]\nprint(fecha_inicio)\nfecha_inicio = fecha_inicio.strip()\nSetVar ('fecha_inicio', fecha_inicio)\n\nfecha_fin = {registro}[14]\nprint(fecha_fin)\nfecha_fin = fecha_fin.strip()\nSetVar ('fecha_fin', fecha_fin)\n\nmonto_original = {registro}[15]\nprint(monto_original)\nSetVar ('monto_original', monto_original)\n\nmodificaciones = {registro}[16]\nprint(modificaciones)\nSetVar ('modificaciones', modificaciones)\n\nmonto_total = {registro}[17]\nprint(monto_total)\nSetVar ('monto_total', monto_total)\n\npagos_real = {registro}[18]\nprint(pagos_real)\nSetVar ('pagos_real', pagos_real)\n\nsaldo_real = {registro}[19]\nprint(saldo_real)\nSetVar ('saldo_real', saldo_real)\n\nmonto_retenido = {registro}[20]\nprint(monto_retenido)\nSetVar ('monto_retenido', monto_retenido)\n\npagos_directos = {registro}[21]\nprint(pagos_directos)\nSetVar ('pagos_directos', pagos_directos)\n\ngasto_promedio = {registro}[22]\nprint(gasto_promedio)\nSetVar ('gasto_promedio', gasto_promedio)\n\nproyeccion_gasto = {registro}[23]\nprint(proyeccion_gasto)\nSetVar ('proyeccion_gasto', proyeccion_gasto)\n\nfaltante = {registro}[24]\nprint(faltante)\nSetVar ('faltante', faltante)\n\nmeses = {registro}[25]\nprint(meses)\nSetVar ('meses', meses)\n\nmeses_transcurridos = {registro}[26]\nprint(meses_transcurridos)\nSetVar ('meses_transcurridos', meses_transcurridos)\n\nestado = {registro}[27]\nprint(estado)\nestado = estado.strip()\nSetVar ('estado', estado)
2024-08-20 10:07:16.096658 - rocketbot - INFO - request: N-DataEllipse : line 30.3 - rpaconnect : request  id: 6b0e9df4-5f6f-3645-1d62-a8b260598cfe -  - {"method":"post","url":"{api_ellipse}","json":"{\n  \"gerencia\":\"{gerencia}\",\n  \"codigoCttoAnterior\":\"{contrato}\",\n  \"tipoContrato\":\"{tipo_contrato}\",\n  \"tipoAdjudicacion\":\"{tipo_adjudicacion}\",\n  \"descripcion\":\"{descripcion}\",\n  \"rutAdministrador\":\"{administrador}\",\n  \"nombreAdministrador\":\"{nombre_admiistrador}\",\n  \"codigoProvedor\":\"{id_proveedor}\",\n  \"nombreProveddor\":\"{nombre_proveedor}\",\n  \"moneda\":\"{moneda}\",\n  \"rutIngenieroContrato\":\"{rut_ing_contratos}\",\n  \"nombreIngenieroContrato\":\"{nombre_ing}\",\n  \"fechaInicioActualizada\":\"{fecha_inicio}\",\n  \"fechaTerminoActualizada\":\"{fecha_fin}\",\n  \"monto\":\"{monto_original}\",\n  \"modificacionesMonto\":\"{modificaciones}\",\n  \"montoTotal\":\"{monto_total}\",\n  \"pagosReal\":\"{pagos_real}\",\n  \"saldoReal\":\"{saldo_real}\",\n  \"montoRetenido\":\"{monto_retenido}\",\n  \"pagosDirectos\":\"{pagos_directos}\",\n  \"gastoPromedioActualReal\":\"{gasto_promedio}\",\n  \"proyeccionGastoActual\":\"{proyeccion_gasto}\",\n  \"faltante\":\"{faltante}\",\n  \"mesesCtto\":\"{meses}\",\n  \"mesesTranscurridos\":\"{meses_transcurridos}\",\n  \"estadoContrato\":\"{estado}\"\n}","params":"","form":"","proxy":"","file":"","header":"{\"X-Api-Key\":\"{api_key}\"}"}
2024-08-20 10:07:37.159865 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_108 ""): ConnectTimeout: HTTPConnectionPool(host='54.88.59.194', port=8081): Max retries exceeded with url: /api/v1.0/sourcings (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x0000020BF5397B20>, 'Connection to 54.88.59.194 timed out. (connect timeout=None)'))
2024-08-20 10:07:37.159865 - rocketbot - INFO - request: N-DataEllipse : line 30.4 - rpaxls : setcell  id: 556e681f-94f9-2ea4-3e17-58ad6db10c28 -  - AC:{contador}={conexion_api_ellipse}
2024-08-20 10:07:37.159865 - rocketbot - INFO - request: N-DataEllipse : line 30.5 - rpasystem : setVar  id: b7f818c2-7f7d-03b6-397f-1cdd17ba8494 -  - {contador} + 1
2024-08-20 10:07:37.159865 - rocketbot - INFO - request: N-DataEllipse : line 30 - rpalogic : for  id: 5720dce3-a8ff-73b1-9406-3fb4b37b5c13 -  - {"iterable":"{contenido_excel}","count":0}
2024-08-20 10:07:37.191219 - rocketbot - INFO - For count: 9
2024-08-20 10:07:37.191219 - rocketbot - INFO - request: N-DataEllipse : line 30.1 - rpascripts : module  id: 1ea0031b-e3c7-c0f7-c8a9-f9f16739d951 -  - {"module_name":"System++","module":"cleanVars","vars":"gerencia,contrato,tipo_contrato,tipo_adjudicacion,descripcion,administrador,nombre_admiistrador,id_proveedor,nombre_proveedor,moneda,rut_ing_contratos,nombre_ing,fecha_inicio,fecha_fin,monto_original,modificaciones,monto_total,pagos_real,saldo_real,monto_retenido,pagos_directos,gasto_promedio,proyeccion_gasto,faltante,meses,meses_transcurridos,estado,conexion_api_ellipse,ingresado_pro"}
2024-08-20 10:07:37.191219 - rocketbot - INFO - request: N-DataEllipse : line 30.2 - rpascripts : execscriptpython  id: 7486e36a-d129-2902-dd42-57fd2ecd3c65 -  - ########################################################################\n#  Script que realiza la asignacion de valores del registro campo por  #\n#  campo a las variables que se utilizaran en el JSON de la API para   #\n#  enviar los datos a Atomox, de cada variable quita los espacios en   #\n#  blanco al principio y al final y si encuentra caracteres especiales #\n#  los sustituye por espacios en blanco                                #\n########################################################################\n\nimport re\n\npatron = re.compile(r'[^a-zA-Z0-9\s]')\n\ngerencia = {registro}[0]\nprint(gerencia)\nif gerencia is None:\n    SetVar ('gerencia', gerencia)\nelse:\n    gerencia = gerencia.strip()\n    SetVar ('gerencia', gerencia)\n\ncontrato = {registro}[1]\nprint(contrato)\nif contrato is None:\n    SetVar ('contrato', contrato)\nelse:\n    contrato = contrato.strip()\n    SetVar ('contrato', contrato)\n\ntipo_contrato = {registro}[2]\nprint(tipo_contrato)\nif tipo_contrato is None:\n    SetVar ('tipo_contrato', tipo_contrato)\nelse:\n    tipo_contrato = tipo_contrato.strip()\n    SetVar ('tipo_contrato', tipo_contrato)\n\ntipo_adjudicacion = {registro}[3]\nprint(tipo_adjudicacion)\nif tipo_adjudicacion is None:\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\nelse:\n    tipo_adjudicacion = tipo_adjudicacion.strip()\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\n\ndescripcion = {registro}[4]\nprint(descripcion)\nif descripcion is None:\n    SetVar ('descripcion', descripcion)\nelse:\n    descripcion_limpio = patron.sub(' ', descripcion)\n    descripcion = descripcion_limpio.strip()\n    SetVar ('descripcion', descripcion)\n\nadministrador = {registro}[5]\nprint(administrador)\nif administrador is None:\n    SetVar ('administrador', administrador)\nelse:  \n    administrador = administrador.strip()\n    SetVar ('administrador', administrador)\n\nnombre_admiistrador = {registro}[6]\nprint(nombre_admiistrador)\nif nombre_admiistrador is None:\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\nelse:    \n    nombre_admiistrador_limpio = patron.sub(' ', nombre_admiistrador)\n    nombre_admiistrador = nombre_admiistrador_limpio.strip()\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\n\nid_proveedor = {registro}[7]\nprint(id_proveedor)\nSetVar ('id_proveedor', id_proveedor)\n\nnombre_proveedor = {registro}[8]\nprint(nombre_proveedor)\nif nombre_proveedor is None:\n    SetVar ('nombre_proveedor', nombre_proveedor)\nelse:    \n    nombre_proveedor_limpio = patron.sub(' ', nombre_proveedor)\n    nombre_proveedor = nombre_proveedor_limpio.strip()\n    SetVar ('nombre_proveedor', nombre_proveedor)\n\nmoneda = {registro}[9]\nprint(moneda)\nif moneda is None:\n    SetVar ('moneda', moneda)\nelse:    \n    moneda_limpio = patron.sub(' ', moneda)\n    moneda = moneda_limpio.strip()\n    SetVar ('moneda', moneda)\n\nrut_ing_contratos = {registro}[10]\nprint(rut_ing_contratos)\nif rut_ing_contratos is None:\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\nelse:\n    rut_ing_contratos = rut_ing_contratos.strip()\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\n\nnombre_ing = {registro}[11]\nprint(nombre_ing)\nif nombre_ing is None:\n    SetVar ('nombre_ing', nombre_ing)\nelse:    \n    nombre_ing_limpio = patron.sub(' ', nombre_ing)\n    nombre_ing = nombre_ing_limpio.strip()\n    SetVar ('nombre_ing', nombre_ing)\n    \ningresado_por = {registro}[12]\nprint(ingresado_por)\ningresado_por = ingresado_por.strip()\nSetVar ('ingresado_por', ingresado_por)    \n\nfecha_inicio = {registro}[13]\nprint(fecha_inicio)\nfecha_inicio = fecha_inicio.strip()\nSetVar ('fecha_inicio', fecha_inicio)\n\nfecha_fin = {registro}[14]\nprint(fecha_fin)\nfecha_fin = fecha_fin.strip()\nSetVar ('fecha_fin', fecha_fin)\n\nmonto_original = {registro}[15]\nprint(monto_original)\nSetVar ('monto_original', monto_original)\n\nmodificaciones = {registro}[16]\nprint(modificaciones)\nSetVar ('modificaciones', modificaciones)\n\nmonto_total = {registro}[17]\nprint(monto_total)\nSetVar ('monto_total', monto_total)\n\npagos_real = {registro}[18]\nprint(pagos_real)\nSetVar ('pagos_real', pagos_real)\n\nsaldo_real = {registro}[19]\nprint(saldo_real)\nSetVar ('saldo_real', saldo_real)\n\nmonto_retenido = {registro}[20]\nprint(monto_retenido)\nSetVar ('monto_retenido', monto_retenido)\n\npagos_directos = {registro}[21]\nprint(pagos_directos)\nSetVar ('pagos_directos', pagos_directos)\n\ngasto_promedio = {registro}[22]\nprint(gasto_promedio)\nSetVar ('gasto_promedio', gasto_promedio)\n\nproyeccion_gasto = {registro}[23]\nprint(proyeccion_gasto)\nSetVar ('proyeccion_gasto', proyeccion_gasto)\n\nfaltante = {registro}[24]\nprint(faltante)\nSetVar ('faltante', faltante)\n\nmeses = {registro}[25]\nprint(meses)\nSetVar ('meses', meses)\n\nmeses_transcurridos = {registro}[26]\nprint(meses_transcurridos)\nSetVar ('meses_transcurridos', meses_transcurridos)\n\nestado = {registro}[27]\nprint(estado)\nestado = estado.strip()\nSetVar ('estado', estado)
2024-08-20 10:07:37.238093 - rocketbot - INFO - request: N-DataEllipse : line 30.3 - rpaconnect : request  id: 6b0e9df4-5f6f-3645-1d62-a8b260598cfe -  - {"method":"post","url":"{api_ellipse}","json":"{\n  \"gerencia\":\"{gerencia}\",\n  \"codigoCttoAnterior\":\"{contrato}\",\n  \"tipoContrato\":\"{tipo_contrato}\",\n  \"tipoAdjudicacion\":\"{tipo_adjudicacion}\",\n  \"descripcion\":\"{descripcion}\",\n  \"rutAdministrador\":\"{administrador}\",\n  \"nombreAdministrador\":\"{nombre_admiistrador}\",\n  \"codigoProvedor\":\"{id_proveedor}\",\n  \"nombreProveddor\":\"{nombre_proveedor}\",\n  \"moneda\":\"{moneda}\",\n  \"rutIngenieroContrato\":\"{rut_ing_contratos}\",\n  \"nombreIngenieroContrato\":\"{nombre_ing}\",\n  \"fechaInicioActualizada\":\"{fecha_inicio}\",\n  \"fechaTerminoActualizada\":\"{fecha_fin}\",\n  \"monto\":\"{monto_original}\",\n  \"modificacionesMonto\":\"{modificaciones}\",\n  \"montoTotal\":\"{monto_total}\",\n  \"pagosReal\":\"{pagos_real}\",\n  \"saldoReal\":\"{saldo_real}\",\n  \"montoRetenido\":\"{monto_retenido}\",\n  \"pagosDirectos\":\"{pagos_directos}\",\n  \"gastoPromedioActualReal\":\"{gasto_promedio}\",\n  \"proyeccionGastoActual\":\"{proyeccion_gasto}\",\n  \"faltante\":\"{faltante}\",\n  \"mesesCtto\":\"{meses}\",\n  \"mesesTranscurridos\":\"{meses_transcurridos}\",\n  \"estadoContrato\":\"{estado}\"\n}","params":"","form":"","proxy":"","file":"","header":"{\"X-Api-Key\":\"{api_key}\"}"}
2024-08-20 10:07:58.300593 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_108 ""): ConnectTimeout: HTTPConnectionPool(host='54.88.59.194', port=8081): Max retries exceeded with url: /api/v1.0/sourcings (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x0000020BF30D95A0>, 'Connection to 54.88.59.194 timed out. (connect timeout=None)'))
2024-08-20 10:07:58.300593 - rocketbot - INFO - request: N-DataEllipse : line 30.4 - rpaxls : setcell  id: 556e681f-94f9-2ea4-3e17-58ad6db10c28 -  - AC:{contador}={conexion_api_ellipse}
2024-08-20 10:07:58.300593 - rocketbot - INFO - request: N-DataEllipse : line 30.5 - rpasystem : setVar  id: b7f818c2-7f7d-03b6-397f-1cdd17ba8494 -  - {contador} + 1
2024-08-20 10:07:58.300593 - rocketbot - INFO - request: N-DataEllipse : line 30 - rpalogic : for  id: 5720dce3-a8ff-73b1-9406-3fb4b37b5c13 -  - {"iterable":"{contenido_excel}","count":0}
2024-08-20 10:07:58.331998 - rocketbot - INFO - For count: 10
2024-08-20 10:07:58.331998 - rocketbot - INFO - request: N-DataEllipse : line 30.1 - rpascripts : module  id: 1ea0031b-e3c7-c0f7-c8a9-f9f16739d951 -  - {"module_name":"System++","module":"cleanVars","vars":"gerencia,contrato,tipo_contrato,tipo_adjudicacion,descripcion,administrador,nombre_admiistrador,id_proveedor,nombre_proveedor,moneda,rut_ing_contratos,nombre_ing,fecha_inicio,fecha_fin,monto_original,modificaciones,monto_total,pagos_real,saldo_real,monto_retenido,pagos_directos,gasto_promedio,proyeccion_gasto,faltante,meses,meses_transcurridos,estado,conexion_api_ellipse,ingresado_pro"}
2024-08-20 10:07:58.347515 - rocketbot - INFO - request: N-DataEllipse : line 30.2 - rpascripts : execscriptpython  id: 7486e36a-d129-2902-dd42-57fd2ecd3c65 -  - ########################################################################\n#  Script que realiza la asignacion de valores del registro campo por  #\n#  campo a las variables que se utilizaran en el JSON de la API para   #\n#  enviar los datos a Atomox, de cada variable quita los espacios en   #\n#  blanco al principio y al final y si encuentra caracteres especiales #\n#  los sustituye por espacios en blanco                                #\n########################################################################\n\nimport re\n\npatron = re.compile(r'[^a-zA-Z0-9\s]')\n\ngerencia = {registro}[0]\nprint(gerencia)\nif gerencia is None:\n    SetVar ('gerencia', gerencia)\nelse:\n    gerencia = gerencia.strip()\n    SetVar ('gerencia', gerencia)\n\ncontrato = {registro}[1]\nprint(contrato)\nif contrato is None:\n    SetVar ('contrato', contrato)\nelse:\n    contrato = contrato.strip()\n    SetVar ('contrato', contrato)\n\ntipo_contrato = {registro}[2]\nprint(tipo_contrato)\nif tipo_contrato is None:\n    SetVar ('tipo_contrato', tipo_contrato)\nelse:\n    tipo_contrato = tipo_contrato.strip()\n    SetVar ('tipo_contrato', tipo_contrato)\n\ntipo_adjudicacion = {registro}[3]\nprint(tipo_adjudicacion)\nif tipo_adjudicacion is None:\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\nelse:\n    tipo_adjudicacion = tipo_adjudicacion.strip()\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\n\ndescripcion = {registro}[4]\nprint(descripcion)\nif descripcion is None:\n    SetVar ('descripcion', descripcion)\nelse:\n    descripcion_limpio = patron.sub(' ', descripcion)\n    descripcion = descripcion_limpio.strip()\n    SetVar ('descripcion', descripcion)\n\nadministrador = {registro}[5]\nprint(administrador)\nif administrador is None:\n    SetVar ('administrador', administrador)\nelse:  \n    administrador = administrador.strip()\n    SetVar ('administrador', administrador)\n\nnombre_admiistrador = {registro}[6]\nprint(nombre_admiistrador)\nif nombre_admiistrador is None:\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\nelse:    \n    nombre_admiistrador_limpio = patron.sub(' ', nombre_admiistrador)\n    nombre_admiistrador = nombre_admiistrador_limpio.strip()\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\n\nid_proveedor = {registro}[7]\nprint(id_proveedor)\nSetVar ('id_proveedor', id_proveedor)\n\nnombre_proveedor = {registro}[8]\nprint(nombre_proveedor)\nif nombre_proveedor is None:\n    SetVar ('nombre_proveedor', nombre_proveedor)\nelse:    \n    nombre_proveedor_limpio = patron.sub(' ', nombre_proveedor)\n    nombre_proveedor = nombre_proveedor_limpio.strip()\n    SetVar ('nombre_proveedor', nombre_proveedor)\n\nmoneda = {registro}[9]\nprint(moneda)\nif moneda is None:\n    SetVar ('moneda', moneda)\nelse:    \n    moneda_limpio = patron.sub(' ', moneda)\n    moneda = moneda_limpio.strip()\n    SetVar ('moneda', moneda)\n\nrut_ing_contratos = {registro}[10]\nprint(rut_ing_contratos)\nif rut_ing_contratos is None:\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\nelse:\n    rut_ing_contratos = rut_ing_contratos.strip()\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\n\nnombre_ing = {registro}[11]\nprint(nombre_ing)\nif nombre_ing is None:\n    SetVar ('nombre_ing', nombre_ing)\nelse:    \n    nombre_ing_limpio = patron.sub(' ', nombre_ing)\n    nombre_ing = nombre_ing_limpio.strip()\n    SetVar ('nombre_ing', nombre_ing)\n    \ningresado_por = {registro}[12]\nprint(ingresado_por)\ningresado_por = ingresado_por.strip()\nSetVar ('ingresado_por', ingresado_por)    \n\nfecha_inicio = {registro}[13]\nprint(fecha_inicio)\nfecha_inicio = fecha_inicio.strip()\nSetVar ('fecha_inicio', fecha_inicio)\n\nfecha_fin = {registro}[14]\nprint(fecha_fin)\nfecha_fin = fecha_fin.strip()\nSetVar ('fecha_fin', fecha_fin)\n\nmonto_original = {registro}[15]\nprint(monto_original)\nSetVar ('monto_original', monto_original)\n\nmodificaciones = {registro}[16]\nprint(modificaciones)\nSetVar ('modificaciones', modificaciones)\n\nmonto_total = {registro}[17]\nprint(monto_total)\nSetVar ('monto_total', monto_total)\n\npagos_real = {registro}[18]\nprint(pagos_real)\nSetVar ('pagos_real', pagos_real)\n\nsaldo_real = {registro}[19]\nprint(saldo_real)\nSetVar ('saldo_real', saldo_real)\n\nmonto_retenido = {registro}[20]\nprint(monto_retenido)\nSetVar ('monto_retenido', monto_retenido)\n\npagos_directos = {registro}[21]\nprint(pagos_directos)\nSetVar ('pagos_directos', pagos_directos)\n\ngasto_promedio = {registro}[22]\nprint(gasto_promedio)\nSetVar ('gasto_promedio', gasto_promedio)\n\nproyeccion_gasto = {registro}[23]\nprint(proyeccion_gasto)\nSetVar ('proyeccion_gasto', proyeccion_gasto)\n\nfaltante = {registro}[24]\nprint(faltante)\nSetVar ('faltante', faltante)\n\nmeses = {registro}[25]\nprint(meses)\nSetVar ('meses', meses)\n\nmeses_transcurridos = {registro}[26]\nprint(meses_transcurridos)\nSetVar ('meses_transcurridos', meses_transcurridos)\n\nestado = {registro}[27]\nprint(estado)\nestado = estado.strip()\nSetVar ('estado', estado)
2024-08-20 10:07:58.378685 - rocketbot - INFO - request: N-DataEllipse : line 30.3 - rpaconnect : request  id: 6b0e9df4-5f6f-3645-1d62-a8b260598cfe -  - {"method":"post","url":"{api_ellipse}","json":"{\n  \"gerencia\":\"{gerencia}\",\n  \"codigoCttoAnterior\":\"{contrato}\",\n  \"tipoContrato\":\"{tipo_contrato}\",\n  \"tipoAdjudicacion\":\"{tipo_adjudicacion}\",\n  \"descripcion\":\"{descripcion}\",\n  \"rutAdministrador\":\"{administrador}\",\n  \"nombreAdministrador\":\"{nombre_admiistrador}\",\n  \"codigoProvedor\":\"{id_proveedor}\",\n  \"nombreProveddor\":\"{nombre_proveedor}\",\n  \"moneda\":\"{moneda}\",\n  \"rutIngenieroContrato\":\"{rut_ing_contratos}\",\n  \"nombreIngenieroContrato\":\"{nombre_ing}\",\n  \"fechaInicioActualizada\":\"{fecha_inicio}\",\n  \"fechaTerminoActualizada\":\"{fecha_fin}\",\n  \"monto\":\"{monto_original}\",\n  \"modificacionesMonto\":\"{modificaciones}\",\n  \"montoTotal\":\"{monto_total}\",\n  \"pagosReal\":\"{pagos_real}\",\n  \"saldoReal\":\"{saldo_real}\",\n  \"montoRetenido\":\"{monto_retenido}\",\n  \"pagosDirectos\":\"{pagos_directos}\",\n  \"gastoPromedioActualReal\":\"{gasto_promedio}\",\n  \"proyeccionGastoActual\":\"{proyeccion_gasto}\",\n  \"faltante\":\"{faltante}\",\n  \"mesesCtto\":\"{meses}\",\n  \"mesesTranscurridos\":\"{meses_transcurridos}\",\n  \"estadoContrato\":\"{estado}\"\n}","params":"","form":"","proxy":"","file":"","header":"{\"X-Api-Key\":\"{api_key}\"}"}
2024-08-20 10:08:19.425952 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_108 ""): ConnectTimeout: HTTPConnectionPool(host='54.88.59.194', port=8081): Max retries exceeded with url: /api/v1.0/sourcings (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x0000020BF5395B70>, 'Connection to 54.88.59.194 timed out. (connect timeout=None)'))
2024-08-20 10:08:19.425952 - rocketbot - INFO - request: N-DataEllipse : line 30.4 - rpaxls : setcell  id: 556e681f-94f9-2ea4-3e17-58ad6db10c28 -  - AC:{contador}={conexion_api_ellipse}
2024-08-20 10:08:19.425952 - rocketbot - INFO - request: N-DataEllipse : line 30.5 - rpasystem : setVar  id: b7f818c2-7f7d-03b6-397f-1cdd17ba8494 -  - {contador} + 1
2024-08-20 10:08:19.425952 - rocketbot - INFO - request: N-DataEllipse : line 30 - rpalogic : for  id: 5720dce3-a8ff-73b1-9406-3fb4b37b5c13 -  - {"iterable":"{contenido_excel}","count":0}
2024-08-20 10:08:19.457260 - rocketbot - INFO - For count: 11
2024-08-20 10:08:19.457260 - rocketbot - INFO - request: N-DataEllipse : line 30.1 - rpascripts : module  id: 1ea0031b-e3c7-c0f7-c8a9-f9f16739d951 -  - {"module_name":"System++","module":"cleanVars","vars":"gerencia,contrato,tipo_contrato,tipo_adjudicacion,descripcion,administrador,nombre_admiistrador,id_proveedor,nombre_proveedor,moneda,rut_ing_contratos,nombre_ing,fecha_inicio,fecha_fin,monto_original,modificaciones,monto_total,pagos_real,saldo_real,monto_retenido,pagos_directos,gasto_promedio,proyeccion_gasto,faltante,meses,meses_transcurridos,estado,conexion_api_ellipse,ingresado_pro"}
2024-08-20 10:08:19.457260 - rocketbot - INFO - request: N-DataEllipse : line 30.2 - rpascripts : execscriptpython  id: 7486e36a-d129-2902-dd42-57fd2ecd3c65 -  - ########################################################################\n#  Script que realiza la asignacion de valores del registro campo por  #\n#  campo a las variables que se utilizaran en el JSON de la API para   #\n#  enviar los datos a Atomox, de cada variable quita los espacios en   #\n#  blanco al principio y al final y si encuentra caracteres especiales #\n#  los sustituye por espacios en blanco                                #\n########################################################################\n\nimport re\n\npatron = re.compile(r'[^a-zA-Z0-9\s]')\n\ngerencia = {registro}[0]\nprint(gerencia)\nif gerencia is None:\n    SetVar ('gerencia', gerencia)\nelse:\n    gerencia = gerencia.strip()\n    SetVar ('gerencia', gerencia)\n\ncontrato = {registro}[1]\nprint(contrato)\nif contrato is None:\n    SetVar ('contrato', contrato)\nelse:\n    contrato = contrato.strip()\n    SetVar ('contrato', contrato)\n\ntipo_contrato = {registro}[2]\nprint(tipo_contrato)\nif tipo_contrato is None:\n    SetVar ('tipo_contrato', tipo_contrato)\nelse:\n    tipo_contrato = tipo_contrato.strip()\n    SetVar ('tipo_contrato', tipo_contrato)\n\ntipo_adjudicacion = {registro}[3]\nprint(tipo_adjudicacion)\nif tipo_adjudicacion is None:\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\nelse:\n    tipo_adjudicacion = tipo_adjudicacion.strip()\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\n\ndescripcion = {registro}[4]\nprint(descripcion)\nif descripcion is None:\n    SetVar ('descripcion', descripcion)\nelse:\n    descripcion_limpio = patron.sub(' ', descripcion)\n    descripcion = descripcion_limpio.strip()\n    SetVar ('descripcion', descripcion)\n\nadministrador = {registro}[5]\nprint(administrador)\nif administrador is None:\n    SetVar ('administrador', administrador)\nelse:  \n    administrador = administrador.strip()\n    SetVar ('administrador', administrador)\n\nnombre_admiistrador = {registro}[6]\nprint(nombre_admiistrador)\nif nombre_admiistrador is None:\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\nelse:    \n    nombre_admiistrador_limpio = patron.sub(' ', nombre_admiistrador)\n    nombre_admiistrador = nombre_admiistrador_limpio.strip()\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\n\nid_proveedor = {registro}[7]\nprint(id_proveedor)\nSetVar ('id_proveedor', id_proveedor)\n\nnombre_proveedor = {registro}[8]\nprint(nombre_proveedor)\nif nombre_proveedor is None:\n    SetVar ('nombre_proveedor', nombre_proveedor)\nelse:    \n    nombre_proveedor_limpio = patron.sub(' ', nombre_proveedor)\n    nombre_proveedor = nombre_proveedor_limpio.strip()\n    SetVar ('nombre_proveedor', nombre_proveedor)\n\nmoneda = {registro}[9]\nprint(moneda)\nif moneda is None:\n    SetVar ('moneda', moneda)\nelse:    \n    moneda_limpio = patron.sub(' ', moneda)\n    moneda = moneda_limpio.strip()\n    SetVar ('moneda', moneda)\n\nrut_ing_contratos = {registro}[10]\nprint(rut_ing_contratos)\nif rut_ing_contratos is None:\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\nelse:\n    rut_ing_contratos = rut_ing_contratos.strip()\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\n\nnombre_ing = {registro}[11]\nprint(nombre_ing)\nif nombre_ing is None:\n    SetVar ('nombre_ing', nombre_ing)\nelse:    \n    nombre_ing_limpio = patron.sub(' ', nombre_ing)\n    nombre_ing = nombre_ing_limpio.strip()\n    SetVar ('nombre_ing', nombre_ing)\n    \ningresado_por = {registro}[12]\nprint(ingresado_por)\ningresado_por = ingresado_por.strip()\nSetVar ('ingresado_por', ingresado_por)    \n\nfecha_inicio = {registro}[13]\nprint(fecha_inicio)\nfecha_inicio = fecha_inicio.strip()\nSetVar ('fecha_inicio', fecha_inicio)\n\nfecha_fin = {registro}[14]\nprint(fecha_fin)\nfecha_fin = fecha_fin.strip()\nSetVar ('fecha_fin', fecha_fin)\n\nmonto_original = {registro}[15]\nprint(monto_original)\nSetVar ('monto_original', monto_original)\n\nmodificaciones = {registro}[16]\nprint(modificaciones)\nSetVar ('modificaciones', modificaciones)\n\nmonto_total = {registro}[17]\nprint(monto_total)\nSetVar ('monto_total', monto_total)\n\npagos_real = {registro}[18]\nprint(pagos_real)\nSetVar ('pagos_real', pagos_real)\n\nsaldo_real = {registro}[19]\nprint(saldo_real)\nSetVar ('saldo_real', saldo_real)\n\nmonto_retenido = {registro}[20]\nprint(monto_retenido)\nSetVar ('monto_retenido', monto_retenido)\n\npagos_directos = {registro}[21]\nprint(pagos_directos)\nSetVar ('pagos_directos', pagos_directos)\n\ngasto_promedio = {registro}[22]\nprint(gasto_promedio)\nSetVar ('gasto_promedio', gasto_promedio)\n\nproyeccion_gasto = {registro}[23]\nprint(proyeccion_gasto)\nSetVar ('proyeccion_gasto', proyeccion_gasto)\n\nfaltante = {registro}[24]\nprint(faltante)\nSetVar ('faltante', faltante)\n\nmeses = {registro}[25]\nprint(meses)\nSetVar ('meses', meses)\n\nmeses_transcurridos = {registro}[26]\nprint(meses_transcurridos)\nSetVar ('meses_transcurridos', meses_transcurridos)\n\nestado = {registro}[27]\nprint(estado)\nestado = estado.strip()\nSetVar ('estado', estado)
2024-08-20 10:08:19.504004 - rocketbot - INFO - request: N-DataEllipse : line 30.3 - rpaconnect : request  id: 6b0e9df4-5f6f-3645-1d62-a8b260598cfe -  - {"method":"post","url":"{api_ellipse}","json":"{\n  \"gerencia\":\"{gerencia}\",\n  \"codigoCttoAnterior\":\"{contrato}\",\n  \"tipoContrato\":\"{tipo_contrato}\",\n  \"tipoAdjudicacion\":\"{tipo_adjudicacion}\",\n  \"descripcion\":\"{descripcion}\",\n  \"rutAdministrador\":\"{administrador}\",\n  \"nombreAdministrador\":\"{nombre_admiistrador}\",\n  \"codigoProvedor\":\"{id_proveedor}\",\n  \"nombreProveddor\":\"{nombre_proveedor}\",\n  \"moneda\":\"{moneda}\",\n  \"rutIngenieroContrato\":\"{rut_ing_contratos}\",\n  \"nombreIngenieroContrato\":\"{nombre_ing}\",\n  \"fechaInicioActualizada\":\"{fecha_inicio}\",\n  \"fechaTerminoActualizada\":\"{fecha_fin}\",\n  \"monto\":\"{monto_original}\",\n  \"modificacionesMonto\":\"{modificaciones}\",\n  \"montoTotal\":\"{monto_total}\",\n  \"pagosReal\":\"{pagos_real}\",\n  \"saldoReal\":\"{saldo_real}\",\n  \"montoRetenido\":\"{monto_retenido}\",\n  \"pagosDirectos\":\"{pagos_directos}\",\n  \"gastoPromedioActualReal\":\"{gasto_promedio}\",\n  \"proyeccionGastoActual\":\"{proyeccion_gasto}\",\n  \"faltante\":\"{faltante}\",\n  \"mesesCtto\":\"{meses}\",\n  \"mesesTranscurridos\":\"{meses_transcurridos}\",\n  \"estadoContrato\":\"{estado}\"\n}","params":"","form":"","proxy":"","file":"","header":"{\"X-Api-Key\":\"{api_key}\"}"}
2024-08-20 10:08:40.582720 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_108 ""): ConnectTimeout: HTTPConnectionPool(host='54.88.59.194', port=8081): Max retries exceeded with url: /api/v1.0/sourcings (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x0000020BF30DACE0>, 'Connection to 54.88.59.194 timed out. (connect timeout=None)'))
2024-08-20 10:08:40.582720 - rocketbot - INFO - request: N-DataEllipse : line 30.4 - rpaxls : setcell  id: 556e681f-94f9-2ea4-3e17-58ad6db10c28 -  - AC:{contador}={conexion_api_ellipse}
2024-08-20 10:08:40.582720 - rocketbot - INFO - request: N-DataEllipse : line 30.5 - rpasystem : setVar  id: b7f818c2-7f7d-03b6-397f-1cdd17ba8494 -  - {contador} + 1
2024-08-20 10:08:40.582720 - rocketbot - INFO - request: N-DataEllipse : line 30 - rpalogic : for  id: 5720dce3-a8ff-73b1-9406-3fb4b37b5c13 -  - {"iterable":"{contenido_excel}","count":0}
2024-08-20 10:08:40.613894 - rocketbot - INFO - For count: 12
2024-08-20 10:08:40.613894 - rocketbot - INFO - request: N-DataEllipse : line 30.1 - rpascripts : module  id: 1ea0031b-e3c7-c0f7-c8a9-f9f16739d951 -  - {"module_name":"System++","module":"cleanVars","vars":"gerencia,contrato,tipo_contrato,tipo_adjudicacion,descripcion,administrador,nombre_admiistrador,id_proveedor,nombre_proveedor,moneda,rut_ing_contratos,nombre_ing,fecha_inicio,fecha_fin,monto_original,modificaciones,monto_total,pagos_real,saldo_real,monto_retenido,pagos_directos,gasto_promedio,proyeccion_gasto,faltante,meses,meses_transcurridos,estado,conexion_api_ellipse,ingresado_pro"}
2024-08-20 10:08:40.629452 - rocketbot - INFO - request: N-DataEllipse : line 30.2 - rpascripts : execscriptpython  id: 7486e36a-d129-2902-dd42-57fd2ecd3c65 -  - ########################################################################\n#  Script que realiza la asignacion de valores del registro campo por  #\n#  campo a las variables que se utilizaran en el JSON de la API para   #\n#  enviar los datos a Atomox, de cada variable quita los espacios en   #\n#  blanco al principio y al final y si encuentra caracteres especiales #\n#  los sustituye por espacios en blanco                                #\n########################################################################\n\nimport re\n\npatron = re.compile(r'[^a-zA-Z0-9\s]')\n\ngerencia = {registro}[0]\nprint(gerencia)\nif gerencia is None:\n    SetVar ('gerencia', gerencia)\nelse:\n    gerencia = gerencia.strip()\n    SetVar ('gerencia', gerencia)\n\ncontrato = {registro}[1]\nprint(contrato)\nif contrato is None:\n    SetVar ('contrato', contrato)\nelse:\n    contrato = contrato.strip()\n    SetVar ('contrato', contrato)\n\ntipo_contrato = {registro}[2]\nprint(tipo_contrato)\nif tipo_contrato is None:\n    SetVar ('tipo_contrato', tipo_contrato)\nelse:\n    tipo_contrato = tipo_contrato.strip()\n    SetVar ('tipo_contrato', tipo_contrato)\n\ntipo_adjudicacion = {registro}[3]\nprint(tipo_adjudicacion)\nif tipo_adjudicacion is None:\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\nelse:\n    tipo_adjudicacion = tipo_adjudicacion.strip()\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\n\ndescripcion = {registro}[4]\nprint(descripcion)\nif descripcion is None:\n    SetVar ('descripcion', descripcion)\nelse:\n    descripcion_limpio = patron.sub(' ', descripcion)\n    descripcion = descripcion_limpio.strip()\n    SetVar ('descripcion', descripcion)\n\nadministrador = {registro}[5]\nprint(administrador)\nif administrador is None:\n    SetVar ('administrador', administrador)\nelse:  \n    administrador = administrador.strip()\n    SetVar ('administrador', administrador)\n\nnombre_admiistrador = {registro}[6]\nprint(nombre_admiistrador)\nif nombre_admiistrador is None:\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\nelse:    \n    nombre_admiistrador_limpio = patron.sub(' ', nombre_admiistrador)\n    nombre_admiistrador = nombre_admiistrador_limpio.strip()\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\n\nid_proveedor = {registro}[7]\nprint(id_proveedor)\nSetVar ('id_proveedor', id_proveedor)\n\nnombre_proveedor = {registro}[8]\nprint(nombre_proveedor)\nif nombre_proveedor is None:\n    SetVar ('nombre_proveedor', nombre_proveedor)\nelse:    \n    nombre_proveedor_limpio = patron.sub(' ', nombre_proveedor)\n    nombre_proveedor = nombre_proveedor_limpio.strip()\n    SetVar ('nombre_proveedor', nombre_proveedor)\n\nmoneda = {registro}[9]\nprint(moneda)\nif moneda is None:\n    SetVar ('moneda', moneda)\nelse:    \n    moneda_limpio = patron.sub(' ', moneda)\n    moneda = moneda_limpio.strip()\n    SetVar ('moneda', moneda)\n\nrut_ing_contratos = {registro}[10]\nprint(rut_ing_contratos)\nif rut_ing_contratos is None:\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\nelse:\n    rut_ing_contratos = rut_ing_contratos.strip()\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\n\nnombre_ing = {registro}[11]\nprint(nombre_ing)\nif nombre_ing is None:\n    SetVar ('nombre_ing', nombre_ing)\nelse:    \n    nombre_ing_limpio = patron.sub(' ', nombre_ing)\n    nombre_ing = nombre_ing_limpio.strip()\n    SetVar ('nombre_ing', nombre_ing)\n    \ningresado_por = {registro}[12]\nprint(ingresado_por)\ningresado_por = ingresado_por.strip()\nSetVar ('ingresado_por', ingresado_por)    \n\nfecha_inicio = {registro}[13]\nprint(fecha_inicio)\nfecha_inicio = fecha_inicio.strip()\nSetVar ('fecha_inicio', fecha_inicio)\n\nfecha_fin = {registro}[14]\nprint(fecha_fin)\nfecha_fin = fecha_fin.strip()\nSetVar ('fecha_fin', fecha_fin)\n\nmonto_original = {registro}[15]\nprint(monto_original)\nSetVar ('monto_original', monto_original)\n\nmodificaciones = {registro}[16]\nprint(modificaciones)\nSetVar ('modificaciones', modificaciones)\n\nmonto_total = {registro}[17]\nprint(monto_total)\nSetVar ('monto_total', monto_total)\n\npagos_real = {registro}[18]\nprint(pagos_real)\nSetVar ('pagos_real', pagos_real)\n\nsaldo_real = {registro}[19]\nprint(saldo_real)\nSetVar ('saldo_real', saldo_real)\n\nmonto_retenido = {registro}[20]\nprint(monto_retenido)\nSetVar ('monto_retenido', monto_retenido)\n\npagos_directos = {registro}[21]\nprint(pagos_directos)\nSetVar ('pagos_directos', pagos_directos)\n\ngasto_promedio = {registro}[22]\nprint(gasto_promedio)\nSetVar ('gasto_promedio', gasto_promedio)\n\nproyeccion_gasto = {registro}[23]\nprint(proyeccion_gasto)\nSetVar ('proyeccion_gasto', proyeccion_gasto)\n\nfaltante = {registro}[24]\nprint(faltante)\nSetVar ('faltante', faltante)\n\nmeses = {registro}[25]\nprint(meses)\nSetVar ('meses', meses)\n\nmeses_transcurridos = {registro}[26]\nprint(meses_transcurridos)\nSetVar ('meses_transcurridos', meses_transcurridos)\n\nestado = {registro}[27]\nprint(estado)\nestado = estado.strip()\nSetVar ('estado', estado)
2024-08-20 10:08:40.660603 - rocketbot - INFO - request: N-DataEllipse : line 30.3 - rpaconnect : request  id: 6b0e9df4-5f6f-3645-1d62-a8b260598cfe -  - {"method":"post","url":"{api_ellipse}","json":"{\n  \"gerencia\":\"{gerencia}\",\n  \"codigoCttoAnterior\":\"{contrato}\",\n  \"tipoContrato\":\"{tipo_contrato}\",\n  \"tipoAdjudicacion\":\"{tipo_adjudicacion}\",\n  \"descripcion\":\"{descripcion}\",\n  \"rutAdministrador\":\"{administrador}\",\n  \"nombreAdministrador\":\"{nombre_admiistrador}\",\n  \"codigoProvedor\":\"{id_proveedor}\",\n  \"nombreProveddor\":\"{nombre_proveedor}\",\n  \"moneda\":\"{moneda}\",\n  \"rutIngenieroContrato\":\"{rut_ing_contratos}\",\n  \"nombreIngenieroContrato\":\"{nombre_ing}\",\n  \"fechaInicioActualizada\":\"{fecha_inicio}\",\n  \"fechaTerminoActualizada\":\"{fecha_fin}\",\n  \"monto\":\"{monto_original}\",\n  \"modificacionesMonto\":\"{modificaciones}\",\n  \"montoTotal\":\"{monto_total}\",\n  \"pagosReal\":\"{pagos_real}\",\n  \"saldoReal\":\"{saldo_real}\",\n  \"montoRetenido\":\"{monto_retenido}\",\n  \"pagosDirectos\":\"{pagos_directos}\",\n  \"gastoPromedioActualReal\":\"{gasto_promedio}\",\n  \"proyeccionGastoActual\":\"{proyeccion_gasto}\",\n  \"faltante\":\"{faltante}\",\n  \"mesesCtto\":\"{meses}\",\n  \"mesesTranscurridos\":\"{meses_transcurridos}\",\n  \"estadoContrato\":\"{estado}\"\n}","params":"","form":"","proxy":"","file":"","header":"{\"X-Api-Key\":\"{api_key}\"}"}
2024-08-20 10:09:01.723844 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_108 ""): ConnectTimeout: HTTPConnectionPool(host='54.88.59.194', port=8081): Max retries exceeded with url: /api/v1.0/sourcings (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x0000020BF5394790>, 'Connection to 54.88.59.194 timed out. (connect timeout=None)'))
2024-08-20 10:09:01.723844 - rocketbot - INFO - request: N-DataEllipse : line 30.4 - rpaxls : setcell  id: 556e681f-94f9-2ea4-3e17-58ad6db10c28 -  - AC:{contador}={conexion_api_ellipse}
2024-08-20 10:09:01.739487 - rocketbot - INFO - request: N-DataEllipse : line 30.5 - rpasystem : setVar  id: b7f818c2-7f7d-03b6-397f-1cdd17ba8494 -  - {contador} + 1
2024-08-20 10:09:01.739487 - rocketbot - INFO - request: N-DataEllipse : line 30 - rpalogic : for  id: 5720dce3-a8ff-73b1-9406-3fb4b37b5c13 -  - {"iterable":"{contenido_excel}","count":0}
2024-08-20 10:09:01.755067 - rocketbot - INFO - For count: 13
2024-08-20 10:09:01.770712 - rocketbot - INFO - request: N-DataEllipse : line 30.1 - rpascripts : module  id: 1ea0031b-e3c7-c0f7-c8a9-f9f16739d951 -  - {"module_name":"System++","module":"cleanVars","vars":"gerencia,contrato,tipo_contrato,tipo_adjudicacion,descripcion,administrador,nombre_admiistrador,id_proveedor,nombre_proveedor,moneda,rut_ing_contratos,nombre_ing,fecha_inicio,fecha_fin,monto_original,modificaciones,monto_total,pagos_real,saldo_real,monto_retenido,pagos_directos,gasto_promedio,proyeccion_gasto,faltante,meses,meses_transcurridos,estado,conexion_api_ellipse,ingresado_pro"}
2024-08-20 10:09:01.770712 - rocketbot - INFO - request: N-DataEllipse : line 30.2 - rpascripts : execscriptpython  id: 7486e36a-d129-2902-dd42-57fd2ecd3c65 -  - ########################################################################\n#  Script que realiza la asignacion de valores del registro campo por  #\n#  campo a las variables que se utilizaran en el JSON de la API para   #\n#  enviar los datos a Atomox, de cada variable quita los espacios en   #\n#  blanco al principio y al final y si encuentra caracteres especiales #\n#  los sustituye por espacios en blanco                                #\n########################################################################\n\nimport re\n\npatron = re.compile(r'[^a-zA-Z0-9\s]')\n\ngerencia = {registro}[0]\nprint(gerencia)\nif gerencia is None:\n    SetVar ('gerencia', gerencia)\nelse:\n    gerencia = gerencia.strip()\n    SetVar ('gerencia', gerencia)\n\ncontrato = {registro}[1]\nprint(contrato)\nif contrato is None:\n    SetVar ('contrato', contrato)\nelse:\n    contrato = contrato.strip()\n    SetVar ('contrato', contrato)\n\ntipo_contrato = {registro}[2]\nprint(tipo_contrato)\nif tipo_contrato is None:\n    SetVar ('tipo_contrato', tipo_contrato)\nelse:\n    tipo_contrato = tipo_contrato.strip()\n    SetVar ('tipo_contrato', tipo_contrato)\n\ntipo_adjudicacion = {registro}[3]\nprint(tipo_adjudicacion)\nif tipo_adjudicacion is None:\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\nelse:\n    tipo_adjudicacion = tipo_adjudicacion.strip()\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\n\ndescripcion = {registro}[4]\nprint(descripcion)\nif descripcion is None:\n    SetVar ('descripcion', descripcion)\nelse:\n    descripcion_limpio = patron.sub(' ', descripcion)\n    descripcion = descripcion_limpio.strip()\n    SetVar ('descripcion', descripcion)\n\nadministrador = {registro}[5]\nprint(administrador)\nif administrador is None:\n    SetVar ('administrador', administrador)\nelse:  \n    administrador = administrador.strip()\n    SetVar ('administrador', administrador)\n\nnombre_admiistrador = {registro}[6]\nprint(nombre_admiistrador)\nif nombre_admiistrador is None:\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\nelse:    \n    nombre_admiistrador_limpio = patron.sub(' ', nombre_admiistrador)\n    nombre_admiistrador = nombre_admiistrador_limpio.strip()\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\n\nid_proveedor = {registro}[7]\nprint(id_proveedor)\nSetVar ('id_proveedor', id_proveedor)\n\nnombre_proveedor = {registro}[8]\nprint(nombre_proveedor)\nif nombre_proveedor is None:\n    SetVar ('nombre_proveedor', nombre_proveedor)\nelse:    \n    nombre_proveedor_limpio = patron.sub(' ', nombre_proveedor)\n    nombre_proveedor = nombre_proveedor_limpio.strip()\n    SetVar ('nombre_proveedor', nombre_proveedor)\n\nmoneda = {registro}[9]\nprint(moneda)\nif moneda is None:\n    SetVar ('moneda', moneda)\nelse:    \n    moneda_limpio = patron.sub(' ', moneda)\n    moneda = moneda_limpio.strip()\n    SetVar ('moneda', moneda)\n\nrut_ing_contratos = {registro}[10]\nprint(rut_ing_contratos)\nif rut_ing_contratos is None:\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\nelse:\n    rut_ing_contratos = rut_ing_contratos.strip()\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\n\nnombre_ing = {registro}[11]\nprint(nombre_ing)\nif nombre_ing is None:\n    SetVar ('nombre_ing', nombre_ing)\nelse:    \n    nombre_ing_limpio = patron.sub(' ', nombre_ing)\n    nombre_ing = nombre_ing_limpio.strip()\n    SetVar ('nombre_ing', nombre_ing)\n    \ningresado_por = {registro}[12]\nprint(ingresado_por)\ningresado_por = ingresado_por.strip()\nSetVar ('ingresado_por', ingresado_por)    \n\nfecha_inicio = {registro}[13]\nprint(fecha_inicio)\nfecha_inicio = fecha_inicio.strip()\nSetVar ('fecha_inicio', fecha_inicio)\n\nfecha_fin = {registro}[14]\nprint(fecha_fin)\nfecha_fin = fecha_fin.strip()\nSetVar ('fecha_fin', fecha_fin)\n\nmonto_original = {registro}[15]\nprint(monto_original)\nSetVar ('monto_original', monto_original)\n\nmodificaciones = {registro}[16]\nprint(modificaciones)\nSetVar ('modificaciones', modificaciones)\n\nmonto_total = {registro}[17]\nprint(monto_total)\nSetVar ('monto_total', monto_total)\n\npagos_real = {registro}[18]\nprint(pagos_real)\nSetVar ('pagos_real', pagos_real)\n\nsaldo_real = {registro}[19]\nprint(saldo_real)\nSetVar ('saldo_real', saldo_real)\n\nmonto_retenido = {registro}[20]\nprint(monto_retenido)\nSetVar ('monto_retenido', monto_retenido)\n\npagos_directos = {registro}[21]\nprint(pagos_directos)\nSetVar ('pagos_directos', pagos_directos)\n\ngasto_promedio = {registro}[22]\nprint(gasto_promedio)\nSetVar ('gasto_promedio', gasto_promedio)\n\nproyeccion_gasto = {registro}[23]\nprint(proyeccion_gasto)\nSetVar ('proyeccion_gasto', proyeccion_gasto)\n\nfaltante = {registro}[24]\nprint(faltante)\nSetVar ('faltante', faltante)\n\nmeses = {registro}[25]\nprint(meses)\nSetVar ('meses', meses)\n\nmeses_transcurridos = {registro}[26]\nprint(meses_transcurridos)\nSetVar ('meses_transcurridos', meses_transcurridos)\n\nestado = {registro}[27]\nprint(estado)\nestado = estado.strip()\nSetVar ('estado', estado)
2024-08-20 10:09:01.817397 - rocketbot - INFO - request: N-DataEllipse : line 30.3 - rpaconnect : request  id: 6b0e9df4-5f6f-3645-1d62-a8b260598cfe -  - {"method":"post","url":"{api_ellipse}","json":"{\n  \"gerencia\":\"{gerencia}\",\n  \"codigoCttoAnterior\":\"{contrato}\",\n  \"tipoContrato\":\"{tipo_contrato}\",\n  \"tipoAdjudicacion\":\"{tipo_adjudicacion}\",\n  \"descripcion\":\"{descripcion}\",\n  \"rutAdministrador\":\"{administrador}\",\n  \"nombreAdministrador\":\"{nombre_admiistrador}\",\n  \"codigoProvedor\":\"{id_proveedor}\",\n  \"nombreProveddor\":\"{nombre_proveedor}\",\n  \"moneda\":\"{moneda}\",\n  \"rutIngenieroContrato\":\"{rut_ing_contratos}\",\n  \"nombreIngenieroContrato\":\"{nombre_ing}\",\n  \"fechaInicioActualizada\":\"{fecha_inicio}\",\n  \"fechaTerminoActualizada\":\"{fecha_fin}\",\n  \"monto\":\"{monto_original}\",\n  \"modificacionesMonto\":\"{modificaciones}\",\n  \"montoTotal\":\"{monto_total}\",\n  \"pagosReal\":\"{pagos_real}\",\n  \"saldoReal\":\"{saldo_real}\",\n  \"montoRetenido\":\"{monto_retenido}\",\n  \"pagosDirectos\":\"{pagos_directos}\",\n  \"gastoPromedioActualReal\":\"{gasto_promedio}\",\n  \"proyeccionGastoActual\":\"{proyeccion_gasto}\",\n  \"faltante\":\"{faltante}\",\n  \"mesesCtto\":\"{meses}\",\n  \"mesesTranscurridos\":\"{meses_transcurridos}\",\n  \"estadoContrato\":\"{estado}\"\n}","params":"","form":"","proxy":"","file":"","header":"{\"X-Api-Key\":\"{api_key}\"}"}
2024-08-20 10:09:22.864361 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_108 ""): ConnectTimeout: HTTPConnectionPool(host='54.88.59.194', port=8081): Max retries exceeded with url: /api/v1.0/sourcings (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x0000020BF30D9720>, 'Connection to 54.88.59.194 timed out. (connect timeout=None)'))
2024-08-20 10:10:03.708761 - rocketbot - INFO - request: N-DataEllipse : line 30.4 - rpaxls : setcell  id: 556e681f-94f9-2ea4-3e17-58ad6db10c28 -  - AC:{contador}={conexion_api_ellipse}
2024-08-20 10:10:03.708761 - rocketbot - INFO - request: N-DataEllipse : line 30.5 - rpasystem : setVar  id: b7f818c2-7f7d-03b6-397f-1cdd17ba8494 -  - {contador} + 1
2024-08-20 10:10:03.708761 - rocketbot - INFO - request: N-DataEllipse : line 30 - rpalogic : for  id: 5720dce3-a8ff-73b1-9406-3fb4b37b5c13 -  - {"iterable":"{contenido_excel}","count":0}
2024-08-20 10:10:03.740018 - rocketbot - INFO - For count: 14
2024-08-20 10:10:03.740018 - rocketbot - INFO - request: N-DataEllipse : line 30.1 - rpascripts : module  id: 1ea0031b-e3c7-c0f7-c8a9-f9f16739d951 -  - {"module_name":"System++","module":"cleanVars","vars":"gerencia,contrato,tipo_contrato,tipo_adjudicacion,descripcion,administrador,nombre_admiistrador,id_proveedor,nombre_proveedor,moneda,rut_ing_contratos,nombre_ing,fecha_inicio,fecha_fin,monto_original,modificaciones,monto_total,pagos_real,saldo_real,monto_retenido,pagos_directos,gasto_promedio,proyeccion_gasto,faltante,meses,meses_transcurridos,estado,conexion_api_ellipse,ingresado_pro"}
2024-08-20 10:10:03.740018 - rocketbot - INFO - request: N-DataEllipse : line 30.2 - rpascripts : execscriptpython  id: 7486e36a-d129-2902-dd42-57fd2ecd3c65 -  - ########################################################################\n#  Script que realiza la asignacion de valores del registro campo por  #\n#  campo a las variables que se utilizaran en el JSON de la API para   #\n#  enviar los datos a Atomox, de cada variable quita los espacios en   #\n#  blanco al principio y al final y si encuentra caracteres especiales #\n#  los sustituye por espacios en blanco                                #\n########################################################################\n\nimport re\n\npatron = re.compile(r'[^a-zA-Z0-9\s]')\n\ngerencia = {registro}[0]\nprint(gerencia)\nif gerencia is None:\n    SetVar ('gerencia', gerencia)\nelse:\n    gerencia = gerencia.strip()\n    SetVar ('gerencia', gerencia)\n\ncontrato = {registro}[1]\nprint(contrato)\nif contrato is None:\n    SetVar ('contrato', contrato)\nelse:\n    contrato = contrato.strip()\n    SetVar ('contrato', contrato)\n\ntipo_contrato = {registro}[2]\nprint(tipo_contrato)\nif tipo_contrato is None:\n    SetVar ('tipo_contrato', tipo_contrato)\nelse:\n    tipo_contrato = tipo_contrato.strip()\n    SetVar ('tipo_contrato', tipo_contrato)\n\ntipo_adjudicacion = {registro}[3]\nprint(tipo_adjudicacion)\nif tipo_adjudicacion is None:\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\nelse:\n    tipo_adjudicacion = tipo_adjudicacion.strip()\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\n\ndescripcion = {registro}[4]\nprint(descripcion)\nif descripcion is None:\n    SetVar ('descripcion', descripcion)\nelse:\n    descripcion_limpio = patron.sub(' ', descripcion)\n    descripcion = descripcion_limpio.strip()\n    SetVar ('descripcion', descripcion)\n\nadministrador = {registro}[5]\nprint(administrador)\nif administrador is None:\n    SetVar ('administrador', administrador)\nelse:  \n    administrador = administrador.strip()\n    SetVar ('administrador', administrador)\n\nnombre_admiistrador = {registro}[6]\nprint(nombre_admiistrador)\nif nombre_admiistrador is None:\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\nelse:    \n    nombre_admiistrador_limpio = patron.sub(' ', nombre_admiistrador)\n    nombre_admiistrador = nombre_admiistrador_limpio.strip()\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\n\nid_proveedor = {registro}[7]\nprint(id_proveedor)\nSetVar ('id_proveedor', id_proveedor)\n\nnombre_proveedor = {registro}[8]\nprint(nombre_proveedor)\nif nombre_proveedor is None:\n    SetVar ('nombre_proveedor', nombre_proveedor)\nelse:    \n    nombre_proveedor_limpio = patron.sub(' ', nombre_proveedor)\n    nombre_proveedor = nombre_proveedor_limpio.strip()\n    SetVar ('nombre_proveedor', nombre_proveedor)\n\nmoneda = {registro}[9]\nprint(moneda)\nif moneda is None:\n    SetVar ('moneda', moneda)\nelse:    \n    moneda_limpio = patron.sub(' ', moneda)\n    moneda = moneda_limpio.strip()\n    SetVar ('moneda', moneda)\n\nrut_ing_contratos = {registro}[10]\nprint(rut_ing_contratos)\nif rut_ing_contratos is None:\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\nelse:\n    rut_ing_contratos = rut_ing_contratos.strip()\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\n\nnombre_ing = {registro}[11]\nprint(nombre_ing)\nif nombre_ing is None:\n    SetVar ('nombre_ing', nombre_ing)\nelse:    \n    nombre_ing_limpio = patron.sub(' ', nombre_ing)\n    nombre_ing = nombre_ing_limpio.strip()\n    SetVar ('nombre_ing', nombre_ing)\n    \ningresado_por = {registro}[12]\nprint(ingresado_por)\ningresado_por = ingresado_por.strip()\nSetVar ('ingresado_por', ingresado_por)    \n\nfecha_inicio = {registro}[13]\nprint(fecha_inicio)\nfecha_inicio = fecha_inicio.strip()\nSetVar ('fecha_inicio', fecha_inicio)\n\nfecha_fin = {registro}[14]\nprint(fecha_fin)\nfecha_fin = fecha_fin.strip()\nSetVar ('fecha_fin', fecha_fin)\n\nmonto_original = {registro}[15]\nprint(monto_original)\nSetVar ('monto_original', monto_original)\n\nmodificaciones = {registro}[16]\nprint(modificaciones)\nSetVar ('modificaciones', modificaciones)\n\nmonto_total = {registro}[17]\nprint(monto_total)\nSetVar ('monto_total', monto_total)\n\npagos_real = {registro}[18]\nprint(pagos_real)\nSetVar ('pagos_real', pagos_real)\n\nsaldo_real = {registro}[19]\nprint(saldo_real)\nSetVar ('saldo_real', saldo_real)\n\nmonto_retenido = {registro}[20]\nprint(monto_retenido)\nSetVar ('monto_retenido', monto_retenido)\n\npagos_directos = {registro}[21]\nprint(pagos_directos)\nSetVar ('pagos_directos', pagos_directos)\n\ngasto_promedio = {registro}[22]\nprint(gasto_promedio)\nSetVar ('gasto_promedio', gasto_promedio)\n\nproyeccion_gasto = {registro}[23]\nprint(proyeccion_gasto)\nSetVar ('proyeccion_gasto', proyeccion_gasto)\n\nfaltante = {registro}[24]\nprint(faltante)\nSetVar ('faltante', faltante)\n\nmeses = {registro}[25]\nprint(meses)\nSetVar ('meses', meses)\n\nmeses_transcurridos = {registro}[26]\nprint(meses_transcurridos)\nSetVar ('meses_transcurridos', meses_transcurridos)\n\nestado = {registro}[27]\nprint(estado)\nestado = estado.strip()\nSetVar ('estado', estado)
2024-08-20 10:10:03.786930 - rocketbot - INFO - request: N-DataEllipse : line 30.3 - rpaconnect : request  id: 6b0e9df4-5f6f-3645-1d62-a8b260598cfe -  - {"method":"post","url":"{api_ellipse}","json":"{\n  \"gerencia\":\"{gerencia}\",\n  \"codigoCttoAnterior\":\"{contrato}\",\n  \"tipoContrato\":\"{tipo_contrato}\",\n  \"tipoAdjudicacion\":\"{tipo_adjudicacion}\",\n  \"descripcion\":\"{descripcion}\",\n  \"rutAdministrador\":\"{administrador}\",\n  \"nombreAdministrador\":\"{nombre_admiistrador}\",\n  \"codigoProvedor\":\"{id_proveedor}\",\n  \"nombreProveddor\":\"{nombre_proveedor}\",\n  \"moneda\":\"{moneda}\",\n  \"rutIngenieroContrato\":\"{rut_ing_contratos}\",\n  \"nombreIngenieroContrato\":\"{nombre_ing}\",\n  \"fechaInicioActualizada\":\"{fecha_inicio}\",\n  \"fechaTerminoActualizada\":\"{fecha_fin}\",\n  \"monto\":\"{monto_original}\",\n  \"modificacionesMonto\":\"{modificaciones}\",\n  \"montoTotal\":\"{monto_total}\",\n  \"pagosReal\":\"{pagos_real}\",\n  \"saldoReal\":\"{saldo_real}\",\n  \"montoRetenido\":\"{monto_retenido}\",\n  \"pagosDirectos\":\"{pagos_directos}\",\n  \"gastoPromedioActualReal\":\"{gasto_promedio}\",\n  \"proyeccionGastoActual\":\"{proyeccion_gasto}\",\n  \"faltante\":\"{faltante}\",\n  \"mesesCtto\":\"{meses}\",\n  \"mesesTranscurridos\":\"{meses_transcurridos}\",\n  \"estadoContrato\":\"{estado}\"\n}","params":"","form":"","proxy":"","file":"","header":"{\"X-Api-Key\":\"{api_key}\"}"}
2024-08-20 10:10:24.802899 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_108 ""): ConnectTimeout: HTTPConnectionPool(host='54.88.59.194', port=8081): Max retries exceeded with url: /api/v1.0/sourcings (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x0000020BF5394E80>, 'Connection to 54.88.59.194 timed out. (connect timeout=None)'))
2024-08-20 10:10:24.802899 - rocketbot - INFO - request: N-DataEllipse : line 30.4 - rpaxls : setcell  id: 556e681f-94f9-2ea4-3e17-58ad6db10c28 -  - AC:{contador}={conexion_api_ellipse}
2024-08-20 10:10:24.802899 - rocketbot - INFO - request: N-DataEllipse : line 30.5 - rpasystem : setVar  id: b7f818c2-7f7d-03b6-397f-1cdd17ba8494 -  - {contador} + 1
2024-08-20 10:10:24.818452 - rocketbot - INFO - request: N-DataEllipse : line 30 - rpalogic : for  id: 5720dce3-a8ff-73b1-9406-3fb4b37b5c13 -  - {"iterable":"{contenido_excel}","count":0}
2024-08-20 10:10:24.849719 - rocketbot - INFO - For count: 15
2024-08-20 10:10:24.849719 - rocketbot - INFO - request: N-DataEllipse : line 30.1 - rpascripts : module  id: 1ea0031b-e3c7-c0f7-c8a9-f9f16739d951 -  - {"module_name":"System++","module":"cleanVars","vars":"gerencia,contrato,tipo_contrato,tipo_adjudicacion,descripcion,administrador,nombre_admiistrador,id_proveedor,nombre_proveedor,moneda,rut_ing_contratos,nombre_ing,fecha_inicio,fecha_fin,monto_original,modificaciones,monto_total,pagos_real,saldo_real,monto_retenido,pagos_directos,gasto_promedio,proyeccion_gasto,faltante,meses,meses_transcurridos,estado,conexion_api_ellipse,ingresado_pro"}
2024-08-20 10:10:24.849719 - rocketbot - INFO - request: N-DataEllipse : line 30.2 - rpascripts : execscriptpython  id: 7486e36a-d129-2902-dd42-57fd2ecd3c65 -  - ########################################################################\n#  Script que realiza la asignacion de valores del registro campo por  #\n#  campo a las variables que se utilizaran en el JSON de la API para   #\n#  enviar los datos a Atomox, de cada variable quita los espacios en   #\n#  blanco al principio y al final y si encuentra caracteres especiales #\n#  los sustituye por espacios en blanco                                #\n########################################################################\n\nimport re\n\npatron = re.compile(r'[^a-zA-Z0-9\s]')\n\ngerencia = {registro}[0]\nprint(gerencia)\nif gerencia is None:\n    SetVar ('gerencia', gerencia)\nelse:\n    gerencia = gerencia.strip()\n    SetVar ('gerencia', gerencia)\n\ncontrato = {registro}[1]\nprint(contrato)\nif contrato is None:\n    SetVar ('contrato', contrato)\nelse:\n    contrato = contrato.strip()\n    SetVar ('contrato', contrato)\n\ntipo_contrato = {registro}[2]\nprint(tipo_contrato)\nif tipo_contrato is None:\n    SetVar ('tipo_contrato', tipo_contrato)\nelse:\n    tipo_contrato = tipo_contrato.strip()\n    SetVar ('tipo_contrato', tipo_contrato)\n\ntipo_adjudicacion = {registro}[3]\nprint(tipo_adjudicacion)\nif tipo_adjudicacion is None:\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\nelse:\n    tipo_adjudicacion = tipo_adjudicacion.strip()\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\n\ndescripcion = {registro}[4]\nprint(descripcion)\nif descripcion is None:\n    SetVar ('descripcion', descripcion)\nelse:\n    descripcion_limpio = patron.sub(' ', descripcion)\n    descripcion = descripcion_limpio.strip()\n    SetVar ('descripcion', descripcion)\n\nadministrador = {registro}[5]\nprint(administrador)\nif administrador is None:\n    SetVar ('administrador', administrador)\nelse:  \n    administrador = administrador.strip()\n    SetVar ('administrador', administrador)\n\nnombre_admiistrador = {registro}[6]\nprint(nombre_admiistrador)\nif nombre_admiistrador is None:\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\nelse:    \n    nombre_admiistrador_limpio = patron.sub(' ', nombre_admiistrador)\n    nombre_admiistrador = nombre_admiistrador_limpio.strip()\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\n\nid_proveedor = {registro}[7]\nprint(id_proveedor)\nSetVar ('id_proveedor', id_proveedor)\n\nnombre_proveedor = {registro}[8]\nprint(nombre_proveedor)\nif nombre_proveedor is None:\n    SetVar ('nombre_proveedor', nombre_proveedor)\nelse:    \n    nombre_proveedor_limpio = patron.sub(' ', nombre_proveedor)\n    nombre_proveedor = nombre_proveedor_limpio.strip()\n    SetVar ('nombre_proveedor', nombre_proveedor)\n\nmoneda = {registro}[9]\nprint(moneda)\nif moneda is None:\n    SetVar ('moneda', moneda)\nelse:    \n    moneda_limpio = patron.sub(' ', moneda)\n    moneda = moneda_limpio.strip()\n    SetVar ('moneda', moneda)\n\nrut_ing_contratos = {registro}[10]\nprint(rut_ing_contratos)\nif rut_ing_contratos is None:\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\nelse:\n    rut_ing_contratos = rut_ing_contratos.strip()\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\n\nnombre_ing = {registro}[11]\nprint(nombre_ing)\nif nombre_ing is None:\n    SetVar ('nombre_ing', nombre_ing)\nelse:    \n    nombre_ing_limpio = patron.sub(' ', nombre_ing)\n    nombre_ing = nombre_ing_limpio.strip()\n    SetVar ('nombre_ing', nombre_ing)\n    \ningresado_por = {registro}[12]\nprint(ingresado_por)\ningresado_por = ingresado_por.strip()\nSetVar ('ingresado_por', ingresado_por)    \n\nfecha_inicio = {registro}[13]\nprint(fecha_inicio)\nfecha_inicio = fecha_inicio.strip()\nSetVar ('fecha_inicio', fecha_inicio)\n\nfecha_fin = {registro}[14]\nprint(fecha_fin)\nfecha_fin = fecha_fin.strip()\nSetVar ('fecha_fin', fecha_fin)\n\nmonto_original = {registro}[15]\nprint(monto_original)\nSetVar ('monto_original', monto_original)\n\nmodificaciones = {registro}[16]\nprint(modificaciones)\nSetVar ('modificaciones', modificaciones)\n\nmonto_total = {registro}[17]\nprint(monto_total)\nSetVar ('monto_total', monto_total)\n\npagos_real = {registro}[18]\nprint(pagos_real)\nSetVar ('pagos_real', pagos_real)\n\nsaldo_real = {registro}[19]\nprint(saldo_real)\nSetVar ('saldo_real', saldo_real)\n\nmonto_retenido = {registro}[20]\nprint(monto_retenido)\nSetVar ('monto_retenido', monto_retenido)\n\npagos_directos = {registro}[21]\nprint(pagos_directos)\nSetVar ('pagos_directos', pagos_directos)\n\ngasto_promedio = {registro}[22]\nprint(gasto_promedio)\nSetVar ('gasto_promedio', gasto_promedio)\n\nproyeccion_gasto = {registro}[23]\nprint(proyeccion_gasto)\nSetVar ('proyeccion_gasto', proyeccion_gasto)\n\nfaltante = {registro}[24]\nprint(faltante)\nSetVar ('faltante', faltante)\n\nmeses = {registro}[25]\nprint(meses)\nSetVar ('meses', meses)\n\nmeses_transcurridos = {registro}[26]\nprint(meses_transcurridos)\nSetVar ('meses_transcurridos', meses_transcurridos)\n\nestado = {registro}[27]\nprint(estado)\nestado = estado.strip()\nSetVar ('estado', estado)
2024-08-20 10:10:24.912219 - rocketbot - INFO - request: N-DataEllipse : line 30.3 - rpaconnect : request  id: 6b0e9df4-5f6f-3645-1d62-a8b260598cfe -  - {"method":"post","url":"{api_ellipse}","json":"{\n  \"gerencia\":\"{gerencia}\",\n  \"codigoCttoAnterior\":\"{contrato}\",\n  \"tipoContrato\":\"{tipo_contrato}\",\n  \"tipoAdjudicacion\":\"{tipo_adjudicacion}\",\n  \"descripcion\":\"{descripcion}\",\n  \"rutAdministrador\":\"{administrador}\",\n  \"nombreAdministrador\":\"{nombre_admiistrador}\",\n  \"codigoProvedor\":\"{id_proveedor}\",\n  \"nombreProveddor\":\"{nombre_proveedor}\",\n  \"moneda\":\"{moneda}\",\n  \"rutIngenieroContrato\":\"{rut_ing_contratos}\",\n  \"nombreIngenieroContrato\":\"{nombre_ing}\",\n  \"fechaInicioActualizada\":\"{fecha_inicio}\",\n  \"fechaTerminoActualizada\":\"{fecha_fin}\",\n  \"monto\":\"{monto_original}\",\n  \"modificacionesMonto\":\"{modificaciones}\",\n  \"montoTotal\":\"{monto_total}\",\n  \"pagosReal\":\"{pagos_real}\",\n  \"saldoReal\":\"{saldo_real}\",\n  \"montoRetenido\":\"{monto_retenido}\",\n  \"pagosDirectos\":\"{pagos_directos}\",\n  \"gastoPromedioActualReal\":\"{gasto_promedio}\",\n  \"proyeccionGastoActual\":\"{proyeccion_gasto}\",\n  \"faltante\":\"{faltante}\",\n  \"mesesCtto\":\"{meses}\",\n  \"mesesTranscurridos\":\"{meses_transcurridos}\",\n  \"estadoContrato\":\"{estado}\"\n}","params":"","form":"","proxy":"","file":"","header":"{\"X-Api-Key\":\"{api_key}\"}"}
2024-08-20 10:10:45.959644 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_108 ""): ConnectTimeout: HTTPConnectionPool(host='54.88.59.194', port=8081): Max retries exceeded with url: /api/v1.0/sourcings (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x0000020BF30D89A0>, 'Connection to 54.88.59.194 timed out. (connect timeout=None)'))
2024-08-20 10:10:45.959644 - rocketbot - INFO - request: N-DataEllipse : line 30.4 - rpaxls : setcell  id: 556e681f-94f9-2ea4-3e17-58ad6db10c28 -  - AC:{contador}={conexion_api_ellipse}
2024-08-20 10:10:45.959644 - rocketbot - INFO - request: N-DataEllipse : line 30.5 - rpasystem : setVar  id: b7f818c2-7f7d-03b6-397f-1cdd17ba8494 -  - {contador} + 1
2024-08-20 10:10:45.959644 - rocketbot - INFO - request: N-DataEllipse : line 30 - rpalogic : for  id: 5720dce3-a8ff-73b1-9406-3fb4b37b5c13 -  - {"iterable":"{contenido_excel}","count":0}
2024-08-20 10:10:46.037696 - rocketbot - INFO - request: N-DataEllipse : line 30.3 - rpaconnect : request  id: 6b0e9df4-5f6f-3645-1d62-a8b260598cfe -  - {"method":"post","url":"{api_ellipse}","json":"{\n  \"gerencia\":\"{gerencia}\",\n  \"codigoCttoAnterior\":\"{contrato}\",\n  \"tipoContrato\":\"{tipo_contrato}\",\n  \"tipoAdjudicacion\":\"{tipo_adjudicacion}\",\n  \"descripcion\":\"{descripcion}\",\n  \"rutAdministrador\":\"{administrador}\",\n  \"nombreAdministrador\":\"{nombre_admiistrador}\",\n  \"codigoProvedor\":\"{id_proveedor}\",\n  \"nombreProveddor\":\"{nombre_proveedor}\",\n  \"moneda\":\"{moneda}\",\n  \"rutIngenieroContrato\":\"{rut_ing_contratos}\",\n  \"nombreIngenieroContrato\":\"{nombre_ing}\",\n  \"fechaInicioActualizada\":\"{fecha_inicio}\",\n  \"fechaTerminoActualizada\":\"{fecha_fin}\",\n  \"monto\":\"{monto_original}\",\n  \"modificacionesMonto\":\"{modificaciones}\",\n  \"montoTotal\":\"{monto_total}\",\n  \"pagosReal\":\"{pagos_real}\",\n  \"saldoReal\":\"{saldo_real}\",\n  \"montoRetenido\":\"{monto_retenido}\",\n  \"pagosDirectos\":\"{pagos_directos}\",\n  \"gastoPromedioActualReal\":\"{gasto_promedio}\",\n  \"proyeccionGastoActual\":\"{proyeccion_gasto}\",\n  \"faltante\":\"{faltante}\",\n  \"mesesCtto\":\"{meses}\",\n  \"mesesTranscurridos\":\"{meses_transcurridos}\",\n  \"estadoContrato\":\"{estado}\"\n}","params":"","form":"","proxy":"","file":"","header":"{\"X-Api-Key\":\"{api_key}\"}"}
