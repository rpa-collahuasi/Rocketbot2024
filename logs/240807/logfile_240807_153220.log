2024-08-07 17:51:52.875079 - rocketbot - INFO - request: P-SourcingPlan : line 1 - rpascripts : module  id: 8dfbcfd9-495e-7c66-5d18-49f451346c0d -  - {"module_name":"System++","module":"cleanVars","vars":"inidecript,client,secret,tenant,ruta_log,notificados,inicript,fecha_crea_log,fecha_log"}
2024-08-07 17:51:53.160506 - rocketbot - INFO - request: P-SourcingPlan : line 2 - rpascripts : module  id: 57fcc22c-a6ea-ee6a-c04b-182e13ed9f2d -  - {"module_name":"Encriptador","module":"desencriptarArchivo","content":"C:/SourcingPlan/Recursos/sourcingplank.key","fileEnc":"C:/SourcingPlan/config.ini","file":"C:/SourcingPlan","res":"inidecript","filename":"config"}
2024-08-07 17:51:53.240738 - rocketbot - INFO - request: P-SourcingPlan : line 3 - rpalogic : evaluateIf  id: 44fc765c-5af8-3e46-9865-aec95decd501 -  - {inidecript} == True
2024-08-07 17:51:53.491402 - rocketbot - INFO - request: P-SourcingPlan : line 3.1 - rpascripts : module  id: c204139c-03c9-52fa-a42f-8ba55961a0fb -  - {"module_name":"ControlIni","module":"leerIni","content":"C:/SourcingPlan/config.ini"}
2024-08-07 17:51:53.593141 - rocketbot - INFO - request: P-SourcingPlan : line 3.2 - rpascripts : module  id: 73ba0511-70e1-831a-2775-7056d7c5ec48 -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"COMUN","iddato":"ruta_log","idvar":"ruta_log"}
2024-08-07 17:51:53.811874 - rocketbot - INFO - request: P-SourcingPlan : line 3.3 - rpascripts : module  id: 48ef4e78-92cf-b54f-cf41-b4487f82fcbd -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"COMUN","iddato":"api_key","idvar":"api_key"}
2024-08-07 17:51:53.965907 - rocketbot - INFO - request: P-SourcingPlan : line 3.4 - rpascripts : module  id: 34e4b918-d345-bd79-1be5-ae9c34ce2072 -  - {"module_name":"Encriptador","module":"encriptarArchivo","content":"C:/SourcingPlan/Recursos/sourcingplank.key","file":"C:/SourcingPlan/config.ini","res":"inicript"}
2024-08-07 17:51:54.122033 - rocketbot - INFO - request: P-SourcingPlan : line 3.5 - rpalogic : evaluateIf  id: 7609d855-2c53-0c34-4821-d0b608458357 -  - {inicript} == True
2024-08-07 17:51:54.293699 - rocketbot - INFO - request: P-SourcingPlan : line 3.5.1 - rpasystem : setVar  id: 1e5b7eec-006f-d4a3-0e88-c690cf5e343d -  - datetime.now().strftime("%Y%m%d_%H%M%S")
2024-08-07 17:51:54.434319 - rocketbot - INFO - request: P-SourcingPlan : line 3.5.2 - rpasystem : setVar  id: 9fca0ae3-67c5-5452-65d7-3077b3d94db5 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 17:51:54.606306 - rocketbot - INFO - request: P-SourcingPlan : line 3.5.3 - rpafile : savedatafile  id: bfdfc534-78d2-a512-7cf1-a3473d3995bf -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":"","file_data":"{fecha_log} | Inicio del proceso principal de obtención de datos para Sourcing Plan"}
2024-08-07 17:51:54.747253 - rocketbot - INFO - request: P-SourcingPlan : line 3.5.4 - rpasystem : wait  id: 5b2945b4-3d86-3a24-aa19-8072bafcd3d4 -  - 6
2024-08-07 17:52:00.762506 - rocketbot - INFO - request: scripts : execRocketBotDB : line 3.5.5 - - N-InicioEllipse
2024-08-07 17:52:00.762506 - rocketbot - INFO - request: N-InicioEllipse : line 1 - rpascripts : module  id: 8dfbcfd9-495e-7c66-5d18-49f451346c0d -  - {"module_name":"System++","module":"cleanVars","vars":"inidecript_ellipse,url_ellipse,user_ellipse,descarga_ellipse,historico_ellipse,procesado_ellipse,api_ellipse,inicript_ellipse,sesion_ini"}
2024-08-07 17:52:00.778147 - rocketbot - INFO - request: N-InicioEllipse : line 2 - rpascripts : module  id: 57fcc22c-a6ea-ee6a-c04b-182e13ed9f2d -  - {"module_name":"Encriptador","module":"desencriptarArchivo","content":"C:/SourcingPlan/Recursos/sourcingplank.key","fileEnc":"C:/SourcingPlan/config.ini","file":"C:/SourcingPlan","res":"inidecript_ellipse","filename":"config"}
2024-08-07 17:52:00.778147 - rocketbot - INFO - request: N-InicioEllipse : line 3 - rpalogic : evaluateIf  id: 44fc765c-5af8-3e46-9865-aec95decd501 -  - {inidecript_ellipse} == True
2024-08-07 17:52:00.778147 - rocketbot - INFO - request: N-InicioEllipse : line 3.1 - rpasystem : setVar  id: 3e6a0900-86ad-5d22-f8e2-63ad23dd24dc -  - rocketbot.log("Desencriptación del archivo de configuración correcta", "info")
2024-08-07 17:52:00.778147 - rocketbot - INFO - Desencriptación del archivo de configuración correcta
2024-08-07 17:52:00.793771 - rocketbot - INFO - request: N-InicioEllipse : line 3.2 - rpascripts : module  id: c204139c-03c9-52fa-a42f-8ba55961a0fb -  - {"module_name":"ControlIni","module":"leerIni","content":"C:/SourcingPlan/config.ini"}
2024-08-07 17:52:00.793771 - rocketbot - INFO - request: N-InicioEllipse : line 3.3 - rpascripts : module  id: 59f60bc7-0ba0-37ae-b951-a99543b61334 -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"ELLIPSE","iddato":"url_ellipse","idvar":"url_ellipse"}
2024-08-07 17:52:00.793771 - rocketbot - INFO - request: N-InicioEllipse : line 3.4 - rpascripts : module  id: e5e6c163-ccb4-d653-5c3f-d8d050360989 -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"ELLIPSE","iddato":"user_ellipse","idvar":"user_ellipse"}
2024-08-07 17:52:00.793771 - rocketbot - INFO - request: N-InicioEllipse : line 3.5 - rpascripts : module  id: 8fb09fbc-08a6-d6e4-081f-382b3c3c9103 -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"ELLIPSE","iddato":"pass_elliipse","idvar":"pass_elliipse"}
2024-08-07 17:52:00.809407 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_74 ""): KeyError: 'pass_elliipse'
2024-08-07 17:52:00.809407 - script - ERROR - EXCEPTION IN (<string> script, L_133 ""): KeyError: 'pass_elliipse'
2024-08-07 17:52:00.809407 - rocketbot - INFO - request: N-InicioEllipse : line 3.6 - rpascripts : module  id: 73ba0511-70e1-831a-2775-7056d7c5ec48 -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"ELLIPSE","iddato":"descarga_ellipse","idvar":"descarga_ellipse"}
2024-08-07 17:52:00.809407 - rocketbot - INFO - request: N-InicioEllipse : line 3.7 - rpascripts : module  id: dcd344ac-5db0-1384-1c35-a4af8ce0bf1d -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"ELLIPSE","iddato":"historico_ellipse","idvar":"historico_ellipse"}
2024-08-07 17:52:00.825019 - rocketbot - INFO - request: N-InicioEllipse : line 3.8 - rpascripts : module  id: fbc0d596-b7db-2814-1f6f-4b34e1c25b4c -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"ELLIPSE","iddato":"procesado_ellipse","idvar":"procesado_ellipse"}
2024-08-07 17:52:00.825019 - rocketbot - INFO - request: N-InicioEllipse : line 3.9 - rpascripts : module  id: 969a5f7c-eb29-92ca-122c-882f27740051 -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"ELLIPSE","iddato":"api_ellipse","idvar":"api_ellipse"}
2024-08-07 17:52:00.825019 - rocketbot - INFO - request: N-InicioEllipse : line 3.10 - rpascripts : module  id: 34e4b918-d345-bd79-1be5-ae9c34ce2072 -  - {"module_name":"Encriptador","module":"encriptarArchivo","content":"C:/SourcingPlan/Recursos/sourcingplank.key","file":"C:/SourcingPlan/config.ini","res":"inicript_ellipse"}
2024-08-07 17:52:00.840692 - rocketbot - INFO - request: N-InicioEllipse : line 3.11 - rpalogic : evaluateIf  id: 7609d855-2c53-0c34-4821-d0b608458357 -  - {inicript_ellipse} == True
2024-08-07 17:52:00.840692 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.1 - rpasystem : setVar  id: efa0a8f0-ce56-7267-dce2-86111d9cda1d -  - rocketbot.log("Encriptación del archivo de configuración correcta", "info")
2024-08-07 17:52:00.840692 - rocketbot - INFO - Encriptación del archivo de configuración correcta
2024-08-07 17:52:00.840692 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.2 - rpasystem : setVar  id: 9fca0ae3-67c5-5452-65d7-3077b3d94db5 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 17:52:00.840692 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.3 - rpafile : savedatafile  id: bfdfc534-78d2-a512-7cf1-a3473d3995bf -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Inicio del proceso para la obtencion de datos de la plataforma Ellipse"}
2024-08-07 17:52:00.840692 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.4 - rpascripts : module  id: 20042ce3-c08b-4fd1-ed5d-888a7765f6d8 -  - {"module_name":"webpro","module":"open_browser","url_":"{url_ellipse}","download_path":"{descarga_ellipse}"}
2024-08-07 17:52:06.124026 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.6 - rpaweb : waitforobject  id: b1b136d5-e2e9-2a04-4594-25ab9d616be7 - xpath - {"object":"//*[@id=\"loginHeader\"]/div","wait_for":"present","wait_time":"10","before":"1","after":"1"}
2024-08-07 17:52:08.168838 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.7 - rpalogic : evaluateIf  id: e20d36f7-e002-876f-810e-972760d59f3e -  - {sesion_ini} == True
2024-08-07 17:52:08.168838 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.7.1 - rpaweb : clickWeb  id: bb57b073-0c4e-2ed9-114f-1653edaf093d - xpath - //*[@id="otherTileText"]
2024-08-07 17:52:08.184462 - rpaweb - ERROR - EXCEPTION IN (<string> rpaweb, L_1058 ""): NoSuchElementException: Message: no such element: Unable to locate element: {"method":"xpath","selector":"//*[@id="otherTileText"]"}\n  (Session info: chrome=127.0.6533.90)\nStacktrace:\n	GetHandleVerifier [0x00B08923+23283]\n	(No symbol) [0x00ACE934]\n	(No symbol) [0x00A00733]\n	(No symbol) [0x00A4326F]\n	(No symbol) [0x00A434AB]\n	(No symbol) [0x00A7EE42]\n	(No symbol) [0x00A64464]\n	(No symbol) [0x00A7CB8D]\n	(No symbol) [0x00A641B6]\n	(No symbol) [0x00A38017]\n	(No symbol) [0x00A3890D]\n	GetHandleVerifier [0x00BFA5E3+1013683]\n	GetHandleVerifier [0x00C03E3C+1052684]\n	GetHandleVerifier [0x00BFD4A4+1025652]\n	GetHandleVerifier [0x00B2EA2B+179195]\n	(No symbol) [0x00AD6833]\n	(No symbol) [0x00AD3198]\n	(No symbol) [0x00AD3337]\n	(No symbol) [0x00ACB4BE]\n	BaseThreadInitThunk [0x76E6FCC9+25]\n	RtlGetAppContainerNamedObjectPath [0x77AA7C6E+286]\n	RtlGetAppContainerNamedObjectPath [0x77AA7C3E+238]\n
2024-08-07 17:52:10.231283 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.9 - rpaweb : clickWeb  id: 0a757e02-85f5-14fb-72cc-d67b73b32fe5 - xpath - //*[@id="i0116"]
2024-08-07 17:52:10.316320 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.10 - rpaweb : sendKeyWeb  id: 640dba71-aa33-9fcb-474a-9d76bb59614f -  - {user_ellipse}
2024-08-07 17:52:10.448300 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.11 - rpaweb : waitforobject  id: fbe068fb-9cc6-9207-9d7d-8043c6499470 - xpath - {"object":"//*[@id=\"idSIButton9\"]","wait_for":"present","wait_time":"40","before":"1","after":"1"}
2024-08-07 17:52:12.497154 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.12 - rpaweb : clickWeb  id: b20e3cf8-c618-003d-c8d2-443425de361b - xpath - //*[@id="idSIButton9"]
2024-08-07 17:52:12.587918 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.13 - rpaweb : waitforobject  id: a240429e-e5af-20a5-1ec9-03fe86620b40 - xpath - {"object":"//*[@id=\"i0118\"]","wait_for":"present","wait_time":"20","before":"1","after":"1"}
2024-08-07 17:52:14.637609 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.14 - rpaweb : clickWeb  id: 01ec1cd7-427c-e7bf-12e2-ad04dd73a00b - xpath - //*[@id="i0118"]
2024-08-07 17:52:14.719178 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.15 - rpaweb : sendKeyWeb  id: e46583a8-ce66-4d8c-44ec-92dbdb641c54 -  - {contrasena}
2024-08-07 17:52:14.783519 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.16 - rpaweb : waitforobject  id: 20e6118a-d4f4-f3d4-58d4-4a2c9c93d402 - xpath - {"object":"//*[@id=\"idSIButton9\"]","wait_for":"present","wait_time":"40","before":"1","after":"1"}
2024-08-07 17:52:16.825117 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.17 - rpaweb : clickWeb  id: 1ca8655a-0836-a981-8467-0a6f0662030d - xpath - //*[@id="idSIButton9"]
2024-08-07 17:52:18.158599 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.18 - rpasystem : setVar  id: f494ad13-b2a5-1f7b-6e24-1f7fa684b7d8 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 17:52:18.164765 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.19 - rpafile : savedatafile  id: 333252b0-cf8a-daa0-aa51-fa14027ee386 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Se inicio correctamente sesión en la plataforma Ellipse"}
2024-08-07 17:52:18.167767 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.20 - rpasystem : wait  id: 64c7d7be-de50-1b83-9957-40e2578d880d -  - 6
2024-08-07 17:52:24.184522 - rocketbot - INFO - request: scripts : execRocketBotDB : line 3.11.21 - - N-DescargaEllipse
2024-08-07 17:52:24.184522 - rocketbot - INFO - request: N-DescargaEllipse : line 1 - rpascripts : module  id: 880b5342-e1a3-f401-5bf8-6cfdfbd25117 -  - {"module_name":"System++","module":"cleanVars","vars":"pagina_principal,job_submitted,cierre_sesion"}
2024-08-07 17:52:24.184522 - rocketbot - INFO - request: N-DescargaEllipse : line 2 - rpaweb : waitforobject  id: 3db21567-62c9-2f4f-c890-d1030dfce379 - xpath - {"object":"//*[@id=\"homeTabWrapper\"]/div/div/div/div/div/div/div[1]/div/div[2]/div/div/div/div/div/div[2]/div/div/div/div/div/div/div[2]/div/div/div[1]/div/div/div[2]/div/div/div[1]/div","wait_for":"present","wait_time":"40","before":"1","after":"1"}
2024-08-07 17:52:26.231454 - rocketbot - INFO - request: N-DescargaEllipse : line 3 - rpalogic : evaluateIf  id: 125025ac-77ba-84fb-b767-251d1478cd8a -  - {pagina_principal} == True
2024-08-07 17:52:26.231454 - rocketbot - INFO - request: N-DescargaEllipse : line 3.1 - rpasystem : setVar  id: 1f05941a-147b-b697-b324-25567cc9321f -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 17:52:26.231454 - rocketbot - INFO - request: N-DescargaEllipse : line 3.2 - rpafile : savedatafile  id: 65bc69c7-5ab6-1dea-8752-901e2f9bb768 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Se cargo correctamente la página principal de la plataforma Ellipse"}
2024-08-07 17:52:26.231454 - rocketbot - INFO - request: N-DescargaEllipse : line 3.3 - rpaweb : clickWeb  id: dd78d339-2da8-bb50-c991-5c2c74edbc3a - xpath - //*[@id="quicklaunch"]
2024-08-07 17:52:26.339756 - rocketbot - INFO - request: N-DescargaEllipse : line 3.4 - rpascripts : module  id: 5629dfa9-ee84-086b-1e57-dbf2dd5c1e0c -  - {"module_name":"webpro","module":"CleanInputs","texto":"COJ38KA","search_data":"//*[@id=\"quicklaunch\"]","tipo":"xpath"}
2024-08-07 17:52:26.477984 - rocketbot - INFO - request: N-DescargaEllipse : line 3.5 - rpaweb : clickWeb  id: 29d696e0-5780-9c56-08d7-b3f89a09165d - xpath - //*[@id="quicklaunch"]
2024-08-07 17:52:26.541734 - rocketbot - INFO - request: N-DescargaEllipse : line 3.6 - rpaweb : sendKeyWeb  id: e5b8fe59-474a-0ea5-b4e4-57a3297f8f09 - ENTER - 
2024-08-07 17:52:26.613591 - rocketbot - INFO - request: N-DescargaEllipse : line 3.7 - rpaweb : waitforobject  id: a14849de-79fb-99a2-a0b8-b2ef884e41d2 - xpath - {"object":"//*[@id=\"MEDIUM2I_10\"]/div/div[1]/div/input","wait_for":"present","wait_time":"40","before":"1","after":"1"}
2024-08-07 17:52:28.668972 - rocketbot - INFO - request: N-DescargaEllipse : line 3.8 - rpasystem : wait  id: d71e8e72-bf7e-9c45-28df-9a1878b3bdcf -  - 2
2024-08-07 17:52:30.669028 - rocketbot - INFO - request: N-DescargaEllipse : line 3.9 - rpascripts : module  id: cf310e92-35fa-e647-74c2-b2ddf78ebdf7 -  - {"module_name":"webpro","module":"CleanInputs","texto":"R","tipo":"xpath","search_data":"//*[@id=\"MEDIUM2I_10\"]/div/div[1]/div/input","sleep_":true}
2024-08-07 17:52:31.837502 - rocketbot - INFO - request: N-DescargaEllipse : line 3.10 - rpasystem : wait  id: a4098eba-acf7-06ca-4775-792a41ec0a1d -  - 1
2024-08-07 17:52:32.860369 - rocketbot - INFO - request: N-DescargaEllipse : line 3.11 - rpaweb : sendKeyWeb  id: fc976a4a-53c5-1c37-5cab-0d6c59ac3d4f - TAB - 
2024-08-07 17:52:33.028916 - rocketbot - INFO - request: N-DescargaEllipse : line 3.13 - rpascripts : module  id: e93f5fbd-5ad5-703c-b63a-f8c2b882a371 -  - {"module_name":"webpro","module":"CleanInputs","texto":"XLSX","tipo":"xpath","search_data":"//*[@id=\"PUB_TYPE2I_20\"]/div/div/div/input","sleep_":true}
2024-08-07 17:52:34.195785 - rocketbot - INFO - request: N-DescargaEllipse : line 3.14 - rpasystem : wait  id: db6fc047-6a08-4029-599c-498b8e70f3ff -  - 1
2024-08-07 17:52:35.202477 - rocketbot - INFO - request: N-DescargaEllipse : line 3.15 - rpascripts : module  id: 6da6f22a-ddb3-824d-f631-723ddf30ac0e -  - {"module_name":"webpro","module":"CleanInputs","texto":"Y","tipo":"xpath","search_data":"//*[@id=\"SUBMIT_FLG2I_16\"]/div/div[1]/div/input","sleep_":true}
2024-08-07 17:52:36.356289 - rocketbot - INFO - request: N-DescargaEllipse : line 3.16 - rpasystem : wait  id: 8db6c9ee-d715-a865-634a-8945319ba33f -  - 1
2024-08-07 17:52:37.377258 - rocketbot - INFO - request: N-DescargaEllipse : line 3.17 - rpascripts : module  id: b8534163-c492-6ff3-db44-20abe3caf7d9 -  - {"module_name":"webpro","module":"sendkeys","special":"ENTER"}
2024-08-07 17:52:37.413318 - rocketbot - INFO - request: N-DescargaEllipse : line 3.18 - rpasystem : wait  id: e3acc446-a14e-646c-f795-16b297250f51 -  - 4
2024-08-07 17:52:41.419318 - rocketbot - INFO - request: N-DescargaEllipse : line 3.19 - rpaweb : waitforobject  id: 94db4b46-dae0-1780-f1b4-3fcd762cb4f7 - xpath - {"object":"//*[@id=\"applications\"]/div[2]/div/div/div/div[2]/div/div[2]/div/div[1]/input","wait_for":"present","wait_time":"40","before":"1","after":"1"}
2024-08-07 17:52:43.450759 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20 - rpalogic : evaluateIf  id: 5a946294-18b2-a416-ef15-69f53a024964 -  - {job_submitted} == True
2024-08-07 17:52:43.450759 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.1 - rpasystem : setVar  id: cf5dd07b-6339-4732-0466-5b6c308b70ed -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 17:52:43.450759 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.2 - rpafile : savedatafile  id: 9cc2c7cb-7272-f565-093d-c36db850114c -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Se genero la solicitud del Maestro de Contratos de manera exitosa"}
2024-08-07 17:52:43.450759 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.3 - rpascripts : module  id: 98720551-0932-952b-d4ad-ec53c1fb58ec -  - {"module_name":"webpro","module":"CleanInputs","texto":"MSE083","tipo":"xpath","search_data":"//*[@id=\"quicklaunch\"]","sleep_":true}
2024-08-07 17:52:44.649623 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.4 - rpasystem : wait  id: 38952641-18eb-0eb7-0407-169408274cc4 -  - 1
2024-08-07 17:52:45.666646 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.5 - rpascripts : module  id: 180be5af-502a-4a38-f4c9-48e59c45d383 -  - {"module_name":"webpro","module":"sendkeys","special":"ENTER"}
2024-08-07 17:52:45.705060 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.6 - rpasystem : wait  id: 26b1b816-62f2-3f09-587d-b7df27717b54 -  - 1
2024-08-07 17:52:46.716322 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.7 - rpaweb : switchToWindow  id: 856f6c5a-a562-d096-775b-df7951ed44aa - last - 
2024-08-07 17:52:46.731870 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.8 - rpaweb : waitforobject  id: 054fa71e-8bad-bdd6-f800-3bbde2c6b47b - xpath - {"object":"//*[@id=\"progName\"]/div/div[1]/div/input","wait_for":"present","wait_time":"40","before":"1","after":"1"}
2024-08-07 17:52:48.778513 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.9 - rpasystem : setVar  id: ac2f6005-1abb-6856-46ec-4fcb670943d5 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 17:52:48.783859 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.10 - rpafile : savedatafile  id: 36498109-9993-b6ad-7cf5-336d6a4cc85c -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Inicio consulta solicitud del Maestro de Contratos con transacción MSE083"}
2024-08-07 17:52:48.790682 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.11 - rpascripts : module  id: 2e32023d-49b9-2c4f-3f50-028521e9ba2f -  - {"module_name":"webpro","module":"CleanInputs","texto":"COJ38K","tipo":"xpath","search_data":"//*[@id=\"progName\"]/div/div[1]/div/input","sleep_":true}
2024-08-07 17:52:49.930708 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.12 - rpasystem : wait  id: 5930597e-7f19-b4a1-fd5b-10c61c4280eb -  - 1
2024-08-07 17:52:50.938010 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.13 - rpascripts : module  id: 480bb5ec-1688-ec2e-c869-f7b1fad3a8cf -  - {"module_name":"webpro","module":"sendkeys","special":"ENTER"}
2024-08-07 17:52:50.974862 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.14 - rpasystem : setVar  id: 214ac19b-c5d5-72fd-0170-3073ddf4a72d -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 17:52:50.979256 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.15 - rpafile : savedatafile  id: 28322aaf-0381-133e-d515-237f187dd807 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Se realizo correctamente la consulta la con transacción MSE083"}
2024-08-07 17:52:50.983782 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.16 - rpasystem : setVar  id: 59d42f92-9361-e28b-bb4b-daa9b0622939 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 17:52:50.986809 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.17 - rpafile : savedatafile  id: cf2002ec-3c9f-fc72-dc08-497891176fc5 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Se realiza espera de 7 minutos para que el Maestro de Contratos esté disponible para su descarga"}
2024-08-07 17:52:50.991813 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.18 - rpasystem : wait  id: b29f266a-4a54-2da6-1c0f-2432aa1cccd8 -  - 420
2024-08-07 17:59:51.005213 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.19 - rpascripts : module  id: 71ad385b-283e-1d52-1b3c-cf3b4520904b -  - {"module_name":"webpro","module":"CleanInputs","texto":"MSE086","tipo":"xpath","search_data":"//*[@id=\"quicklaunch\"]","sleep_":true}
2024-08-07 17:59:52.185587 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.20 - rpasystem : wait  id: 6549e48a-3e27-565f-0430-80e818f53e3d -  - 1
2024-08-07 17:59:53.193772 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.21 - rpascripts : module  id: 62b16822-22f0-9b14-02a9-11c45c59cbf4 -  - {"module_name":"webpro","module":"sendkeys","special":"ENTER"}
2024-08-07 17:59:53.253983 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.22 - rpasystem : wait  id: 071a5a38-ff94-3dea-37cd-72bfae5afee2 -  - 3
2024-08-07 17:59:56.255614 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.23 - rpaweb : switchToWindow  id: b066920c-112c-abc9-5362-bc4abbce76a5 - last - 
2024-08-07 17:59:56.280327 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.24 - rpaweb : waitforobject  id: 4e803765-0aa1-70d0-5cff-381f8a7daec0 - xpath - {"object":"//*[@id=\"reportId\"]/div/div[1]/div/input","wait_for":"present","wait_time":"40","before":"1","after":"1"}
2024-08-07 17:59:58.317993 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.25 - rpasystem : setVar  id: 2ca25a60-f8b7-4cc2-955c-4efd59c09d51 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 17:59:58.317993 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.26 - rpafile : savedatafile  id: 2cca3f6a-1fce-d6b3-95a1-16c836523cbe -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Inicio consulta estado para descarga del Maestro de Contratos con transacción MSE086"}
2024-08-07 17:59:58.317993 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.27 - rpascripts : module  id: a956c9c0-b4b2-1748-64b9-5fabf5aa526c -  - {"module_name":"webpro","module":"CleanInputs","texto":"COJ38K","tipo":"xpath","search_data":"//*[@id=\"reportId\"]/div/div[1]/div/input","sleep_":true}
2024-08-07 17:59:59.473361 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.28 - rpasystem : wait  id: dc05b90f-38d2-fae4-b011-84b86e706576 -  - 1
2024-08-07 18:00:00.492258 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.29 - rpascripts : module  id: 82e9d455-d496-b264-1075-370ab325e589 -  - {"module_name":"webpro","module":"sendkeys","special":"ENTER"}
2024-08-07 18:00:00.525195 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.30 - rpasystem : setVar  id: 01ef030a-ad2f-df42-87a0-66a60f5d85ed -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 18:00:00.532002 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.31 - rpafile : savedatafile  id: fb70cc9f-7127-535e-db85-78a55b13ad09 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Se realizo correctamenet consulta estado para descarga del Maestro de Contratos con transacción MSE086"}
2024-08-07 18:00:00.536274 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.32 - rpasystem : wait  id: 50aad0b0-683d-4a70-f94c-b7f4db5b5836 -  - 6
2024-08-07 18:00:06.552377 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.33 - rpasystem : setVar  id: af363a72-1936-b53f-f176-6071de553a44 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 18:00:06.552377 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.34 - rpafile : savedatafile  id: 5536546c-d3e2-185f-4fc3-a5a0ec606711 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Iniciando descarga del Maestro de Contratos"}
2024-08-07 18:00:06.552377 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.35 - rpaweb : clickWeb  id: d387c5dd-b5db-981e-147f-43a737f67266 - xpath - //*[@id="groupResults"]/div[3]/table/tbody/tr[1]/td[3]/div
2024-08-07 18:00:06.678598 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.36 - rpasystem : wait  id: bdf2c7a0-0844-d609-9621-db85e58d5d92 -  - 6
2024-08-07 18:00:12.693116 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.37 - rpasystem : setVar  id: e0b32b2e-6845-9fb3-bc42-99d8e46183c9 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 18:00:12.693116 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.38 - rpafile : savedatafile  id: 70986ecf-3839-fb26-1709-2ab970adb555 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Descarga realizada correctamente en la carpeta  {descarga_ellipse}"}
2024-08-07 18:00:12.693116 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.39 - rpaweb : closewindow  id: c5fae063-bc81-ae36-b193-3eb70739d0be - last - 
2024-08-07 18:00:13.787285 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.40 - rpasystem : wait  id: 9b8c0a6b-77d0-05d3-4a9b-78dc3f5bcbb2 -  - 2
2024-08-07 18:00:15.802501 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.41 - rpaweb : closewindow  id: 4f112b2c-bd8c-a039-9c78-4677cc113294 - last - 
2024-08-07 18:00:16.880637 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.42 - rpasystem : wait  id: d8597c42-1d4b-7b50-22e4-b1f08067d860 -  - 2
2024-08-07 18:00:18.880721 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.43 - rpaweb : clickWeb  id: 94b51f05-2d1c-8e35-67f3-74dd954140f4 - xpath - //*[@id="userOption"]/span
2024-08-07 18:00:18.967588 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.44 - rpasystem : wait  id: 531eda85-95bb-2ba3-11d2-168e0debc1e2 -  - 1
2024-08-07 18:00:19.974427 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.45 - rpaweb : clickWeb  id: f6caf989-344c-790f-6909-3686ab89ac4f - xpath - //*[@id="htmlui-1207052417-overlays"]/div[2]/div/div/span[2]
2024-08-07 18:00:20.052222 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.46 - rpasystem : wait  id: ff3b7143-7ab5-be68-56f6-ab3a01f01ec3 -  - 1
2024-08-07 18:00:21.058217 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.47 - rpascripts : module  id: 84f5a49f-0c64-e9ba-4837-28eede20c244 -  - {"module_name":"webpro","module":"clickPro","data":"/html/body/div[2]/div[3]/div/div/div[3]/div/div/div[1]/div/span[1]/span","data_type":"xpath"}
2024-08-07 18:00:21.405191 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.48 - rpaweb : waitforobject  id: 47fbfbb0-e00e-59ee-d320-e8406ddd7cd7 - xpath - {"object":"//*[@id=\"login_workload_logo_text\"]","wait_for":"present","wait_time":"40","before":"1","after":"1"}
2024-08-07 18:00:23.443601 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.49 - rpasystem : setVar  id: fa39ac6d-0f84-651d-9efd-9aa2a96cf57b -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 18:00:23.443601 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.50 - rpafile : savedatafile  id: 533693b2-f81d-d2dc-c8eb-d0a81a12e3d0 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Se cerro sesión correctamente en la plataforma Ellipse"}
2024-08-07 18:00:23.443601 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.51 - rpaweb : killdriver  id: dbcd61f0-65b1-63bc-d227-2dd756839108 -  - 
2024-08-07 18:00:26.037240 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.52 - rpasystem : setVar  id: 26232f67-c8f1-3dd5-cef9-c4f4281060c2 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 18:00:26.037240 - rocketbot - INFO - request: N-DescargaEllipse : line 3.20.53 - rpafile : savedatafile  id: 78f6b061-305c-82d7-f9ed-7a1a94cce4d2 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Se cerro el navegador correctamente"}
2024-08-07 18:00:26.037240 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.22 - rpasystem : setVar  id: d22521b8-90ba-dc8d-8d9c-1f69b1a562fc -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 18:00:26.052817 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.23 - rpafile : savedatafile  id: 067c5723-5eff-9745-f1e1-347c45189afa -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Inicio del proceso de tratamiento de la Data obtenida del Maestro de Contratos"}
2024-08-07 18:00:26.052817 - rocketbot - INFO - request: N-InicioEllipse : line 3.11.24 - rpasystem : wait  id: 5b93fa3b-e069-3449-4946-d90485d56533 -  - 6
2024-08-07 18:00:32.052937 - rocketbot - INFO - request: scripts : execRocketBotDB : line 3.11.25 - - N-DataEllipse
2024-08-07 18:00:32.068679 - rocketbot - INFO - request: N-DataEllipse : line 1 - rpascripts : module  id: fcabc871-7f87-bd22-4c1d-35837a88eccf -  - {"module_name":"System++","module":"cleanVars","vars":"ult_descarga_ellipse,arch_histo_generado_ellipse,ultimo_archivo_historico_ellipse,arch_fil_proceso_ellipse,ultimo_archivo_procesado_ellipse,numero_filas,contenido_excel,registro,contador"}
2024-08-07 18:00:32.068679 - rocketbot - INFO - request: N-DataEllipse : line 2 - rpascripts : execscriptpython  id: 10ac3b98-605e-8c89-8e2c-fd97833693d5 -  - ########################################################################\n#  Script para obtener el ultimo archivo descargado del Maestro de     #\n#  contratos                                                           # \n########################################################################\n\nimport os\n\ncarpeta = GetVar('descarga_ellipse')\n\nlista_archivos = []\nfor archivo in os.listdir(carpeta):\n    ruta_absoluta = os.path.join(carpeta, archivo)\n    if os.path.isfile(ruta_absoluta):\n        lista_archivos.append(archivo)\n\nif not lista_archivos:\n    print("La carpeta no contiene archivos.")\nelse:\n    archivos_modificados = []\n    for archivo in lista_archivos:\n        ruta_absoluta = os.path.join(carpeta, archivo)\n        fecha_modificacion = os.path.getmtime(ruta_absoluta)\n        archivos_modificados.append((archivo, fecha_modificacion))\n\n    ultimo_archivo_modificado = max(archivos_modificados, key=lambda x: x[1])[0]\n    print("El último archivo modificado en la carpeta es:", ultimo_archivo_modificado)\n    SetVar('ult_descarga_ellipse', ultimo_archivo_modificado) 
2024-08-07 18:00:32.068679 - rocketbot - INFO - request: N-DataEllipse : line 3 - rpasystem : wait  id: 3cbec6dc-83b9-bd37-d9c4-7771397639c9 -  - 2
2024-08-07 18:00:34.099798 - rocketbot - INFO - request: N-DataEllipse : line 4 - rpasystem : setVar  id: 9cb9783f-2110-f617-6fdf-b83342281565 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 18:00:34.099798 - rocketbot - INFO - request: N-DataEllipse : line 5 - rpafile : savedatafile  id: ee982905-aa98-6a50-b3cb-5053fb1aace5 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Inicio del proceso de preparación de la Data obtenida del Maestro de Contratos"}
2024-08-07 18:00:34.099798 - rocketbot - INFO - request: N-DataEllipse : line 6 - rpascripts : execscriptpython  id: a193e97a-a323-09fa-4b5f-bb6cbd81c64f -  - ########################################################################\n#  Script que realiza el ordenado de la Data obtenida del Maestro de   #\n#  Contratos en una nueva hoja llamada "Data RPA" para posterior       # \n#  procesamiento con la API y guarda el archivo con fecha de ejecucion #\n#  como historico                                                      # \n########################################################################\n\nfrom openpyxl import load_workbook, Workbook\nfrom openpyxl.utils.cell import get_column_letter\nfrom openpyxl.styles import PatternFill\nfrom datetime import datetime\nimport os\n\nruta = GetVar('descarga_ellipse')\nnom_arch = GetVar('ult_descarga_ellipse')\nruta_fin = GetVar('historico_ellipse')\n\nfile_path = ruta + '/' + nom_arch\nworkbook = load_workbook(file_path)\nsheet = workbook['COJ38K']\n\nstart_column_index = 1\nstart_row_index = 4\nend_column_index = 72\nend_row_index = sheet.max_row\n\nnew_sheet = workbook.create_sheet(title='Data RPA')\n\nfor row in sheet.iter_rows(min_row=start_row_index, max_row=end_row_index, min_col=start_column_index, max_col=end_column_index):\n    for cell in row:\n        new_sheet[get_column_letter(cell.column) + str(cell.row)].value = cell.value\n\nnew_sheet.delete_rows(1, 3)\n\n#new_sheet.delete_cols(1)\n\nsheet = workbook['Data RPA']\n\ncolumnas_a_eliminar = ['F', 'G' ,'H' ,'M','T','U','V','W','AH','AI','AJ','AK','AL','AM','AN','AO','AP','AQ','AT','AU','AW','AX','AY','AZ','BA','BB','BC','BD','BE','BF','BG','BH','BI','BJ','BK','BL','BM','BN','BO','BP','BQ','BR','BS','BT','BU']\n\nfor columna in reversed(columnas_a_eliminar):\n    columna_idx = sheet[columna]\n    columna_num = columna_idx[0].column\n    sheet.delete_cols(columna_num)\n\nstart_cell = 'A1'\nend_cell = 'AB1'\n\nfill = PatternFill(start_color='5DADE2', end_color='5DADE2', fill_type='solid')\n\n\nfor row in sheet[start_cell:end_cell]:\n    for cell in row:\n        cell.fill = fill\n\nfecha_actual = datetime.now()\n\nfecha = fecha_actual.strftime('%Y-%m-%d-%H-%M')\n\nnom_sin_ext = os.path.splitext(nom_arch)[0]\n\nworkbook.save(ruta_fin + '/' + nom_sin_ext + '_' + fecha + '.xlsx')\n\narch_histo_generado_ellipse = ruta_fin + '/' + nom_sin_ext + '_' + fecha + '.xlsx'\n\nSetVar('arch_histo_generado_ellipse', arch_histo_generado_ellipse)\n
2024-08-07 18:01:09.834792 - rocketbot - INFO - request: N-DataEllipse : line 7 - rpasystem : setVar  id: 4b8d9752-6d81-3017-38d5-230861f489c5 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 18:01:09.850469 - rocketbot - INFO - request: N-DataEllipse : line 8 - rpafile : savedatafile  id: e0812a93-7be7-acef-3753-39c75bb8be7e -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Data preparada en: {arch_histo_generado_ellipse}"}
2024-08-07 18:01:09.850469 - rocketbot - INFO - request: N-DataEllipse : line 9 - rpasystem : wait  id: 1b0a0fff-7194-27f5-e1fc-b8feeff51c41 -  - 2
2024-08-07 18:01:11.850524 - rocketbot - INFO - request: N-DataEllipse : line 10 - rpasystem : setVar  id: 6e02ef14-417b-04a6-5ef8-f772e2ff5e25 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 18:01:11.850524 - rocketbot - INFO - request: N-DataEllipse : line 11 - rpafile : savedatafile  id: 4a9c5bc2-f3c6-e474-e43f-ddc5496ef5a6 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Filtrando la Data del Maestro de Contratos con las reglas especificadas"}
2024-08-07 18:01:11.850524 - rocketbot - INFO - request: N-DataEllipse : line 12 - rpascripts : execscriptpython  id: 91e58709-40b4-f235-142a-196074ffd326 -  - ########################################################################\n#  Script para obtener el ultimo archivo historico generado del        #\n#  Maestro de Contratos                                                # \n########################################################################\n\nimport os\n\ncarpeta = GetVar('historico_ellipse')\n\nlista_archivos = []\nfor archivo in os.listdir(carpeta):\n    ruta_absoluta = os.path.join(carpeta, archivo)\n    if os.path.isfile(ruta_absoluta):\n        lista_archivos.append(archivo)\n\nif not lista_archivos:\n    print("La carpeta no contiene archivos.")\nelse:\n    archivos_modificados = []\n    for archivo in lista_archivos:\n        ruta_absoluta = os.path.join(carpeta, archivo)\n        fecha_modificacion = os.path.getmtime(ruta_absoluta)\n        archivos_modificados.append((archivo, fecha_modificacion))\n\n    ultimo_archivo_historico_ellipse = max(archivos_modificados, key=lambda x: x[1])[0]\n    print("El último archivo modificado en la carpeta es:", ultimo_archivo_historico_ellipse)\n    SetVar('ultimo_archivo_historico_ellipse', ultimo_archivo_historico_ellipse) 
2024-08-07 18:01:11.850524 - rocketbot - INFO - request: N-DataEllipse : line 13 - rpasystem : wait  id: 70912fce-b882-e80e-eb4c-c872354718d0 -  - 2
2024-08-07 18:01:13.850724 - rocketbot - INFO - request: N-DataEllipse : line 15 - rpasystem : log_message  id: 3ae761a8-392c-b18e-7ae3-63b5b97e2aa0 - warn - Antes del Error
2024-08-07 18:01:13.850724 - robot_message - WARN - Antes del Error
2024-08-07 18:01:13.850724 - rocketbot - INFO - request: N-DataEllipse : line 16 - rpascripts : execscriptpython  id: 1fb8235f-110f-e263-450f-7e9029a0b775 -  - ########################################################################\n#  Script que realiza el filtrado de la informacion obtenida           #\n#  utilizando como origen el ultimo archivo procesado de la carpeta    # \n#  Historico segun los criterios establecidos y una vez filtrada la    #\n#  informacion almacena el archivo en la carpeta Procesados            # \n########################################################################\n\nimport pandas as pd\n\nfrom openpyxl import load_workbook, Workbook\nfrom openpyxl.utils.cell import get_column_letter\nfrom openpyxl.styles import PatternFill\nfrom datetime import datetime\n\nruta_origen = GetVar('historico_ellipse')\nnombre_archivo = GetVar('ultimo_archivo_historico_ellipse')\nruta_fin = GetVar('procesado_ellipse')\n\nindice_ultimo_punto = nombre_archivo.rfind(".")\n\nif indice_ultimo_punto != -1 and indice_ultimo_punto != 0:\n    nombre_base = nombre_archivo[:indice_ultimo_punto]\nelse:\n    nombre_base = nombre_archivo\n\ndf = pd.read_excel(ruta_origen + '/' + nombre_archivo, sheet_name='Data RPA', engine='openpyxl')\n\ndf = df[df['Estado Contrato'].apply(lambda x: any(palabra in x for palabra in ['CTTO EN CONFECCION', 'CTTO EN FIRMA CMDIC', 'CTTO EN FIRMA ESED', 'CTTO EN VB ING CTTO', 'CTTO FIRMADO']))]\n\ndf = df[~df['Contrato'].apply(lambda x: any(x.startswith(letra) for letra in ['CW', 'C20', 'PRC', 'PRI']))]\n\npalabra_a_excluir = 'VP Proyectos'\n\ndf['Gerencia'] = df['Gerencia'].str.replace(r'VP Proyectos\s+', 'VP Proyectos', regex=True)\n\nfilas_seleccionadas = []\n\nfor index, row in df.iterrows():\n    gerencia = row['Gerencia']\n    #if pd.isna(gerencia) and gerencia != palabra_a_excluir:\n    if gerencia != palabra_a_excluir:  \n        filas_seleccionadas.append(row)\n\ndf = pd.DataFrame(filas_seleccionadas)\n\n#fecha_actual = datetime.now()\n\n#fecha = fecha_actual.strftime('%Y-%m-%d')\n\ndf.to_excel(ruta_fin + '/' + nombre_base + '_Filtrado.xlsx', sheet_name='Data RPA', index=False)\n                   \nworkbook = load_workbook(ruta_fin + '/' + nombre_base + '_Filtrado.xlsx')\n                   \nsheet = workbook['Data RPA']\n\nstart_cell = 'A1'\nend_cell = 'AB1'\n\nfill = PatternFill(start_color='5DADE2', end_color='5DADE2', fill_type='solid')\n\nfor row in sheet[start_cell:end_cell]:\n    for cell in row:\n        cell.fill = fill\n                   \nworkbook.save(ruta_fin + '/' + nombre_base + '_Filtrado.xlsx')\n\narch_fil_proceso_ellipse = ruta_fin + '/' + nombre_base + '_Filtrado.xlsx'\n\nSetVar('arch_fil_proceso_ellipse', 	arch_fil_proceso_ellipse)\n
2024-08-07 18:01:16.647644 - rocketbot - INFO - request: N-DataEllipse : line 17 - rpasystem : log_message  id: 7e9bdeab-2398-bc63-8b91-4f28bd088ec0 - warn - Despues del Error
2024-08-07 18:01:16.647644 - robot_message - WARN - Despues del Error
2024-08-07 18:01:16.647644 - rocketbot - INFO - request: N-DataEllipse : line 19 - rpasystem : setVar  id: 6808af79-a662-7374-d0ac-6be6e224c4fa -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 18:01:16.647644 - rocketbot - INFO - request: N-DataEllipse : line 20 - rpafile : savedatafile  id: b376d6df-95ff-782b-454c-49db439f3c5d -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Fin proceso de filtrado del Maestro de Contratos, Data filtrada almacenada en: {arch_fil_proceso_ellipse}"}
2024-08-07 18:01:16.647644 - rocketbot - INFO - request: N-DataEllipse : line 21 - rpasystem : wait  id: 08cf1957-a730-7021-0e81-cfacaa488ff4 -  - 2
2024-08-07 18:01:18.663271 - rocketbot - INFO - request: N-DataEllipse : line 22 - rpasystem : setVar  id: 8b06105d-2a64-ed2f-1fbb-28133e8568c1 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 18:01:18.663271 - rocketbot - INFO - request: N-DataEllipse : line 23 - rpafile : savedatafile  id: 3ac13a91-b3cf-cbf0-c4ed-27f821ad7fbd -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Inicio del proceso de insercion de Data filtrada del Maestro de Contratos en Atomox"}
2024-08-07 18:01:18.663271 - rocketbot - INFO - request: N-DataEllipse : line 24 - rpascripts : execscriptpython  id: bb511a6a-3707-5609-bd22-e489046dbf9d -  - ########################################################################\n#  Script para obtener el ultimo archivo historico generado del        #\n#  Maestro de Contratos                                                # \n########################################################################\n\nimport os\n\ncarpeta = GetVar('procesado_ellipse')\n\nlista_archivos = []\nfor archivo in os.listdir(carpeta):\n    ruta_absoluta = os.path.join(carpeta, archivo)\n    if os.path.isfile(ruta_absoluta):\n        lista_archivos.append(archivo)\n\nif not lista_archivos:\n    print("La carpeta no contiene archivos.")\nelse:\n    archivos_modificados = []\n    for archivo in lista_archivos:\n        ruta_absoluta = os.path.join(carpeta, archivo)\n        fecha_modificacion = os.path.getmtime(ruta_absoluta)\n        archivos_modificados.append((archivo, fecha_modificacion))\n\n    ultimo_archivo_procesado_ellipse = max(archivos_modificados, key=lambda x: x[1])[0]\n    print("El último archivo modificado en la carpeta es:", ultimo_archivo_procesado_ellipse)\n    SetVar('ultimo_archivo_procesado_ellipse', ultimo_archivo_procesado_ellipse) 
2024-08-07 18:01:18.663271 - rocketbot - INFO - request: N-DataEllipse : line 25 - rpaxls : readxlsx  id: 60df8e16-88cc-a5e4-f3d3-20d1e4275686 -  - {"file_path":"{procesado_ellipse}/{ultimo_archivo_procesado_ellipse}"}
2024-08-07 18:01:18.819482 - rocketbot - INFO - request: N-DataEllipse : line 26 - rpaxls : getrows  id: 9bbd0407-cac9-0356-7101-04cbda86436a -  - numero_filas
2024-08-07 18:01:18.819482 - rocketbot - INFO - request: N-DataEllipse : line 27 - rpaxls : getcell  id: 7fb0e04e-3e11-3121-8d1f-ee76edb2ba05 -  - A2:AB{numero_filas}
2024-08-07 18:01:18.835069 - rocketbot - INFO - request: N-DataEllipse : line 28 - rpaxls : setcell  id: e579353e-d6f5-dad4-1961-7cdeeaaffcf8 -  - AC:1=Estado Registro ATOMOX
2024-08-07 18:01:18.850749 - rocketbot - INFO - request: N-DataEllipse : line 29 - rpasystem : setVar  id: f8f9efe3-830b-2ba0-323b-7627d6d2617b -  - 2
2024-08-07 18:01:18.850749 - rocketbot - INFO - request: N-DataEllipse : line 30 - rpalogic : for  id: 5720dce3-a8ff-73b1-9406-3fb4b37b5c13 -  - {"iterable":"{contenido_excel}","count":0}
2024-08-07 18:01:18.881982 - rocketbot - INFO - For count: 0
2024-08-07 18:01:18.881982 - rocketbot - INFO - request: N-DataEllipse : line 30 - rpalogic : for  id: 5720dce3-a8ff-73b1-9406-3fb4b37b5c13 -  - {"iterable":"{contenido_excel}","count":0}
2024-08-07 18:01:18.897583 - rocketbot - INFO - For count: 1
2024-08-07 18:01:18.913238 - rocketbot - INFO - request: N-DataEllipse : line 30.2 - rpascripts : execscriptpython  id: 7486e36a-d129-2902-dd42-57fd2ecd3c65 -  - ########################################################################\n#  Script que realiza la asignacion de valores del registro campo por  #\n#  campo a las variables que se utilizaran en el JSON de la API para   #\n#  enviar los datos a Atomox, de cada variable quita los espacios en   #\n#  blanco al principio y al final y si encuentra caracteres especiales #\n#  los sustituye por espacios en blanco                                #\n########################################################################\n\nimport re\n\npatron = re.compile(r'[^a-zA-Z0-9\s]')\n\ngerencia = {registro}[0]\nprint(gerencia)\nif gerencia is None:\n    SetVar ('gerencia', gerencia)\nelse:\n    gerencia = gerencia.strip()\n    SetVar ('gerencia', gerencia)\n\ncontrato = {registro}[1]\nprint(contrato)\nif contrato is None:\n    SetVar ('contrato', contrato)\nelse:\n    contrato = contrato.strip()\n    SetVar ('contrato', contrato)\n\ntipo_contrato = {registro}[2]\nprint(tipo_contrato)\nif tipo_contrato is None:\n    SetVar ('tipo_contrato', tipo_contrato)\nelse:\n    tipo_contrato = tipo_contrato.strip()\n    SetVar ('tipo_contrato', tipo_contrato)\n\ntipo_adjudicacion = {registro}[3]\nprint(tipo_adjudicacion)\nif tipo_adjudicacion is None:\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\nelse:\n    tipo_adjudicacion = tipo_adjudicacion.strip()\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\n\ndescripcion = {registro}[4]\nprint(descripcion)\nif descripcion is None:\n    SetVar ('descripcion', descripcion)\nelse:\n    descripcion_limpio = patron.sub(' ', descripcion)\n    descripcion = descripcion_limpio.strip()\n    SetVar ('descripcion', descripcion)\n\nadministrador = {registro}[5]\nprint(administrador)\nif administrador is None:\n    SetVar ('administrador', administrador)\nelse:  \n    administrador = administrador.strip()\n    SetVar ('administrador', administrador)\n\nnombre_admiistrador = {registro}[6]\nprint(nombre_admiistrador)\nif nombre_admiistrador is None:\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\nelse:    \n    nombre_admiistrador_limpio = patron.sub(' ', nombre_admiistrador)\n    nombre_admiistrador = nombre_admiistrador_limpio.strip()\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\n\nid_proveedor = {registro}[7]\nprint(id_proveedor)\nSetVar ('id_proveedor', id_proveedor)\n\nnombre_proveedor = {registro}[8]\nprint(nombre_proveedor)\nif nombre_proveedor is None:\n    SetVar ('nombre_proveedor', nombre_proveedor)\nelse:    \n    nombre_proveedor_limpio = patron.sub(' ', nombre_proveedor)\n    nombre_proveedor = nombre_proveedor_limpio.strip()\n    SetVar ('nombre_proveedor', nombre_proveedor)\n\nmoneda = {registro}[9]\nprint(moneda)\nif moneda is None:\n    SetVar ('moneda', moneda)\nelse:    \n    moneda_limpio = patron.sub(' ', moneda)\n    moneda = moneda_limpio.strip()\n    SetVar ('moneda', moneda)\n\nrut_ing_contratos = {registro}[10]\nprint(rut_ing_contratos)\nif rut_ing_contratos is None:\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\nelse:\n    rut_ing_contratos = rut_ing_contratos.strip()\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\n\nnombre_ing = {registro}[11]\nprint(nombre_ing)\nif nombre_ing is None:\n    SetVar ('nombre_ing', nombre_ing)\nelse:    \n    nombre_ing_limpio = patron.sub(' ', nombre_ing)\n    nombre_ing = nombre_ing_limpio.strip()\n    SetVar ('nombre_ing', nombre_ing)\n    \ningresado_por = {registro}[12]\nprint(ingresado_por)\ningresado_por = ingresado_por.strip()\nSetVar ('ingresado_por', ingresado_por)    \n\nfecha_inicio = {registro}[13]\nprint(fecha_inicio)\nfecha_inicio = fecha_inicio.strip()\nSetVar ('fecha_inicio', fecha_inicio)\n\nfecha_fin = {registro}[14]\nprint(fecha_fin)\nfecha_fin = fecha_fin.strip()\nSetVar ('fecha_fin', fecha_fin)\n\nmonto_original = {registro}[15]\nprint(monto_original)\nSetVar ('monto_original', monto_original)\n\nmodificaciones = {registro}[16]\nprint(modificaciones)\nSetVar ('modificaciones', modificaciones)\n\nmonto_total = {registro}[17]\nprint(monto_total)\nSetVar ('monto_total', monto_total)\n\npagos_real = {registro}[18]\nprint(pagos_real)\nSetVar ('pagos_real', pagos_real)\n\nsaldo_real = {registro}[19]\nprint(saldo_real)\nSetVar ('saldo_real', saldo_real)\n\nmonto_retenido = {registro}[20]\nprint(monto_retenido)\nSetVar ('monto_retenido', monto_retenido)\n\npagos_directos = {registro}[21]\nprint(pagos_directos)\nSetVar ('pagos_directos', pagos_directos)\n\ngasto_promedio = {registro}[22]\nprint(gasto_promedio)\nSetVar ('gasto_promedio', gasto_promedio)\n\nproyeccion_gasto = {registro}[23]\nprint(proyeccion_gasto)\nSetVar ('proyeccion_gasto', proyeccion_gasto)\n\nfaltante = {registro}[24]\nprint(faltante)\nSetVar ('faltante', faltante)\n\nmeses = {registro}[25]\nprint(meses)\nSetVar ('meses', meses)\n\nmeses_transcurridos = {registro}[26]\nprint(meses_transcurridos)\nSetVar ('meses_transcurridos', meses_transcurridos)\n\nestado = {registro}[27]\nprint(estado)\nestado = estado.strip()\nSetVar ('estado', estado)
2024-08-07 18:01:18.944402 - rocketbot - INFO - request: N-DataEllipse : line 30.3 - rpaconnect : request  id: 6b0e9df4-5f6f-3645-1d62-a8b260598cfe -  - {"method":"post","url":"{api_ellipse}","json":"{\n  \"gerencia\":\"{gerencia}\",\n  \"codigoCttoAnterior\":\"{contrato}\",\n  \"tipoContrato\":\"{tipo_contrato}\",\n  \"tipoAdjudicacion\":\"{tipo_adjudicacion}\",\n  \"descripcion\":\"{descripcion}\",\n  \"rutAdministrador\":\"{administrador}\",\n  \"nombreAdministrador\":\"{nombre_admiistrador}\",\n  \"codigoProvedor\":\"{id_proveedor}\",\n  \"nombreProveddor\":\"{nombre_proveedor}\",\n  \"moneda\":\"{moneda}\",\n  \"rutIngenieroContrato\":\"{rut_ing_contratos}\",\n  \"nombreIngenieroContrato\":\"{nombre_ing}\",\n  \"fechaInicioActualizada\":\"{fecha_inicio}\",\n  \"fechaTerminoActualizada\":\"{fecha_fin}\",\n  \"monto\":\"{monto_original}\",\n  \"modificacionesMonto\":\"{modificaciones}\",\n  \"montoTotal\":\"{monto_total}\",\n  \"pagosReal\":\"{pagos_real}\",\n  \"saldoReal\":\"{saldo_real}\",\n  \"montoRetenido\":\"{monto_retenido}\",\n  \"pagosDirectos\":\"{pagos_directos}\",\n  \"gastoPromedioActualReal\":\"{gasto_promedio}\",\n  \"proyeccionGastoActual\":\"{proyeccion_gasto}\",\n  \"faltante\":\"{faltante}\",\n  \"mesesCtto\":\"{meses}\",\n  \"mesesTranscurridos\":\"{meses_transcurridos}\",\n  \"estadoContrato\":\"{estado}\"\n}","params":"","form":"","proxy":"","file":"","header":"{\"X-Api-Key\":\"{api_key}\"}"}
2024-08-07 18:01:40.007524 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_108 ""): ConnectTimeout: HTTPConnectionPool(host='54.88.59.194', port=8081): Max retries exceeded with url: /api/v1.0/sourcings (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x00000283182906D0>, 'Connection to 54.88.59.194 timed out. (connect timeout=None)'))
2024-08-07 18:01:40.007524 - rocketbot - INFO - request: N-DataEllipse : line 30.4 - rpaxls : setcell  id: 556e681f-94f9-2ea4-3e17-58ad6db10c28 -  - AC:{contador}={conexion_api_ellipse}
2024-08-07 18:01:40.007524 - rocketbot - INFO - request: N-DataEllipse : line 30.5 - rpasystem : setVar  id: b7f818c2-7f7d-03b6-397f-1cdd17ba8494 -  - {contador} + 1
2024-08-07 18:01:40.007524 - rocketbot - INFO - request: N-DataEllipse : line 30 - rpalogic : for  id: 5720dce3-a8ff-73b1-9406-3fb4b37b5c13 -  - {"iterable":"{contenido_excel}","count":0}
2024-08-07 18:01:40.038680 - rocketbot - INFO - For count: 2
2024-08-07 18:01:40.038680 - rocketbot - INFO - request: N-DataEllipse : line 30.1 - rpascripts : module  id: 1ea0031b-e3c7-c0f7-c8a9-f9f16739d951 -  - {"module_name":"System++","module":"cleanVars","vars":"gerencia,contrato,tipo_contrato,tipo_adjudicacion,descripcion,administrador,nombre_admiistrador,id_proveedor,nombre_proveedor,moneda,rut_ing_contratos,nombre_ing,fecha_inicio,fecha_fin,monto_original,modificaciones,monto_total,pagos_real,saldo_real,monto_retenido,pagos_directos,gasto_promedio,proyeccion_gasto,faltante,meses,meses_transcurridos,estado,conexion_api_ellipse,ingresado_pro"}
2024-08-07 18:01:40.055334 - rocketbot - INFO - request: N-DataEllipse : line 30.2 - rpascripts : execscriptpython  id: 7486e36a-d129-2902-dd42-57fd2ecd3c65 -  - ########################################################################\n#  Script que realiza la asignacion de valores del registro campo por  #\n#  campo a las variables que se utilizaran en el JSON de la API para   #\n#  enviar los datos a Atomox, de cada variable quita los espacios en   #\n#  blanco al principio y al final y si encuentra caracteres especiales #\n#  los sustituye por espacios en blanco                                #\n########################################################################\n\nimport re\n\npatron = re.compile(r'[^a-zA-Z0-9\s]')\n\ngerencia = {registro}[0]\nprint(gerencia)\nif gerencia is None:\n    SetVar ('gerencia', gerencia)\nelse:\n    gerencia = gerencia.strip()\n    SetVar ('gerencia', gerencia)\n\ncontrato = {registro}[1]\nprint(contrato)\nif contrato is None:\n    SetVar ('contrato', contrato)\nelse:\n    contrato = contrato.strip()\n    SetVar ('contrato', contrato)\n\ntipo_contrato = {registro}[2]\nprint(tipo_contrato)\nif tipo_contrato is None:\n    SetVar ('tipo_contrato', tipo_contrato)\nelse:\n    tipo_contrato = tipo_contrato.strip()\n    SetVar ('tipo_contrato', tipo_contrato)\n\ntipo_adjudicacion = {registro}[3]\nprint(tipo_adjudicacion)\nif tipo_adjudicacion is None:\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\nelse:\n    tipo_adjudicacion = tipo_adjudicacion.strip()\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\n\ndescripcion = {registro}[4]\nprint(descripcion)\nif descripcion is None:\n    SetVar ('descripcion', descripcion)\nelse:\n    descripcion_limpio = patron.sub(' ', descripcion)\n    descripcion = descripcion_limpio.strip()\n    SetVar ('descripcion', descripcion)\n\nadministrador = {registro}[5]\nprint(administrador)\nif administrador is None:\n    SetVar ('administrador', administrador)\nelse:  \n    administrador = administrador.strip()\n    SetVar ('administrador', administrador)\n\nnombre_admiistrador = {registro}[6]\nprint(nombre_admiistrador)\nif nombre_admiistrador is None:\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\nelse:    \n    nombre_admiistrador_limpio = patron.sub(' ', nombre_admiistrador)\n    nombre_admiistrador = nombre_admiistrador_limpio.strip()\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\n\nid_proveedor = {registro}[7]\nprint(id_proveedor)\nSetVar ('id_proveedor', id_proveedor)\n\nnombre_proveedor = {registro}[8]\nprint(nombre_proveedor)\nif nombre_proveedor is None:\n    SetVar ('nombre_proveedor', nombre_proveedor)\nelse:    \n    nombre_proveedor_limpio = patron.sub(' ', nombre_proveedor)\n    nombre_proveedor = nombre_proveedor_limpio.strip()\n    SetVar ('nombre_proveedor', nombre_proveedor)\n\nmoneda = {registro}[9]\nprint(moneda)\nif moneda is None:\n    SetVar ('moneda', moneda)\nelse:    \n    moneda_limpio = patron.sub(' ', moneda)\n    moneda = moneda_limpio.strip()\n    SetVar ('moneda', moneda)\n\nrut_ing_contratos = {registro}[10]\nprint(rut_ing_contratos)\nif rut_ing_contratos is None:\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\nelse:\n    rut_ing_contratos = rut_ing_contratos.strip()\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\n\nnombre_ing = {registro}[11]\nprint(nombre_ing)\nif nombre_ing is None:\n    SetVar ('nombre_ing', nombre_ing)\nelse:    \n    nombre_ing_limpio = patron.sub(' ', nombre_ing)\n    nombre_ing = nombre_ing_limpio.strip()\n    SetVar ('nombre_ing', nombre_ing)\n    \ningresado_por = {registro}[12]\nprint(ingresado_por)\ningresado_por = ingresado_por.strip()\nSetVar ('ingresado_por', ingresado_por)    \n\nfecha_inicio = {registro}[13]\nprint(fecha_inicio)\nfecha_inicio = fecha_inicio.strip()\nSetVar ('fecha_inicio', fecha_inicio)\n\nfecha_fin = {registro}[14]\nprint(fecha_fin)\nfecha_fin = fecha_fin.strip()\nSetVar ('fecha_fin', fecha_fin)\n\nmonto_original = {registro}[15]\nprint(monto_original)\nSetVar ('monto_original', monto_original)\n\nmodificaciones = {registro}[16]\nprint(modificaciones)\nSetVar ('modificaciones', modificaciones)\n\nmonto_total = {registro}[17]\nprint(monto_total)\nSetVar ('monto_total', monto_total)\n\npagos_real = {registro}[18]\nprint(pagos_real)\nSetVar ('pagos_real', pagos_real)\n\nsaldo_real = {registro}[19]\nprint(saldo_real)\nSetVar ('saldo_real', saldo_real)\n\nmonto_retenido = {registro}[20]\nprint(monto_retenido)\nSetVar ('monto_retenido', monto_retenido)\n\npagos_directos = {registro}[21]\nprint(pagos_directos)\nSetVar ('pagos_directos', pagos_directos)\n\ngasto_promedio = {registro}[22]\nprint(gasto_promedio)\nSetVar ('gasto_promedio', gasto_promedio)\n\nproyeccion_gasto = {registro}[23]\nprint(proyeccion_gasto)\nSetVar ('proyeccion_gasto', proyeccion_gasto)\n\nfaltante = {registro}[24]\nprint(faltante)\nSetVar ('faltante', faltante)\n\nmeses = {registro}[25]\nprint(meses)\nSetVar ('meses', meses)\n\nmeses_transcurridos = {registro}[26]\nprint(meses_transcurridos)\nSetVar ('meses_transcurridos', meses_transcurridos)\n\nestado = {registro}[27]\nprint(estado)\nestado = estado.strip()\nSetVar ('estado', estado)
2024-08-07 18:01:40.085496 - rocketbot - INFO - request: N-DataEllipse : line 30.3 - rpaconnect : request  id: 6b0e9df4-5f6f-3645-1d62-a8b260598cfe -  - {"method":"post","url":"{api_ellipse}","json":"{\n  \"gerencia\":\"{gerencia}\",\n  \"codigoCttoAnterior\":\"{contrato}\",\n  \"tipoContrato\":\"{tipo_contrato}\",\n  \"tipoAdjudicacion\":\"{tipo_adjudicacion}\",\n  \"descripcion\":\"{descripcion}\",\n  \"rutAdministrador\":\"{administrador}\",\n  \"nombreAdministrador\":\"{nombre_admiistrador}\",\n  \"codigoProvedor\":\"{id_proveedor}\",\n  \"nombreProveddor\":\"{nombre_proveedor}\",\n  \"moneda\":\"{moneda}\",\n  \"rutIngenieroContrato\":\"{rut_ing_contratos}\",\n  \"nombreIngenieroContrato\":\"{nombre_ing}\",\n  \"fechaInicioActualizada\":\"{fecha_inicio}\",\n  \"fechaTerminoActualizada\":\"{fecha_fin}\",\n  \"monto\":\"{monto_original}\",\n  \"modificacionesMonto\":\"{modificaciones}\",\n  \"montoTotal\":\"{monto_total}\",\n  \"pagosReal\":\"{pagos_real}\",\n  \"saldoReal\":\"{saldo_real}\",\n  \"montoRetenido\":\"{monto_retenido}\",\n  \"pagosDirectos\":\"{pagos_directos}\",\n  \"gastoPromedioActualReal\":\"{gasto_promedio}\",\n  \"proyeccionGastoActual\":\"{proyeccion_gasto}\",\n  \"faltante\":\"{faltante}\",\n  \"mesesCtto\":\"{meses}\",\n  \"mesesTranscurridos\":\"{meses_transcurridos}\",\n  \"estadoContrato\":\"{estado}\"\n}","params":"","form":"","proxy":"","file":"","header":"{\"X-Api-Key\":\"{api_key}\"}"}
2024-08-07 18:02:01.132879 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_108 ""): ConnectTimeout: HTTPConnectionPool(host='54.88.59.194', port=8081): Max retries exceeded with url: /api/v1.0/sourcings (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x00000283170229B0>, 'Connection to 54.88.59.194 timed out. (connect timeout=None)'))
2024-08-07 18:02:01.148170 - rocketbot - INFO - request: N-DataEllipse : line 30.4 - rpaxls : setcell  id: 556e681f-94f9-2ea4-3e17-58ad6db10c28 -  - AC:{contador}={conexion_api_ellipse}
2024-08-07 18:02:01.148170 - rocketbot - INFO - request: N-DataEllipse : line 30.5 - rpasystem : setVar  id: b7f818c2-7f7d-03b6-397f-1cdd17ba8494 -  - {contador} + 1
2024-08-07 18:02:01.148170 - rocketbot - INFO - request: N-DataEllipse : line 30 - rpalogic : for  id: 5720dce3-a8ff-73b1-9406-3fb4b37b5c13 -  - {"iterable":"{contenido_excel}","count":0}
2024-08-07 18:02:01.179346 - rocketbot - INFO - For count: 3
2024-08-07 18:02:01.179346 - rocketbot - INFO - request: N-DataEllipse : line 30.1 - rpascripts : module  id: 1ea0031b-e3c7-c0f7-c8a9-f9f16739d951 -  - {"module_name":"System++","module":"cleanVars","vars":"gerencia,contrato,tipo_contrato,tipo_adjudicacion,descripcion,administrador,nombre_admiistrador,id_proveedor,nombre_proveedor,moneda,rut_ing_contratos,nombre_ing,fecha_inicio,fecha_fin,monto_original,modificaciones,monto_total,pagos_real,saldo_real,monto_retenido,pagos_directos,gasto_promedio,proyeccion_gasto,faltante,meses,meses_transcurridos,estado,conexion_api_ellipse,ingresado_pro"}
2024-08-07 18:02:01.179346 - rocketbot - INFO - request: N-DataEllipse : line 30.2 - rpascripts : execscriptpython  id: 7486e36a-d129-2902-dd42-57fd2ecd3c65 -  - ########################################################################\n#  Script que realiza la asignacion de valores del registro campo por  #\n#  campo a las variables que se utilizaran en el JSON de la API para   #\n#  enviar los datos a Atomox, de cada variable quita los espacios en   #\n#  blanco al principio y al final y si encuentra caracteres especiales #\n#  los sustituye por espacios en blanco                                #\n########################################################################\n\nimport re\n\npatron = re.compile(r'[^a-zA-Z0-9\s]')\n\ngerencia = {registro}[0]\nprint(gerencia)\nif gerencia is None:\n    SetVar ('gerencia', gerencia)\nelse:\n    gerencia = gerencia.strip()\n    SetVar ('gerencia', gerencia)\n\ncontrato = {registro}[1]\nprint(contrato)\nif contrato is None:\n    SetVar ('contrato', contrato)\nelse:\n    contrato = contrato.strip()\n    SetVar ('contrato', contrato)\n\ntipo_contrato = {registro}[2]\nprint(tipo_contrato)\nif tipo_contrato is None:\n    SetVar ('tipo_contrato', tipo_contrato)\nelse:\n    tipo_contrato = tipo_contrato.strip()\n    SetVar ('tipo_contrato', tipo_contrato)\n\ntipo_adjudicacion = {registro}[3]\nprint(tipo_adjudicacion)\nif tipo_adjudicacion is None:\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\nelse:\n    tipo_adjudicacion = tipo_adjudicacion.strip()\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\n\ndescripcion = {registro}[4]\nprint(descripcion)\nif descripcion is None:\n    SetVar ('descripcion', descripcion)\nelse:\n    descripcion_limpio = patron.sub(' ', descripcion)\n    descripcion = descripcion_limpio.strip()\n    SetVar ('descripcion', descripcion)\n\nadministrador = {registro}[5]\nprint(administrador)\nif administrador is None:\n    SetVar ('administrador', administrador)\nelse:  \n    administrador = administrador.strip()\n    SetVar ('administrador', administrador)\n\nnombre_admiistrador = {registro}[6]\nprint(nombre_admiistrador)\nif nombre_admiistrador is None:\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\nelse:    \n    nombre_admiistrador_limpio = patron.sub(' ', nombre_admiistrador)\n    nombre_admiistrador = nombre_admiistrador_limpio.strip()\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\n\nid_proveedor = {registro}[7]\nprint(id_proveedor)\nSetVar ('id_proveedor', id_proveedor)\n\nnombre_proveedor = {registro}[8]\nprint(nombre_proveedor)\nif nombre_proveedor is None:\n    SetVar ('nombre_proveedor', nombre_proveedor)\nelse:    \n    nombre_proveedor_limpio = patron.sub(' ', nombre_proveedor)\n    nombre_proveedor = nombre_proveedor_limpio.strip()\n    SetVar ('nombre_proveedor', nombre_proveedor)\n\nmoneda = {registro}[9]\nprint(moneda)\nif moneda is None:\n    SetVar ('moneda', moneda)\nelse:    \n    moneda_limpio = patron.sub(' ', moneda)\n    moneda = moneda_limpio.strip()\n    SetVar ('moneda', moneda)\n\nrut_ing_contratos = {registro}[10]\nprint(rut_ing_contratos)\nif rut_ing_contratos is None:\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\nelse:\n    rut_ing_contratos = rut_ing_contratos.strip()\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\n\nnombre_ing = {registro}[11]\nprint(nombre_ing)\nif nombre_ing is None:\n    SetVar ('nombre_ing', nombre_ing)\nelse:    \n    nombre_ing_limpio = patron.sub(' ', nombre_ing)\n    nombre_ing = nombre_ing_limpio.strip()\n    SetVar ('nombre_ing', nombre_ing)\n    \ningresado_por = {registro}[12]\nprint(ingresado_por)\ningresado_por = ingresado_por.strip()\nSetVar ('ingresado_por', ingresado_por)    \n\nfecha_inicio = {registro}[13]\nprint(fecha_inicio)\nfecha_inicio = fecha_inicio.strip()\nSetVar ('fecha_inicio', fecha_inicio)\n\nfecha_fin = {registro}[14]\nprint(fecha_fin)\nfecha_fin = fecha_fin.strip()\nSetVar ('fecha_fin', fecha_fin)\n\nmonto_original = {registro}[15]\nprint(monto_original)\nSetVar ('monto_original', monto_original)\n\nmodificaciones = {registro}[16]\nprint(modificaciones)\nSetVar ('modificaciones', modificaciones)\n\nmonto_total = {registro}[17]\nprint(monto_total)\nSetVar ('monto_total', monto_total)\n\npagos_real = {registro}[18]\nprint(pagos_real)\nSetVar ('pagos_real', pagos_real)\n\nsaldo_real = {registro}[19]\nprint(saldo_real)\nSetVar ('saldo_real', saldo_real)\n\nmonto_retenido = {registro}[20]\nprint(monto_retenido)\nSetVar ('monto_retenido', monto_retenido)\n\npagos_directos = {registro}[21]\nprint(pagos_directos)\nSetVar ('pagos_directos', pagos_directos)\n\ngasto_promedio = {registro}[22]\nprint(gasto_promedio)\nSetVar ('gasto_promedio', gasto_promedio)\n\nproyeccion_gasto = {registro}[23]\nprint(proyeccion_gasto)\nSetVar ('proyeccion_gasto', proyeccion_gasto)\n\nfaltante = {registro}[24]\nprint(faltante)\nSetVar ('faltante', faltante)\n\nmeses = {registro}[25]\nprint(meses)\nSetVar ('meses', meses)\n\nmeses_transcurridos = {registro}[26]\nprint(meses_transcurridos)\nSetVar ('meses_transcurridos', meses_transcurridos)\n\nestado = {registro}[27]\nprint(estado)\nestado = estado.strip()\nSetVar ('estado', estado)
2024-08-07 18:02:01.226239 - rocketbot - INFO - request: N-DataEllipse : line 30.3 - rpaconnect : request  id: 6b0e9df4-5f6f-3645-1d62-a8b260598cfe -  - {"method":"post","url":"{api_ellipse}","json":"{\n  \"gerencia\":\"{gerencia}\",\n  \"codigoCttoAnterior\":\"{contrato}\",\n  \"tipoContrato\":\"{tipo_contrato}\",\n  \"tipoAdjudicacion\":\"{tipo_adjudicacion}\",\n  \"descripcion\":\"{descripcion}\",\n  \"rutAdministrador\":\"{administrador}\",\n  \"nombreAdministrador\":\"{nombre_admiistrador}\",\n  \"codigoProvedor\":\"{id_proveedor}\",\n  \"nombreProveddor\":\"{nombre_proveedor}\",\n  \"moneda\":\"{moneda}\",\n  \"rutIngenieroContrato\":\"{rut_ing_contratos}\",\n  \"nombreIngenieroContrato\":\"{nombre_ing}\",\n  \"fechaInicioActualizada\":\"{fecha_inicio}\",\n  \"fechaTerminoActualizada\":\"{fecha_fin}\",\n  \"monto\":\"{monto_original}\",\n  \"modificacionesMonto\":\"{modificaciones}\",\n  \"montoTotal\":\"{monto_total}\",\n  \"pagosReal\":\"{pagos_real}\",\n  \"saldoReal\":\"{saldo_real}\",\n  \"montoRetenido\":\"{monto_retenido}\",\n  \"pagosDirectos\":\"{pagos_directos}\",\n  \"gastoPromedioActualReal\":\"{gasto_promedio}\",\n  \"proyeccionGastoActual\":\"{proyeccion_gasto}\",\n  \"faltante\":\"{faltante}\",\n  \"mesesCtto\":\"{meses}\",\n  \"mesesTranscurridos\":\"{meses_transcurridos}\",\n  \"estadoContrato\":\"{estado}\"\n}","params":"","form":"","proxy":"","file":"","header":"{\"X-Api-Key\":\"{api_key}\"}"}
2024-08-07 18:02:22.275447 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_108 ""): ConnectTimeout: HTTPConnectionPool(host='54.88.59.194', port=8081): Max retries exceeded with url: /api/v1.0/sourcings (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x0000028318292650>, 'Connection to 54.88.59.194 timed out. (connect timeout=None)'))
2024-08-07 18:02:22.280450 - rocketbot - INFO - request: N-DataEllipse : line 30.4 - rpaxls : setcell  id: 556e681f-94f9-2ea4-3e17-58ad6db10c28 -  - AC:{contador}={conexion_api_ellipse}
2024-08-07 18:02:22.282451 - rocketbot - INFO - request: N-DataEllipse : line 30.5 - rpasystem : setVar  id: b7f818c2-7f7d-03b6-397f-1cdd17ba8494 -  - {contador} + 1
2024-08-07 18:02:22.284449 - rocketbot - INFO - request: N-DataEllipse : line 30 - rpalogic : for  id: 5720dce3-a8ff-73b1-9406-3fb4b37b5c13 -  - {"iterable":"{contenido_excel}","count":0}
2024-08-07 18:02:22.311523 - rocketbot - INFO - For count: 4
2024-08-07 18:02:22.314531 - rocketbot - INFO - request: N-DataEllipse : line 30.1 - rpascripts : module  id: 1ea0031b-e3c7-c0f7-c8a9-f9f16739d951 -  - {"module_name":"System++","module":"cleanVars","vars":"gerencia,contrato,tipo_contrato,tipo_adjudicacion,descripcion,administrador,nombre_admiistrador,id_proveedor,nombre_proveedor,moneda,rut_ing_contratos,nombre_ing,fecha_inicio,fecha_fin,monto_original,modificaciones,monto_total,pagos_real,saldo_real,monto_retenido,pagos_directos,gasto_promedio,proyeccion_gasto,faltante,meses,meses_transcurridos,estado,conexion_api_ellipse,ingresado_pro"}
2024-08-07 18:02:22.319525 - rocketbot - INFO - request: N-DataEllipse : line 30.2 - rpascripts : execscriptpython  id: 7486e36a-d129-2902-dd42-57fd2ecd3c65 -  - ########################################################################\n#  Script que realiza la asignacion de valores del registro campo por  #\n#  campo a las variables que se utilizaran en el JSON de la API para   #\n#  enviar los datos a Atomox, de cada variable quita los espacios en   #\n#  blanco al principio y al final y si encuentra caracteres especiales #\n#  los sustituye por espacios en blanco                                #\n########################################################################\n\nimport re\n\npatron = re.compile(r'[^a-zA-Z0-9\s]')\n\ngerencia = {registro}[0]\nprint(gerencia)\nif gerencia is None:\n    SetVar ('gerencia', gerencia)\nelse:\n    gerencia = gerencia.strip()\n    SetVar ('gerencia', gerencia)\n\ncontrato = {registro}[1]\nprint(contrato)\nif contrato is None:\n    SetVar ('contrato', contrato)\nelse:\n    contrato = contrato.strip()\n    SetVar ('contrato', contrato)\n\ntipo_contrato = {registro}[2]\nprint(tipo_contrato)\nif tipo_contrato is None:\n    SetVar ('tipo_contrato', tipo_contrato)\nelse:\n    tipo_contrato = tipo_contrato.strip()\n    SetVar ('tipo_contrato', tipo_contrato)\n\ntipo_adjudicacion = {registro}[3]\nprint(tipo_adjudicacion)\nif tipo_adjudicacion is None:\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\nelse:\n    tipo_adjudicacion = tipo_adjudicacion.strip()\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\n\ndescripcion = {registro}[4]\nprint(descripcion)\nif descripcion is None:\n    SetVar ('descripcion', descripcion)\nelse:\n    descripcion_limpio = patron.sub(' ', descripcion)\n    descripcion = descripcion_limpio.strip()\n    SetVar ('descripcion', descripcion)\n\nadministrador = {registro}[5]\nprint(administrador)\nif administrador is None:\n    SetVar ('administrador', administrador)\nelse:  \n    administrador = administrador.strip()\n    SetVar ('administrador', administrador)\n\nnombre_admiistrador = {registro}[6]\nprint(nombre_admiistrador)\nif nombre_admiistrador is None:\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\nelse:    \n    nombre_admiistrador_limpio = patron.sub(' ', nombre_admiistrador)\n    nombre_admiistrador = nombre_admiistrador_limpio.strip()\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\n\nid_proveedor = {registro}[7]\nprint(id_proveedor)\nSetVar ('id_proveedor', id_proveedor)\n\nnombre_proveedor = {registro}[8]\nprint(nombre_proveedor)\nif nombre_proveedor is None:\n    SetVar ('nombre_proveedor', nombre_proveedor)\nelse:    \n    nombre_proveedor_limpio = patron.sub(' ', nombre_proveedor)\n    nombre_proveedor = nombre_proveedor_limpio.strip()\n    SetVar ('nombre_proveedor', nombre_proveedor)\n\nmoneda = {registro}[9]\nprint(moneda)\nif moneda is None:\n    SetVar ('moneda', moneda)\nelse:    \n    moneda_limpio = patron.sub(' ', moneda)\n    moneda = moneda_limpio.strip()\n    SetVar ('moneda', moneda)\n\nrut_ing_contratos = {registro}[10]\nprint(rut_ing_contratos)\nif rut_ing_contratos is None:\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\nelse:\n    rut_ing_contratos = rut_ing_contratos.strip()\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\n\nnombre_ing = {registro}[11]\nprint(nombre_ing)\nif nombre_ing is None:\n    SetVar ('nombre_ing', nombre_ing)\nelse:    \n    nombre_ing_limpio = patron.sub(' ', nombre_ing)\n    nombre_ing = nombre_ing_limpio.strip()\n    SetVar ('nombre_ing', nombre_ing)\n    \ningresado_por = {registro}[12]\nprint(ingresado_por)\ningresado_por = ingresado_por.strip()\nSetVar ('ingresado_por', ingresado_por)    \n\nfecha_inicio = {registro}[13]\nprint(fecha_inicio)\nfecha_inicio = fecha_inicio.strip()\nSetVar ('fecha_inicio', fecha_inicio)\n\nfecha_fin = {registro}[14]\nprint(fecha_fin)\nfecha_fin = fecha_fin.strip()\nSetVar ('fecha_fin', fecha_fin)\n\nmonto_original = {registro}[15]\nprint(monto_original)\nSetVar ('monto_original', monto_original)\n\nmodificaciones = {registro}[16]\nprint(modificaciones)\nSetVar ('modificaciones', modificaciones)\n\nmonto_total = {registro}[17]\nprint(monto_total)\nSetVar ('monto_total', monto_total)\n\npagos_real = {registro}[18]\nprint(pagos_real)\nSetVar ('pagos_real', pagos_real)\n\nsaldo_real = {registro}[19]\nprint(saldo_real)\nSetVar ('saldo_real', saldo_real)\n\nmonto_retenido = {registro}[20]\nprint(monto_retenido)\nSetVar ('monto_retenido', monto_retenido)\n\npagos_directos = {registro}[21]\nprint(pagos_directos)\nSetVar ('pagos_directos', pagos_directos)\n\ngasto_promedio = {registro}[22]\nprint(gasto_promedio)\nSetVar ('gasto_promedio', gasto_promedio)\n\nproyeccion_gasto = {registro}[23]\nprint(proyeccion_gasto)\nSetVar ('proyeccion_gasto', proyeccion_gasto)\n\nfaltante = {registro}[24]\nprint(faltante)\nSetVar ('faltante', faltante)\n\nmeses = {registro}[25]\nprint(meses)\nSetVar ('meses', meses)\n\nmeses_transcurridos = {registro}[26]\nprint(meses_transcurridos)\nSetVar ('meses_transcurridos', meses_transcurridos)\n\nestado = {registro}[27]\nprint(estado)\nestado = estado.strip()\nSetVar ('estado', estado)
2024-08-07 18:02:22.361780 - rocketbot - INFO - request: N-DataEllipse : line 30.3 - rpaconnect : request  id: 6b0e9df4-5f6f-3645-1d62-a8b260598cfe -  - {"method":"post","url":"{api_ellipse}","json":"{\n  \"gerencia\":\"{gerencia}\",\n  \"codigoCttoAnterior\":\"{contrato}\",\n  \"tipoContrato\":\"{tipo_contrato}\",\n  \"tipoAdjudicacion\":\"{tipo_adjudicacion}\",\n  \"descripcion\":\"{descripcion}\",\n  \"rutAdministrador\":\"{administrador}\",\n  \"nombreAdministrador\":\"{nombre_admiistrador}\",\n  \"codigoProvedor\":\"{id_proveedor}\",\n  \"nombreProveddor\":\"{nombre_proveedor}\",\n  \"moneda\":\"{moneda}\",\n  \"rutIngenieroContrato\":\"{rut_ing_contratos}\",\n  \"nombreIngenieroContrato\":\"{nombre_ing}\",\n  \"fechaInicioActualizada\":\"{fecha_inicio}\",\n  \"fechaTerminoActualizada\":\"{fecha_fin}\",\n  \"monto\":\"{monto_original}\",\n  \"modificacionesMonto\":\"{modificaciones}\",\n  \"montoTotal\":\"{monto_total}\",\n  \"pagosReal\":\"{pagos_real}\",\n  \"saldoReal\":\"{saldo_real}\",\n  \"montoRetenido\":\"{monto_retenido}\",\n  \"pagosDirectos\":\"{pagos_directos}\",\n  \"gastoPromedioActualReal\":\"{gasto_promedio}\",\n  \"proyeccionGastoActual\":\"{proyeccion_gasto}\",\n  \"faltante\":\"{faltante}\",\n  \"mesesCtto\":\"{meses}\",\n  \"mesesTranscurridos\":\"{meses_transcurridos}\",\n  \"estadoContrato\":\"{estado}\"\n}","params":"","form":"","proxy":"","file":"","header":"{\"X-Api-Key\":\"{api_key}\"}"}
2024-08-07 18:02:43.386549 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_108 ""): ConnectTimeout: HTTPConnectionPool(host='54.88.59.194', port=8081): Max retries exceeded with url: /api/v1.0/sourcings (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x0000028317023640>, 'Connection to 54.88.59.194 timed out. (connect timeout=None)'))
2024-08-07 18:02:43.391557 - rocketbot - INFO - request: N-DataEllipse : line 30.4 - rpaxls : setcell  id: 556e681f-94f9-2ea4-3e17-58ad6db10c28 -  - AC:{contador}={conexion_api_ellipse}
2024-08-07 18:02:43.393556 - rocketbot - INFO - request: N-DataEllipse : line 30.5 - rpasystem : setVar  id: b7f818c2-7f7d-03b6-397f-1cdd17ba8494 -  - {contador} + 1
2024-08-07 18:02:43.395345 - rocketbot - INFO - request: N-DataEllipse : line 30 - rpalogic : for  id: 5720dce3-a8ff-73b1-9406-3fb4b37b5c13 -  - {"iterable":"{contenido_excel}","count":0}
2024-08-07 18:02:43.431263 - rocketbot - INFO - request: N-DataEllipse : line 30.2 - rpascripts : execscriptpython  id: 7486e36a-d129-2902-dd42-57fd2ecd3c65 -  - ########################################################################\n#  Script que realiza la asignacion de valores del registro campo por  #\n#  campo a las variables que se utilizaran en el JSON de la API para   #\n#  enviar los datos a Atomox, de cada variable quita los espacios en   #\n#  blanco al principio y al final y si encuentra caracteres especiales #\n#  los sustituye por espacios en blanco                                #\n########################################################################\n\nimport re\n\npatron = re.compile(r'[^a-zA-Z0-9\s]')\n\ngerencia = {registro}[0]\nprint(gerencia)\nif gerencia is None:\n    SetVar ('gerencia', gerencia)\nelse:\n    gerencia = gerencia.strip()\n    SetVar ('gerencia', gerencia)\n\ncontrato = {registro}[1]\nprint(contrato)\nif contrato is None:\n    SetVar ('contrato', contrato)\nelse:\n    contrato = contrato.strip()\n    SetVar ('contrato', contrato)\n\ntipo_contrato = {registro}[2]\nprint(tipo_contrato)\nif tipo_contrato is None:\n    SetVar ('tipo_contrato', tipo_contrato)\nelse:\n    tipo_contrato = tipo_contrato.strip()\n    SetVar ('tipo_contrato', tipo_contrato)\n\ntipo_adjudicacion = {registro}[3]\nprint(tipo_adjudicacion)\nif tipo_adjudicacion is None:\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\nelse:\n    tipo_adjudicacion = tipo_adjudicacion.strip()\n    SetVar ('tipo_adjudicacion', tipo_adjudicacion)\n\ndescripcion = {registro}[4]\nprint(descripcion)\nif descripcion is None:\n    SetVar ('descripcion', descripcion)\nelse:\n    descripcion_limpio = patron.sub(' ', descripcion)\n    descripcion = descripcion_limpio.strip()\n    SetVar ('descripcion', descripcion)\n\nadministrador = {registro}[5]\nprint(administrador)\nif administrador is None:\n    SetVar ('administrador', administrador)\nelse:  \n    administrador = administrador.strip()\n    SetVar ('administrador', administrador)\n\nnombre_admiistrador = {registro}[6]\nprint(nombre_admiistrador)\nif nombre_admiistrador is None:\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\nelse:    \n    nombre_admiistrador_limpio = patron.sub(' ', nombre_admiistrador)\n    nombre_admiistrador = nombre_admiistrador_limpio.strip()\n    SetVar ('nombre_admiistrador', nombre_admiistrador)\n\nid_proveedor = {registro}[7]\nprint(id_proveedor)\nSetVar ('id_proveedor', id_proveedor)\n\nnombre_proveedor = {registro}[8]\nprint(nombre_proveedor)\nif nombre_proveedor is None:\n    SetVar ('nombre_proveedor', nombre_proveedor)\nelse:    \n    nombre_proveedor_limpio = patron.sub(' ', nombre_proveedor)\n    nombre_proveedor = nombre_proveedor_limpio.strip()\n    SetVar ('nombre_proveedor', nombre_proveedor)\n\nmoneda = {registro}[9]\nprint(moneda)\nif moneda is None:\n    SetVar ('moneda', moneda)\nelse:    \n    moneda_limpio = patron.sub(' ', moneda)\n    moneda = moneda_limpio.strip()\n    SetVar ('moneda', moneda)\n\nrut_ing_contratos = {registro}[10]\nprint(rut_ing_contratos)\nif rut_ing_contratos is None:\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\nelse:\n    rut_ing_contratos = rut_ing_contratos.strip()\n    SetVar ('rut_ing_contratos', rut_ing_contratos)\n\nnombre_ing = {registro}[11]\nprint(nombre_ing)\nif nombre_ing is None:\n    SetVar ('nombre_ing', nombre_ing)\nelse:    \n    nombre_ing_limpio = patron.sub(' ', nombre_ing)\n    nombre_ing = nombre_ing_limpio.strip()\n    SetVar ('nombre_ing', nombre_ing)\n    \ningresado_por = {registro}[12]\nprint(ingresado_por)\ningresado_por = ingresado_por.strip()\nSetVar ('ingresado_por', ingresado_por)    \n\nfecha_inicio = {registro}[13]\nprint(fecha_inicio)\nfecha_inicio = fecha_inicio.strip()\nSetVar ('fecha_inicio', fecha_inicio)\n\nfecha_fin = {registro}[14]\nprint(fecha_fin)\nfecha_fin = fecha_fin.strip()\nSetVar ('fecha_fin', fecha_fin)\n\nmonto_original = {registro}[15]\nprint(monto_original)\nSetVar ('monto_original', monto_original)\n\nmodificaciones = {registro}[16]\nprint(modificaciones)\nSetVar ('modificaciones', modificaciones)\n\nmonto_total = {registro}[17]\nprint(monto_total)\nSetVar ('monto_total', monto_total)\n\npagos_real = {registro}[18]\nprint(pagos_real)\nSetVar ('pagos_real', pagos_real)\n\nsaldo_real = {registro}[19]\nprint(saldo_real)\nSetVar ('saldo_real', saldo_real)\n\nmonto_retenido = {registro}[20]\nprint(monto_retenido)\nSetVar ('monto_retenido', monto_retenido)\n\npagos_directos = {registro}[21]\nprint(pagos_directos)\nSetVar ('pagos_directos', pagos_directos)\n\ngasto_promedio = {registro}[22]\nprint(gasto_promedio)\nSetVar ('gasto_promedio', gasto_promedio)\n\nproyeccion_gasto = {registro}[23]\nprint(proyeccion_gasto)\nSetVar ('proyeccion_gasto', proyeccion_gasto)\n\nfaltante = {registro}[24]\nprint(faltante)\nSetVar ('faltante', faltante)\n\nmeses = {registro}[25]\nprint(meses)\nSetVar ('meses', meses)\n\nmeses_transcurridos = {registro}[26]\nprint(meses_transcurridos)\nSetVar ('meses_transcurridos', meses_transcurridos)\n\nestado = {registro}[27]\nprint(estado)\nestado = estado.strip()\nSetVar ('estado', estado)
2024-08-07 18:02:43.465695 - rocketbot - INFO - request: N-DataEllipse : line 30.3 - rpaconnect : request  id: 6b0e9df4-5f6f-3645-1d62-a8b260598cfe -  - {"method":"post","url":"{api_ellipse}","json":"{\n  \"gerencia\":\"{gerencia}\",\n  \"codigoCttoAnterior\":\"{contrato}\",\n  \"tipoContrato\":\"{tipo_contrato}\",\n  \"tipoAdjudicacion\":\"{tipo_adjudicacion}\",\n  \"descripcion\":\"{descripcion}\",\n  \"rutAdministrador\":\"{administrador}\",\n  \"nombreAdministrador\":\"{nombre_admiistrador}\",\n  \"codigoProvedor\":\"{id_proveedor}\",\n  \"nombreProveddor\":\"{nombre_proveedor}\",\n  \"moneda\":\"{moneda}\",\n  \"rutIngenieroContrato\":\"{rut_ing_contratos}\",\n  \"nombreIngenieroContrato\":\"{nombre_ing}\",\n  \"fechaInicioActualizada\":\"{fecha_inicio}\",\n  \"fechaTerminoActualizada\":\"{fecha_fin}\",\n  \"monto\":\"{monto_original}\",\n  \"modificacionesMonto\":\"{modificaciones}\",\n  \"montoTotal\":\"{monto_total}\",\n  \"pagosReal\":\"{pagos_real}\",\n  \"saldoReal\":\"{saldo_real}\",\n  \"montoRetenido\":\"{monto_retenido}\",\n  \"pagosDirectos\":\"{pagos_directos}\",\n  \"gastoPromedioActualReal\":\"{gasto_promedio}\",\n  \"proyeccionGastoActual\":\"{proyeccion_gasto}\",\n  \"faltante\":\"{faltante}\",\n  \"mesesCtto\":\"{meses}\",\n  \"mesesTranscurridos\":\"{meses_transcurridos}\",\n  \"estadoContrato\":\"{estado}\"\n}","params":"","form":"","proxy":"","file":"","header":"{\"X-Api-Key\":\"{api_key}\"}"}
2024-08-07 18:03:04.525552 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_108 ""): ConnectTimeout: HTTPConnectionPool(host='54.88.59.194', port=8081): Max retries exceeded with url: /api/v1.0/sourcings (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x0000028318293FA0>, 'Connection to 54.88.59.194 timed out. (connect timeout=None)'))
2024-08-07 18:05:38.548351 - rocketbot - INFO - request: P-SourcingPlan : line 1 - rpascripts : module  id: 8dfbcfd9-495e-7c66-5d18-49f451346c0d -  - {"module_name":"System++","module":"cleanVars","vars":"inidecript,client,secret,tenant,ruta_log,notificados,inicript,fecha_crea_log,fecha_log"}
2024-08-07 18:05:38.616376 - rocketbot - INFO - request: P-SourcingPlan : line 2 - rpascripts : module  id: 57fcc22c-a6ea-ee6a-c04b-182e13ed9f2d -  - {"module_name":"Encriptador","module":"desencriptarArchivo","content":"C:/SourcingPlan/Recursos/sourcingplank.key","fileEnc":"C:/SourcingPlan/config.ini","file":"C:/SourcingPlan","res":"inidecript","filename":"config"}
2024-08-07 18:05:38.870173 - rocketbot - INFO - request: P-SourcingPlan : line 3 - rpalogic : evaluateIf  id: 44fc765c-5af8-3e46-9865-aec95decd501 -  - {inidecript} == True
2024-08-07 18:05:39.015715 - rocketbot - INFO - request: P-SourcingPlan : line 3.1 - rpascripts : module  id: c204139c-03c9-52fa-a42f-8ba55961a0fb -  - {"module_name":"ControlIni","module":"leerIni","content":"C:/SourcingPlan/config.ini"}
2024-08-07 18:05:39.204124 - rocketbot - INFO - request: P-SourcingPlan : line 3.2 - rpascripts : module  id: 73ba0511-70e1-831a-2775-7056d7c5ec48 -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"COMUN","iddato":"ruta_log","idvar":"ruta_log"}
2024-08-07 18:05:39.332951 - rocketbot - INFO - request: P-SourcingPlan : line 3.3 - rpascripts : module  id: 48ef4e78-92cf-b54f-cf41-b4487f82fcbd -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"COMUN","iddato":"api_key","idvar":"api_key"}
2024-08-07 18:05:39.526842 - rocketbot - INFO - request: P-SourcingPlan : line 3.4 - rpascripts : module  id: 34e4b918-d345-bd79-1be5-ae9c34ce2072 -  - {"module_name":"Encriptador","module":"encriptarArchivo","content":"C:/SourcingPlan/Recursos/sourcingplank.key","file":"C:/SourcingPlan/config.ini","res":"inicript"}
2024-08-07 18:05:39.665318 - rocketbot - INFO - request: P-SourcingPlan : line 3.5 - rpalogic : evaluateIf  id: 7609d855-2c53-0c34-4821-d0b608458357 -  - {inicript} == True
2024-08-07 18:05:39.859700 - rocketbot - INFO - request: P-SourcingPlan : line 3.5.1 - rpasystem : setVar  id: 1e5b7eec-006f-d4a3-0e88-c690cf5e343d -  - datetime.now().strftime("%Y%m%d_%H%M%S")
2024-08-07 18:05:39.984381 - rocketbot - INFO - request: P-SourcingPlan : line 3.5.2 - rpasystem : setVar  id: 9fca0ae3-67c5-5452-65d7-3077b3d94db5 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 18:05:40.182276 - rocketbot - INFO - request: P-SourcingPlan : line 3.5.3 - rpafile : savedatafile  id: bfdfc534-78d2-a512-7cf1-a3473d3995bf -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":"","file_data":"{fecha_log} | Inicio del proceso principal de obtención de datos para Sourcing Plan"}
2024-08-07 18:05:40.291675 - rocketbot - INFO - request: P-SourcingPlan : line 3.5.8 - rpasystem : wait  id: c0b67acb-6b35-6fd7-87d4-09ba514b74f3 -  - 6
2024-08-07 18:05:46.291922 - rocketbot - INFO - request: scripts : execRocketBotDB : line 3.5.9 - - N-InicioCloudSigner
2024-08-07 18:05:46.291922 - rocketbot - INFO - request: N-InicioCloudSigner : line 1 - rpascripts : module  id: b4e73dad-7dc8-ba6c-5172-9967fc59850b -  - {"module_name":"System++","module":"cleanVars","vars":"inidecript_ellipse,carpeta_imput,descarga_cloudsigner,procesado_cloudsigner,api_cloudsigner,inicript_ellipse,num_filas_imput,lista_contratos,contador_contratos,num_contrato,arch_imput,historico_cloudsigner,api_key,api_cs,authorization"}
2024-08-07 18:05:46.307446 - rocketbot - INFO - request: N-InicioCloudSigner : line 2 - rpasystem : setVar  id: 8678b45f-b834-0bcd-04a6-470400a57073 -  - datetime.now().strftime("%Y%m%d_%H%M%S")
2024-08-07 18:05:46.307446 - rocketbot - INFO - request: N-InicioCloudSigner : line 3 - rpascripts : module  id: 936f35c5-7cab-cebf-1db8-86f3288bde5f -  - {"module_name":"Encriptador","module":"desencriptarArchivo","content":"C:/SourcingPlan/Recursos/sourcingplank.key","fileEnc":"C:/SourcingPlan/config.ini","file":"C:/SourcingPlan","filename":"config","res":"inidecript_ellipse"}
2024-08-07 18:05:46.307446 - rocketbot - INFO - request: N-InicioCloudSigner : line 4 - rpalogic : evaluateIf  id: 92d78b71-2093-3735-5a7c-3c7e5e26fc3e -  - {inidecript_ellipse} == True
2024-08-07 18:05:46.307446 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.1 - rpasystem : setVar  id: 8c6d2f7e-fdb0-5c78-1c37-92240ea1078e -  - rocketbot.log("Desencriptación del archivo de configuración correcta", "info")
2024-08-07 18:05:46.323088 - rocketbot - INFO - Desencriptación del archivo de configuración correcta
2024-08-07 18:05:46.323088 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.2 - rpascripts : module  id: 5e195885-9389-c18f-58b7-15a99f41da1b -  - {"module_name":"ControlIni","module":"leerIni","content":"C:/SourcingPlan/config.ini"}
2024-08-07 18:05:46.323088 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.3 - rpascripts : module  id: d24744d0-a857-780d-d2af-0aa849df469f -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"COMUN","iddato":"api_key","idvar":"api_key"}
2024-08-07 18:05:46.323088 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.4 - rpascripts : module  id: 8998b481-1924-e177-ea67-bc2edd1e70ed -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"ELLIPSE","iddato":"procesado_ellipse","idvar":"carpeta_imput"}
2024-08-07 18:05:46.338603 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.5 - rpascripts : module  id: 04119008-4c13-7d30-568a-7db761ba54bc -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"CLOUDSIGNER","iddato":"descarga_cloudsigner","idvar":"descarga_cloudsigner"}
2024-08-07 18:05:46.338603 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.6 - rpascripts : module  id: a2de8a96-2cf8-6e01-e0a5-bba676fcaa43 -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"CLOUDSIGNER","iddato":"historico_cloudsigner","idvar":"historico_cloudsigner"}
2024-08-07 18:05:46.354243 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_74 ""): KeyError: 'historico_cloudsigner'
2024-08-07 18:05:46.354243 - script - ERROR - EXCEPTION IN (<string> script, L_133 ""): KeyError: 'historico_cloudsigner'
2024-08-07 18:05:46.354243 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.7 - rpascripts : module  id: 19db74d9-1f08-5d75-b6f3-cca738ceb1cd -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"CLOUDSIGNER","iddato":"procesado_cloudsigner","idvar":"procesado_cloudsigner"}
2024-08-07 18:05:46.354243 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.8 - rpascripts : module  id: 024b712c-acd8-15bf-2308-6d0a2c61ea16 -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"CLOUDSIGNER","iddato":"api_cloudsigner","idvar":"api_cloudsigner"}
2024-08-07 18:05:46.369870 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.9 - rpascripts : module  id: 912f9c77-260d-d82c-65df-c086ee01981e -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"CLOUDSIGNER","iddato":"api_cs","idvar":"api_cs"}
2024-08-07 18:05:46.385508 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_74 ""): KeyError: 'api_cs'
2024-08-07 18:05:46.385508 - script - ERROR - EXCEPTION IN (<string> script, L_133 ""): KeyError: 'api_cs'
2024-08-07 18:05:46.385508 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.10 - rpascripts : module  id: 91e865ca-d388-0df1-e9fc-eab64fce87f5 -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"CLOUDSIGNER","iddato":"authorization","idvar":"authorization"}
2024-08-07 18:05:46.401122 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_74 ""): KeyError: 'authorization'
2024-08-07 18:05:46.401122 - script - ERROR - EXCEPTION IN (<string> script, L_133 ""): KeyError: 'authorization'
2024-08-07 18:05:46.401122 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.11 - rpascripts : module  id: 6ae24c17-312e-d25c-b14d-50983eebf223 -  - {"module_name":"Encriptador","module":"encriptarArchivo","content":"C:/SourcingPlan/Recursos/sourcingplank.key","file":"C:/SourcingPlan/config.ini","res":"inicript_ellipse"}
2024-08-07 18:05:46.416748 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12 - rpalogic : evaluateIf  id: 4ae4e6bc-764e-13a7-3552-2b4f767586b5 -  - {inicript_ellipse} == True
2024-08-07 18:05:46.416748 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.1 - rpasystem : setVar  id: bd870589-5624-8393-07ba-db9fa4b1547c -  - rocketbot.log("Encriptación del archivo de configuración correcta", "info")
2024-08-07 18:05:46.416748 - rocketbot - INFO - Encriptación del archivo de configuración correcta
2024-08-07 18:05:46.416748 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.2 - rpasystem : setVar  id: 1fb84c60-936a-ee4e-156a-5536ae25a604 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 18:05:46.416748 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.3 - rpafile : savedatafile  id: af5a63a1-d706-f36a-ec9e-8944056a108d -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Inicio del proceso para la obtencion de datos de la plataforma Cloud Signer"}
2024-08-07 18:05:46.416748 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.4 - rpasystem : setVar  id: cb7aa78f-778b-8a33-f5ac-63869a96861a -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 18:05:46.432379 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.5 - rpafile : savedatafile  id: 02be7124-feb2-1198-4267-9c64a0a75b1e -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Obteniendo el ultimo Maestro de contratos Procesado"}
2024-08-07 18:05:46.432379 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.6 - rpascripts : execscriptpython  id: a1dcf5d7-2d73-b341-5da8-081ea1e48ff1 -  - ########################################################################\n#  Script para obtener el ultimo archivo procesado del Maestro de      #\n#  contratos                                                           # \n########################################################################\n\nimport os\n\ncarpeta = GetVar('carpeta_imput')\n\nlista_archivos = []\nfor archivo in os.listdir(carpeta):\n    ruta_absoluta = os.path.join(carpeta, archivo)\n    if os.path.isfile(ruta_absoluta):\n        lista_archivos.append(archivo)\n\nif not lista_archivos:\n    print("La carpeta no contiene archivos.")\nelse:\n    archivos_modificados = []\n    for archivo in lista_archivos:\n        ruta_absoluta = os.path.join(carpeta, archivo)\n        fecha_modificacion = os.path.getmtime(ruta_absoluta)\n        archivos_modificados.append((archivo, fecha_modificacion))\n\n    ultimo_archivo_modificado = max(archivos_modificados, key=lambda x: x[1])[0]\n    print("El último archivo modificado en la carpeta es:", ultimo_archivo_modificado)\n    SetVar('arch_imput', ultimo_archivo_modificado) 
2024-08-07 18:05:46.432379 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.7 - rpasystem : setVar  id: 976e943a-e039-b9f6-e257-897119a092b6 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 18:05:46.432379 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.8 - rpafile : savedatafile  id: 78023947-56f9-dc51-a9c9-7109c82d4108 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Ultimo Maestro de Contratos procesado: {arch_imput}"}
2024-08-07 18:05:46.448627 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.9 - rpafile : copyfile  id: 2d96fcd1-a3ab-dc1a-f128-26dadf8731bb -  - {"from":"{carpeta_imput}/{arch_imput}","to":"{descarga_cloudsigner}/{arch_imput}"}
2024-08-07 18:05:46.448627 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.10 - rpasystem : setVar  id: 0523a6e9-2ac1-4022-7ae6-81cc4eb3f3c5 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 18:05:46.463649 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.11 - rpafile : savedatafile  id: cdc93809-13d0-5b03-f8bc-47f7a70d2b01 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Obteniendo la lista de contratos a procesar"}
2024-08-07 18:05:46.463649 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.12 - rpaxls : readxlsx  id: 7525da08-fb54-4049-dcc1-d017982879c1 -  - {"file_path":"{descarga_cloudsigner}/{arch_imput}"}
2024-08-07 18:05:46.619822 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.13 - rpaxls : getrows  id: 49e166ba-59bd-2f75-f75d-6f824a096b9d -  - num_filas_imput
2024-08-07 18:05:46.619822 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.14 - rpaxls : getcell  id: e4a39f42-8bfd-e382-77cd-1428f2afb4cb -  - B2:B{num_filas_imput}
2024-08-07 18:05:46.635465 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.15 - rpaxls : savexlsx  id: 494031dd-1f8e-d95f-1ce2-22425f476a5d -  - {"path":"{descarga_cloudsigner}/{arch_imput}"}
2024-08-07 18:05:46.791730 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.16 - rpasystem : setVar  id: 7577925e-066c-f708-ca17-cc81d0018848 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 18:05:46.791730 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.17 - rpafile : savedatafile  id: 41882134-e25b-9cc3-6e66-2be9d8057b0c -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Consultando la lista de contratos por medio de la API de Cloud Signer para obtencion de datos de documentos"}
2024-08-07 18:05:46.807342 - rocketbot - INFO - request: scripts : execRocketBotDB : line 4.12.18 - - N-ConsultaApiCS
2024-08-07 18:05:46.807342 - rocketbot - INFO - request: N-ConsultaApiCS : line 1 - rpascripts : execpython  id: 7a5ceff2-6f26-22c0-0c62-632685cb18f8 -  - C:/SourcingPlan/Python/APICs.py
2024-08-07 18:05:46.822971 - script - ERROR - EXCEPTION IN (<string> script, L_81 ""): MissingSchema: Invalid URL 'False': No schema supplied. Perhaps you meant http://False?
2024-08-07 18:05:46.838661 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.19 - rpasystem : setVar  id: 31fda07d-74ae-1a98-be49-b635f75522fa -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 18:05:46.838661 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.20 - rpafile : savedatafile  id: 51c80667-4077-55f7-c5cb-17b8f1c2dbd0 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Creando archivo Excel con los datos obtenidos para integralos en Atomox"}
2024-08-07 18:05:46.838661 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.21 - rpasystem : setVar  id: 07ea14f5-3f7b-b068-1178-c6192c7a85a3 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 18:05:46.838661 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.22 - rpafile : savedatafile  id: 5719ce01-abc8-39f1-428a-55ed4f680692 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Inicio del proceso de integración de información de documentos en Atomox"}
2024-08-07 18:05:46.838661 - rocketbot - INFO - request: scripts : execRocketBotDB : line 4.12.23 - - N-IntegracionApiAtomox
2024-08-07 18:05:46.854218 - rocketbot - INFO - request: N-IntegracionApiAtomox : line 1 - rpasystem : setVar  id: dd248df1-a7cf-7405-f259-2c3f8f4cfd39 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 18:05:46.854218 - rocketbot - INFO - request: N-IntegracionApiAtomox : line 2 - rpafile : savedatafile  id: 9c5916d1-0532-0b2c-9de8-faaa0c5374ef -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Obteniendo el ultimo archivo generado desde la consulta de contratos desde la APi de Cloud Signer"}
2024-08-07 18:05:46.854218 - rocketbot - INFO - request: N-IntegracionApiAtomox : line 3 - rpascripts : execscriptpython  id: b0699082-136a-34a3-81ed-be2000e513ed -  - ########################################################################\n#  Script para obtener el ultimo archivo generado desde la API de      #\n#  CloudSigner                                                         # \n########################################################################\n\nimport os\n\ncarpeta = GetVar('historico_cloudsigner')\n\nlista_archivos = []\nfor archivo in os.listdir(carpeta):\n    ruta_absoluta = os.path.join(carpeta, archivo)\n    if os.path.isfile(ruta_absoluta):\n        lista_archivos.append(archivo)\n\nif not lista_archivos:\n    print("La carpeta no contiene archivos.")\nelse:\n    archivos_modificados = []\n    for archivo in lista_archivos:\n        ruta_absoluta = os.path.join(carpeta, archivo)\n        fecha_modificacion = os.path.getmtime(ruta_absoluta)\n        archivos_modificados.append((archivo, fecha_modificacion))\n\n    ultimo_archivo_modificado = max(archivos_modificados, key=lambda x: x[1])[0]\n    print("El último archivo modificado en la carpeta es:", ultimo_archivo_modificado)\n    SetVar('ult_arch_gen', ultimo_archivo_modificado) 
2024-08-07 18:05:46.854218 - script - ERROR - EXCEPTION IN (<string> script, L_90 ""): FileNotFoundError: [WinError 3] The system cannot find the path specified: 'False'
2024-08-07 18:05:46.854218 - rocketbot - INFO - request: N-IntegracionApiAtomox : line 4 - rpasystem : setVar  id: f9fc76cc-e551-377d-c13b-33457c110747 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 18:05:46.869844 - rocketbot - INFO - request: N-IntegracionApiAtomox : line 5 - rpafile : savedatafile  id: 7d9950b1-83ef-882f-ce12-9dbfc110835c -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Ultimo archivo generado: {ult_arch_gen}"}
2024-08-07 18:05:46.869844 - rocketbot - INFO - request: N-IntegracionApiAtomox : line 6 - rpasystem : setVar  id: d1ae5039-df7c-1ce3-7962-c938a5d12f07 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 18:05:46.869844 - rocketbot - INFO - request: N-IntegracionApiAtomox : line 7 - rpafile : savedatafile  id: fed05fb4-72a8-1416-0bc4-dded792fd0b5 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Copiando el ultimo archivo generado por la consulta a la API de Cloud Signer a la carpeta de procedos "}
2024-08-07 18:05:46.869844 - rocketbot - INFO - request: N-IntegracionApiAtomox : line 8 - rpafile : copyfile  id: 760acb68-5777-dc27-440c-77399e4e25f2 -  - {"from":"{historico_cloudsigner}/{ult_arch_gen}","to":"{procesado_cloudsigner}/{ult_arch_gen}"}
2024-08-07 18:05:46.885469 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_117 ""): FileNotFoundError: [Errno 2] No such file or directory: 'False/CloudSigner_2024-05-18-13-41.xlsx'
2024-08-07 18:05:46.885469 - rocketbot - INFO - request: N-IntegracionApiAtomox : line 9 - rpasystem : setVar  id: 138962ce-c797-77ac-c495-ddc5936c13e5 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 18:05:46.885469 - rocketbot - INFO - request: N-IntegracionApiAtomox : line 10 - rpafile : savedatafile  id: 53f9eb9a-ed83-23a4-6392-fc81d781e0c0 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Abriendo archivo excel para la inserción de datos en Atomox"}
2024-08-07 18:05:46.885469 - rocketbot - INFO - request: N-IntegracionApiAtomox : line 11 - rpaxls : readxlsx  id: 9ac1ddc0-7253-ebff-23d4-ad7598bfb786 -  - {"file_path":"{procesado_cloudsigner}/{ult_arch_gen}"}
2024-08-07 18:05:46.885469 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_115 ""): FileNotFoundError: [Errno 2] No such file or directory: 'C:/SourcingPlan/Recursos/CloudSigner/Procesados/CloudSigner_2024-05-18-13-41.xlsx'
2024-08-07 18:05:46.901094 - rocketbot - INFO - request: N-IntegracionApiAtomox : line 12 - rpaxls : getrows  id: cba396af-bb70-29d2-3fce-81ced5e5ba2c -  - num_filas
2024-08-07 18:05:46.901094 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_172 ""): KeyError: 'sheet'
2024-08-07 18:05:46.901094 - rocketbot - INFO - request: N-IntegracionApiAtomox : line 13 - rpaxls : getcell  id: 63a2b0e7-27da-961a-31c7-f33508b0953a -  - A2:F{num_filas}
2024-08-07 18:05:46.901094 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_208 ""): KeyError: 'sheet'
2024-08-07 18:05:46.901094 - rocketbot - INFO - request: N-IntegracionApiAtomox : line 14 - rpaxls : setcell  id: 13124ff1-1ff2-f6ee-ddeb-3a61c5a41f8a -  - G:1=Estado Registro ATOMOX
2024-08-07 18:05:46.901094 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_282 ""): KeyError: 'sheet'
2024-08-07 18:05:46.916720 - rocketbot - INFO - request: N-IntegracionApiAtomox : line 15 - rpasystem : setVar  id: 95167175-f256-3ee1-d418-5c4f3510b549 -  - 2
2024-08-07 18:05:46.916720 - rocketbot - INFO - request: N-IntegracionApiAtomox : line 16 - rpalogic : for  id: 17be6eef-24e2-eb72-0420-f247622eec56 -  - {"iterable":"{contenido_excel}","count":0}
2024-08-07 18:05:46.916720 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_107 ""): NameError: name 'contenido_excel' is not defined
2024-08-07 18:05:46.916720 - rocketbot - INFO - request: N-IntegracionApiAtomox : line 17 - rpaxls : savexlsx  id: b395cec6-6278-dcf3-a824-758c5cbd66f3 -  - {"path":"{procesado_cloudsigner}/{ult_arch_gen}"}
2024-08-07 18:05:46.916720 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_308 ""): KeyError: 'workbook'
2024-08-07 18:05:46.916720 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.24 - rpasystem : setVar  id: c2d6ffc1-c405-f8bc-29f7-aac621bcf958 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 18:05:46.916720 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.25 - rpafile : savedatafile  id: 0ca3ebca-97ca-0dc7-0e33-531fe4b7d96b -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Fin del proceso de integración"}
2024-08-07 18:05:46.932344 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.26 - rpasystem : setVar  id: 00f366ea-7928-7745-d835-1340ed971125 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 18:05:46.932344 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.27 - rpafile : savedatafile  id: 6a23b663-dc7f-e6b7-d85e-834d5f6b311e -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Fin del proceso para la obtención de datos de la plataforma Cloud Signer"}
2024-08-07 18:05:47.260485 - rocketbot - INFO - request: P-SourcingPlan : line 3.5.10 - rpasystem : setVar  id: bdcae1f3-3ba1-2fe3-0ea0-685fa628f325 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-07 18:05:47.510541 - rocketbot - INFO - request: P-SourcingPlan : line 3.5.11 - rpafile : savedatafile  id: 4d188fc9-0b49-9f7a-88c6-441d440941b9 -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Fin del proceso principal de obtención de datos para Sourcing Plan"}
2024-08-07 18:09:28.302446 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.6 - rpascripts : execscriptpython  id: a1dcf5d7-2d73-b341-5da8-081ea1e48ff1 -  - ########################################################################\n#  Script para obtener el ultimo archivo procesado del Maestro de      #\n#  contratos                                                           # \n########################################################################\n\nimport os\n\ncarpeta = GetVar('carpeta_imput')\n\nlista_archivos = []\nfor archivo in os.listdir(carpeta):\n    ruta_absoluta = os.path.join(carpeta, archivo)\n    if os.path.isfile(ruta_absoluta):\n        lista_archivos.append(archivo)\n\nif not lista_archivos:\n    print("La carpeta no contiene archivos.")\nelse:\n    archivos_modificados = []\n    for archivo in lista_archivos:\n        ruta_absoluta = os.path.join(carpeta, archivo)\n        fecha_modificacion = os.path.getmtime(ruta_absoluta)\n        archivos_modificados.append((archivo, fecha_modificacion))\n\n    ultimo_archivo_modificado = max(archivos_modificados, key=lambda x: x[1])[0]\n    print("El último archivo modificado en la carpeta es:", ultimo_archivo_modificado)\n    SetVar('arch_imput', ultimo_archivo_modificado) 
2024-08-07 18:10:27.941658 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.9 - rpafile : copyfile  id: 2d96fcd1-a3ab-dc1a-f128-26dadf8731bb -  - {"from":"{carpeta_imput}/{arch_imput}","to":"{descarga_cloudsigner}/{arch_imput}"}
2024-08-07 18:10:46.269634 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.12 - rpaxls : readxlsx  id: 7525da08-fb54-4049-dcc1-d017982879c1 -  - {"file_path":"{descarga_cloudsigner}/{arch_imput}"}
2024-08-07 18:10:51.199493 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.13 - rpaxls : getrows  id: 49e166ba-59bd-2f75-f75d-6f824a096b9d -  - num_filas_imput
2024-08-07 18:10:54.695651 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.14 - rpaxls : getcell  id: e4a39f42-8bfd-e382-77cd-1428f2afb4cb -  - B2:B{num_filas_imput}
2024-08-07 18:10:57.951817 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.15 - rpaxls : savexlsx  id: 494031dd-1f8e-d95f-1ce2-22425f476a5d -  - {"path":"{descarga_cloudsigner}/{arch_imput}"}
