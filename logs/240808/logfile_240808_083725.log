2024-08-08 08:38:05.798018 - rocketbot - INFO - request: N-InicioCloudSigner : line 1 - rpascripts : module  id: b4e73dad-7dc8-ba6c-5172-9967fc59850b -  - {"module_name":"System++","module":"cleanVars","vars":"inidecript_ellipse,carpeta_imput,descarga_cloudsigner,procesado_cloudsigner,api_cloudsigner,inicript_ellipse,num_filas_imput,lista_contratos,contador_contratos,num_contrato,arch_imput,historico_cloudsigner,api_key,api_cs,authorization"}
2024-08-08 08:38:11.665652 - rocketbot - INFO - request: N-InicioCloudSigner : line 2 - rpasystem : setVar  id: 8678b45f-b834-0bcd-04a6-470400a57073 -  - datetime.now().strftime("%Y%m%d_%H%M%S")
2024-08-08 08:38:15.384699 - rocketbot - INFO - request: N-InicioCloudSigner : line 3 - rpascripts : module  id: 936f35c5-7cab-cebf-1db8-86f3288bde5f -  - {"module_name":"Encriptador","module":"desencriptarArchivo","content":"C:/SourcingPlan/Recursos/sourcingplank.key","fileEnc":"C:/SourcingPlan/config.ini","file":"C:/SourcingPlan","filename":"config","res":"inidecript_ellipse"}
2024-08-08 08:38:19.041386 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.1 - rpasystem : setVar  id: 8c6d2f7e-fdb0-5c78-1c37-92240ea1078e -  - rocketbot.log("Desencriptación del archivo de configuración correcta", "info")
2024-08-08 08:38:19.046385 - rocketbot - INFO - Desencriptación del archivo de configuración correcta
2024-08-08 08:38:20.488928 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.2 - rpascripts : module  id: 5e195885-9389-c18f-58b7-15a99f41da1b -  - {"module_name":"ControlIni","module":"leerIni","content":"C:/SourcingPlan/config.ini"}
2024-08-08 08:38:21.625226 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.3 - rpascripts : module  id: d24744d0-a857-780d-d2af-0aa849df469f -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"COMUN","iddato":"api_key","idvar":"api_key"}
2024-08-08 08:38:23.080770 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.4 - rpascripts : module  id: 8998b481-1924-e177-ea67-bc2edd1e70ed -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"ELLIPSE","iddato":"procesado_ellipse","idvar":"carpeta_imput"}
2024-08-08 08:38:25.543848 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.5 - rpascripts : module  id: 04119008-4c13-7d30-568a-7db761ba54bc -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"CLOUDSIGNER","iddato":"descarga_cloudsigner","idvar":"descarga_cloudsigner"}
2024-08-08 08:38:26.512687 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.6 - rpascripts : module  id: a2de8a96-2cf8-6e01-e0a5-bba676fcaa43 -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"CLOUDSIGNER","iddato":"historico_cloudsigner","idvar":"historico_cloudsigner"}
2024-08-08 08:38:26.522683 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_74 ""): KeyError: 'historico_cloudsigner'
2024-08-08 08:38:26.525688 - script - ERROR - EXCEPTION IN (<string> script, L_133 ""): KeyError: 'historico_cloudsigner'
2024-08-08 08:43:43.251256 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.6 - rpascripts : module  id: a2de8a96-2cf8-6e01-e0a5-bba676fcaa43 -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"CLOUDSIGNER","iddato":"historico_cloudsigner","idvar":"historico_cloudsigner"}
2024-08-08 08:43:43.260881 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_74 ""): KeyError: 'historico_cloudsigner'
2024-08-08 08:43:43.264501 - script - ERROR - EXCEPTION IN (<string> script, L_133 ""): KeyError: 'historico_cloudsigner'
2024-08-08 08:44:10.945737 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.2 - rpascripts : module  id: 5e195885-9389-c18f-58b7-15a99f41da1b -  - {"module_name":"ControlIni","module":"leerIni","content":"C:/SourcingPlan/config.ini"}
2024-08-08 08:44:14.956049 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.6 - rpascripts : module  id: a2de8a96-2cf8-6e01-e0a5-bba676fcaa43 -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"CLOUDSIGNER","iddato":"historico_cloudsigner","idvar":"historico_cloudsigner"}
2024-08-08 08:44:21.396196 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.7 - rpascripts : module  id: 19db74d9-1f08-5d75-b6f3-cca738ceb1cd -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"CLOUDSIGNER","iddato":"procesado_cloudsigner","idvar":"procesado_cloudsigner"}
2024-08-08 08:44:28.035753 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.8 - rpascripts : module  id: 024b712c-acd8-15bf-2308-6d0a2c61ea16 -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"CLOUDSIGNER","iddato":"api_cloudsigner","idvar":"api_cloudsigner"}
2024-08-08 08:44:30.564154 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.9 - rpascripts : module  id: 912f9c77-260d-d82c-65df-c086ee01981e -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"CLOUDSIGNER","iddato":"api_cs","idvar":"api_cs"}
2024-08-08 08:44:34.350287 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.10 - rpascripts : module  id: 91e865ca-d388-0df1-e9fc-eab64fce87f5 -  - {"module_name":"ControlIni","module":"obtenerDato","idseccion":"CLOUDSIGNER","iddato":"authorization","idvar":"authorization"}
2024-08-08 08:44:39.149654 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.11 - rpascripts : module  id: 6ae24c17-312e-d25c-b14d-50983eebf223 -  - {"module_name":"Encriptador","module":"encriptarArchivo","content":"C:/SourcingPlan/Recursos/sourcingplank.key","file":"C:/SourcingPlan/config.ini","res":"inicript_ellipse"}
2024-08-08 08:45:37.446469 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.2 - rpasystem : setVar  id: 1fb84c60-936a-ee4e-156a-5536ae25a604 -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-08 08:45:38.524238 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.3 - rpafile : savedatafile  id: af5a63a1-d706-f36a-ec9e-8944056a108d -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Inicio del proceso para la obtencion de datos de la plataforma Cloud Signer"}
2024-08-08 08:45:38.529239 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_74 ""): FileNotFoundError: [Errno 2] No such file or directory: '{ruta_log}/{fecha_crea_log}.log'
2024-08-08 08:45:42.830794 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.4 - rpasystem : setVar  id: cb7aa78f-778b-8a33-f5ac-63869a96861a -  - datetime.now().strftime("%Y-%m-%d %H:%M:%S")
2024-08-08 08:45:45.260980 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.5 - rpafile : savedatafile  id: 02be7124-feb2-1198-4267-9c64a0a75b1e -  - {"file_name":"{ruta_log}/{fecha_crea_log}.log","type":"add","new_line":true,"file_data":"{fecha_log} | Obteniendo el ultimo Maestro de contratos Procesado"}
2024-08-08 08:45:45.271009 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_74 ""): FileNotFoundError: [Errno 2] No such file or directory: '{ruta_log}/{fecha_crea_log}.log'
2024-08-08 08:45:51.815386 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.6 - rpascripts : execscriptpython  id: a1dcf5d7-2d73-b341-5da8-081ea1e48ff1 -  - ########################################################################\n#  Script para obtener el ultimo archivo procesado del Maestro de      #\n#  contratos                                                           # \n########################################################################\n\nimport os\n\ncarpeta = GetVar('carpeta_imput')\n\nlista_archivos = []\nfor archivo in os.listdir(carpeta):\n    ruta_absoluta = os.path.join(carpeta, archivo)\n    if os.path.isfile(ruta_absoluta):\n        lista_archivos.append(archivo)\n\nif not lista_archivos:\n    print("La carpeta no contiene archivos.")\nelse:\n    archivos_modificados = []\n    for archivo in lista_archivos:\n        ruta_absoluta = os.path.join(carpeta, archivo)\n        fecha_modificacion = os.path.getmtime(ruta_absoluta)\n        archivos_modificados.append((archivo, fecha_modificacion))\n\n    ultimo_archivo_modificado = max(archivos_modificados, key=lambda x: x[1])[0]\n    print("El último archivo modificado en la carpeta es:", ultimo_archivo_modificado)\n    SetVar('arch_imput', ultimo_archivo_modificado) 
2024-08-08 08:46:39.971950 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.9 - rpafile : copyfile  id: 2d96fcd1-a3ab-dc1a-f128-26dadf8731bb -  - {"from":"{carpeta_imput}/{arch_imput}","to":"{descarga_cloudsigner}/{arch_imput}"}
2024-08-08 08:47:09.037629 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.12 - rpaxls : readxlsx  id: 7525da08-fb54-4049-dcc1-d017982879c1 -  - {"file_path":"{descarga_cloudsigner}/{arch_imput}"}
2024-08-08 08:47:16.710963 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.13 - rpaxls : getrows  id: 49e166ba-59bd-2f75-f75d-6f824a096b9d -  - num_filas_imput
2024-08-08 08:47:24.071370 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.14 - rpaxls : getcell  id: e4a39f42-8bfd-e382-77cd-1428f2afb4cb -  - B2:B{num_filas_imput}
2024-08-08 08:47:35.791474 - rocketbot - INFO - request: N-InicioCloudSigner : line 4.12.15 - rpaxls : savexlsx  id: 494031dd-1f8e-d95f-1ce2-22425f476a5d -  - {"path":"{descarga_cloudsigner}/{arch_imput}"}
2024-08-08 08:50:52.243274 - rocketbot - INFO - request: N-ConsultaApiCS : line 1 - rpascripts : execpython  id: 7a5ceff2-6f26-22c0-0c62-632685cb18f8 -  - C:/SourcingPlan/Python/APICs.py
2024-08-08 08:51:25.164526 - script - ERROR - EXCEPTION IN (<string> script, L_81 ""): ConnectTimeout: HTTPSConnectionPool(host='csmobile.e-sign.cl', port=8543): Max retries exceeded with url: /firmappservice/rest-services/api-cliente/documento/getAllInfoDocumentos?estado=0&limit=10&page=1&orden=desc&nombre=GGAC0436 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x000001A8E500E0B0>, 'Connection to csmobile.e-sign.cl timed out. (connect timeout=None)'))
2024-08-08 09:00:14.704635 - rocketbot - INFO - request: N-ConsultaApiCS : line 1 - rpascripts : execpython  id: 7a5ceff2-6f26-22c0-0c62-632685cb18f8 -  - C:/SourcingPlan/Python/APICs.py
2024-08-08 09:01:04.011859 - script - ERROR - EXCEPTION IN (<string> script, L_81 ""): ConnectTimeout: HTTPSConnectionPool(host='csmobile.e-sign.cl', port=8543): Max retries exceeded with url: /firmappservice/rest-services/api-cliente/documento/getAllInfoDocumentos?estado=0&limit=10&page=1&orden=desc&nombre=GGAC0348 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x000001A8E507F5E0>, 'Connection to csmobile.e-sign.cl timed out. (connect timeout=None)'))
2024-08-08 09:40:35.211212 - rocketbot - INFO - request: N-ConsultaApiCS : line 1 - rpascripts : execpython  id: 7a5ceff2-6f26-22c0-0c62-632685cb18f8 -  - C:/SourcingPlan/Python/APICs.py
2024-08-08 09:40:56.396574 - script - ERROR - EXCEPTION IN (<string> script, L_81 ""): ConnectTimeout: HTTPSConnectionPool(host='csmobile.e-sign.cl', port=8543): Max retries exceeded with url: /firmappservice/rest-services/api-cliente/documento/getAllInfoDocumentos?estado=0&limit=10&page=1&orden=desc&nombre=GGAC0215 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x000001A8E5025600>, 'Connection to csmobile.e-sign.cl timed out. (connect timeout=None)'))
2024-08-08 09:42:04.314889 - rocketbot - INFO - request: N-ConsultaApiCS : line 1 - rpascripts : execpython  id: 7a5ceff2-6f26-22c0-0c62-632685cb18f8 -  - C:/SourcingPlan/Python/APICs.py
2024-08-08 09:42:43.884694 - script - ERROR - EXCEPTION IN (<string> script, L_81 ""): ConnectTimeout: HTTPSConnectionPool(host='csmobile.e-sign.cl', port=8543): Max retries exceeded with url: /firmappservice/rest-services/api-cliente/documento/getAllInfoDocumentos?estado=0&limit=10&page=1&orden=desc&nombre=GGAC0230 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x000001A8E5005150>, 'Connection to csmobile.e-sign.cl timed out. (connect timeout=None)'))
2024-08-08 09:51:39.754385 - rocketbot - INFO - request: N-ConsultaApiCS : line 1 - rpascripts : execpython  id: 7a5ceff2-6f26-22c0-0c62-632685cb18f8 -  - C:/SourcingPlan/Python/APICs.py
2024-08-08 09:51:39.761229 - script - ERROR - EXCEPTION IN (<string> script, L_81 ""): NameError: name 'ERROR_NOT_VAR' is not defined
2024-08-08 09:53:55.801238 - rocketbot - INFO - request: N-ConsultaApiCS : line 1 - rpascripts : execpython  id: 7a5ceff2-6f26-22c0-0c62-632685cb18f8 -  - C:/SourcingPlan/Python/APICs.py
